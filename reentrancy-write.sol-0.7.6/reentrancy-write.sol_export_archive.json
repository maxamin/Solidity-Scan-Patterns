{"compilation_units": {"/Users/alpharush/tob/slither/tests/e2e/detectors/test_data/reentrancy-no-eth/0.7.6/reentrancy-write.sol": {"compiler": {"compiler": "solc", "version": "0.7.6", "optimized": false}, "source_units": {"tests/e2e/detectors/test_data/reentrancy-no-eth/0.7.6/reentrancy-write.sol": {"ast": {"absolutePath": "tests/e2e/detectors/test_data/reentrancy-no-eth/0.7.6/reentrancy-write.sol", "exportedSymbols": {"IContract": [120], "ReentrancyWrite": [231]}, "id": 232, "nodeType": "SourceUnit", "nodes": [{"abstract": false, "baseContracts": [], "contractDependencies": [], "contractKind": "interface", "fullyImplemented": false, "id": 120, "linearizedBaseContracts": [120], "name": "IContract", "nodeType": "ContractDefinition", "nodes": [{"functionSelector": "c2985578", "id": 119, "implemented": false, "kind": "function", "modifiers": [], "name": "foo", "nodeType": "FunctionDefinition", "parameters": {"id": 117, "nodeType": "ParameterList", "parameters": [], "src": "66:2:1"}, "returnParameters": {"id": 118, "nodeType": "ParameterList", "parameters": [], "src": "77:0:1"}, "scope": 120, "src": "54:24:1", "stateMutability": "nonpayable", "virtual": false, "visibility": "external"}], "scope": 232, "src": "28:52:1"}, {"abstract": false, "baseContracts": [], "contractDependencies": [], "contractKind": "contract", "fullyImplemented": true, "id": 231, "linearizedBaseContracts": [231], "name": "ReentrancyWrite", "nodeType": "ContractDefinition", "nodes": [{"constant": false, "id": 123, "mutability": "mutable", "name": "notCalled", "nodeType": "VariableDeclaration", "scope": 231, "src": "113:21:1", "stateVariable": true, "storageLocation": "default", "typeDescriptions": {"typeIdentifier": "t_bool", "typeString": "bool"}, "typeName": {"id": 121, "name": "bool", "nodeType": "ElementaryTypeName", "src": "113:4:1", "typeDescriptions": {"typeIdentifier": "t_bool", "typeString": "bool"}}, "value": {"hexValue": "74727565", "id": 122, "isConstant": false, "isLValue": false, "isPure": true, "kind": "bool", "lValueRequested": false, "nodeType": "Literal", "src": "130:4:1", "typeDescriptions": {"typeIdentifier": "t_bool", "typeString": "bool"}, "value": "true"}, "visibility": "internal"}, {"body": {"id": 150, "nodeType": "Block", "src": "218:159:1", "statements": [{"expression": {"arguments": [{"id": 129, "name": "notCalled", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 123, "src": "236:9:1", "typeDescriptions": {"typeIdentifier": "t_bool", "typeString": "bool"}}], "expression": {"argumentTypes": [{"typeIdentifier": "t_bool", "typeString": "bool"}], "id": 128, "name": "require", "nodeType": "Identifier", "overloadedDeclarations": [-18, -18], "referencedDeclaration": -18, "src": "228:7:1", "typeDescriptions": {"typeIdentifier": "t_function_require_pure$_t_bool_$returns$__$", "typeString": "function (bool) pure"}}, "id": 130, "isConstant": false, "isLValue": false, "isPure": false, "kind": "functionCall", "lValueRequested": false, "names": [], "nodeType": "FunctionCall", "src": "228:18:1", "tryCall": false, "typeDescriptions": {"typeIdentifier": "t_tuple$__$", "typeString": "tuple()"}}, "id": 131, "nodeType": "ExpressionStatement", "src": "228:18:1"}, {"assignments": [133, null], "declarations": [{"constant": false, "id": 133, "mutability": "mutable", "name": "success", "nodeType": "VariableDeclaration", "scope": 150, "src": "257:12:1", "stateVariable": false, "storageLocation": "default", "typeDescriptions": {"typeIdentifier": "t_bool", "typeString": "bool"}, "typeName": {"id": 132, "name": "bool", "nodeType": "ElementaryTypeName", "src": "257:4:1", "typeDescriptions": {"typeIdentifier": "t_bool", "typeString": "bool"}}, "visibility": "internal"}, null], "id": 138, "initialValue": {"arguments": [{"hexValue": "", "id": 136, "isConstant": false, "isLValue": false, "isPure": true, "kind": "string", "lValueRequested": false, "nodeType": "Literal", "src": "284:2:1", "typeDescriptions": {"typeIdentifier": "t_stringliteral_c5d2460186f7233c927e7db2dcc703c0e500b653ca82273b7bfad8045d85a470", "typeString": "literal_string \"\""}, "value": ""}], "expression": {"argumentTypes": [{"typeIdentifier": "t_stringliteral_c5d2460186f7233c927e7db2dcc703c0e500b653ca82273b7bfad8045d85a470", "typeString": "literal_string \"\""}], "expression": {"id": 134, "name": "addr", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 125, "src": "274:4:1", "typeDescriptions": {"typeIdentifier": "t_address", "typeString": "address"}}, "id": 135, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "memberName": "call", "nodeType": "MemberAccess", "src": "274:9:1", "typeDescriptions": {"typeIdentifier": "t_function_barecall_payable$_t_bytes_memory_ptr_$returns$_t_bool_$_t_bytes_memory_ptr_$", "typeString": "function (bytes memory) payable returns (bool,bytes memory)"}}, "id": 137, "isConstant": false, "isLValue": false, "isPure": false, "kind": "functionCall", "lValueRequested": false, "names": [], "nodeType": "FunctionCall", "src": "274:13:1", "tryCall": false, "typeDescriptions": {"typeIdentifier": "t_tuple$_t_bool_$_t_bytes_memory_ptr_$", "typeString": "tuple(bool,bytes memory)"}}, "nodeType": "VariableDeclarationStatement", "src": "256:31:1"}, {"condition": {"id": 140, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "nodeType": "UnaryOperation", "operator": "!", "prefix": true, "src": "301:8:1", "subExpression": {"id": 139, "name": "success", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 133, "src": "302:7:1", "typeDescriptions": {"typeIdentifier": "t_bool", "typeString": "bool"}}, "typeDescriptions": {"typeIdentifier": "t_bool", "typeString": "bool"}}, "id": 145, "nodeType": "IfStatement", "src": "297:47:1", "trueBody": {"id": 144, "nodeType": "Block", "src": "311:33:1", "statements": [{"expression": {"arguments": [], "expression": {"argumentTypes": [], "id": 141, "name": "revert", "nodeType": "Identifier", "overloadedDeclarations": [-19, -19], "referencedDeclaration": -19, "src": "325:6:1", "typeDescriptions": {"typeIdentifier": "t_function_revert_pure$__$returns$__$", "typeString": "function () pure"}}, "id": 142, "isConstant": false, "isLValue": false, "isPure": false, "kind": "functionCall", "lValueRequested": false, "names": [], "nodeType": "FunctionCall", "src": "325:8:1", "tryCall": false, "typeDescriptions": {"typeIdentifier": "t_tuple$__$", "typeString": "tuple()"}}, "id": 143, "nodeType": "ExpressionStatement", "src": "325:8:1"}]}}, {"expression": {"id": 148, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "leftHandSide": {"id": 146, "name": "notCalled", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 123, "src": "353:9:1", "typeDescriptions": {"typeIdentifier": "t_bool", "typeString": "bool"}}, "nodeType": "Assignment", "operator": "=", "rightHandSide": {"hexValue": "66616c7365", "id": 147, "isConstant": false, "isLValue": false, "isPure": true, "kind": "bool", "lValueRequested": false, "nodeType": "Literal", "src": "365:5:1", "typeDescriptions": {"typeIdentifier": "t_bool", "typeString": "bool"}, "value": "false"}, "src": "353:17:1", "typeDescriptions": {"typeIdentifier": "t_bool", "typeString": "bool"}}, "id": 149, "nodeType": "ExpressionStatement", "src": "353:17:1"}]}, "id": 151, "implemented": true, "kind": "constructor", "modifiers": [], "name": "", "nodeType": "FunctionDefinition", "parameters": {"id": 126, "nodeType": "ParameterList", "parameters": [{"constant": false, "id": 125, "mutability": "mutable", "name": "addr", "nodeType": "VariableDeclaration", "scope": 151, "src": "204:12:1", "stateVariable": false, "storageLocation": "default", "typeDescriptions": {"typeIdentifier": "t_address", "typeString": "address"}, "typeName": {"id": 124, "name": "address", "nodeType": "ElementaryTypeName", "src": "204:7:1", "stateMutability": "nonpayable", "typeDescriptions": {"typeIdentifier": "t_address", "typeString": "address"}}, "visibility": "internal"}], "src": "203:14:1"}, "returnParameters": {"id": 127, "nodeType": "ParameterList", "parameters": [], "src": "218:0:1"}, "scope": 231, "src": "192:185:1", "stateMutability": "nonpayable", "virtual": false, "visibility": "public"}, {"body": {"id": 177, "nodeType": "Block", "src": "406:165:1", "statements": [{"expression": {"arguments": [{"id": 155, "name": "notCalled", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 123, "src": "424:9:1", "typeDescriptions": {"typeIdentifier": "t_bool", "typeString": "bool"}}], "expression": {"argumentTypes": [{"typeIdentifier": "t_bool", "typeString": "bool"}], "id": 154, "name": "require", "nodeType": "Identifier", "overloadedDeclarations": [-18, -18], "referencedDeclaration": -18, "src": "416:7:1", "typeDescriptions": {"typeIdentifier": "t_function_require_pure$_t_bool_$returns$__$", "typeString": "function (bool) pure"}}, "id": 156, "isConstant": false, "isLValue": false, "isPure": false, "kind": "functionCall", "lValueRequested": false, "names": [], "nodeType": "FunctionCall", "src": "416:18:1", "tryCall": false, "typeDescriptions": {"typeIdentifier": "t_tuple$__$", "typeString": "tuple()"}}, "id": 157, "nodeType": "ExpressionStatement", "src": "416:18:1"}, {"assignments": [159, null], "declarations": [{"constant": false, "id": 159, "mutability": "mutable", "name": "success", "nodeType": "VariableDeclaration", "scope": 177, "src": "445:12:1", "stateVariable": false, "storageLocation": "default", "typeDescriptions": {"typeIdentifier": "t_bool", "typeString": "bool"}, "typeName": {"id": 158, "name": "bool", "nodeType": "ElementaryTypeName", "src": "445:4:1", "typeDescriptions": {"typeIdentifier": "t_bool", "typeString": "bool"}}, "visibility": "internal"}, null], "id": 165, "initialValue": {"arguments": [{"hexValue": "", "id": 163, "isConstant": false, "isLValue": false, "isPure": true, "kind": "string", "lValueRequested": false, "nodeType": "Literal", "src": "478:2:1", "typeDescriptions": {"typeIdentifier": "t_stringliteral_c5d2460186f7233c927e7db2dcc703c0e500b653ca82273b7bfad8045d85a470", "typeString": "literal_string \"\""}, "value": ""}], "expression": {"argumentTypes": [{"typeIdentifier": "t_stringliteral_c5d2460186f7233c927e7db2dcc703c0e500b653ca82273b7bfad8045d85a470", "typeString": "literal_string \"\""}], "expression": {"expression": {"id": 160, "name": "msg", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": -15, "src": "462:3:1", "typeDescriptions": {"typeIdentifier": "t_magic_message", "typeString": "msg"}}, "id": 161, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "memberName": "sender", "nodeType": "MemberAccess", "src": "462:10:1", "typeDescriptions": {"typeIdentifier": "t_address_payable", "typeString": "address payable"}}, "id": 162, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "memberName": "call", "nodeType": "MemberAccess", "src": "462:15:1", "typeDescriptions": {"typeIdentifier": "t_function_barecall_payable$_t_bytes_memory_ptr_$returns$_t_bool_$_t_bytes_memory_ptr_$", "typeString": "function (bytes memory) payable returns (bool,bytes memory)"}}, "id": 164, "isConstant": false, "isLValue": false, "isPure": false, "kind": "functionCall", "lValueRequested": false, "names": [], "nodeType": "FunctionCall", "src": "462:19:1", "tryCall": false, "typeDescriptions": {"typeIdentifier": "t_tuple$_t_bool_$_t_bytes_memory_ptr_$", "typeString": "tuple(bool,bytes memory)"}}, "nodeType": "VariableDeclarationStatement", "src": "444:37:1"}, {"condition": {"id": 167, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "nodeType": "UnaryOperation", "operator": "!", "prefix": true, "src": "495:8:1", "subExpression": {"id": 166, "name": "success", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 159, "src": "496:7:1", "typeDescriptions": {"typeIdentifier": "t_bool", "typeString": "bool"}}, "typeDescriptions": {"typeIdentifier": "t_bool", "typeString": "bool"}}, "id": 172, "nodeType": "IfStatement", "src": "491:47:1", "trueBody": {"id": 171, "nodeType": "Block", "src": "505:33:1", "statements": [{"expression": {"arguments": [], "expression": {"argumentTypes": [], "id": 168, "name": "revert", "nodeType": "Identifier", "overloadedDeclarations": [-19, -19], "referencedDeclaration": -19, "src": "519:6:1", "typeDescriptions": {"typeIdentifier": "t_function_revert_pure$__$returns$__$", "typeString": "function () pure"}}, "id": 169, "isConstant": false, "isLValue": false, "isPure": false, "kind": "functionCall", "lValueRequested": false, "names": [], "nodeType": "FunctionCall", "src": "519:8:1", "tryCall": false, "typeDescriptions": {"typeIdentifier": "t_tuple$__$", "typeString": "tuple()"}}, "id": 170, "nodeType": "ExpressionStatement", "src": "519:8:1"}]}}, {"expression": {"id": 175, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "leftHandSide": {"id": 173, "name": "notCalled", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 123, "src": "547:9:1", "typeDescriptions": {"typeIdentifier": "t_bool", "typeString": "bool"}}, "nodeType": "Assignment", "operator": "=", "rightHandSide": {"hexValue": "66616c7365", "id": 174, "isConstant": false, "isLValue": false, "isPure": true, "kind": "bool", "lValueRequested": false, "nodeType": "Literal", "src": "559:5:1", "typeDescriptions": {"typeIdentifier": "t_bool", "typeString": "bool"}, "value": "false"}, "src": "547:17:1", "typeDescriptions": {"typeIdentifier": "t_bool", "typeString": "bool"}}, "id": 176, "nodeType": "ExpressionStatement", "src": "547:17:1"}]}, "functionSelector": "8aeccda8", "id": 178, "implemented": true, "kind": "function", "modifiers": [], "name": "bad0", "nodeType": "FunctionDefinition", "parameters": {"id": 152, "nodeType": "ParameterList", "parameters": [], "src": "396:2:1"}, "returnParameters": {"id": 153, "nodeType": "ParameterList", "parameters": [], "src": "406:0:1"}, "scope": 231, "src": "383:188:1", "stateMutability": "nonpayable", "virtual": false, "visibility": "public"}, {"body": {"id": 202, "nodeType": "Block", "src": "614:124:1", "statements": [{"expression": {"arguments": [{"id": 184, "name": "notCalled", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 123, "src": "632:9:1", "typeDescriptions": {"typeIdentifier": "t_bool", "typeString": "bool"}}], "expression": {"argumentTypes": [{"typeIdentifier": "t_bool", "typeString": "bool"}], "id": 183, "name": "require", "nodeType": "Identifier", "overloadedDeclarations": [-18, -18], "referencedDeclaration": -18, "src": "624:7:1", "typeDescriptions": {"typeIdentifier": "t_function_require_pure$_t_bool_$returns$__$", "typeString": "function (bool) pure"}}, "id": 185, "isConstant": false, "isLValue": false, "isPure": false, "kind": "functionCall", "lValueRequested": false, "names": [], "nodeType": "FunctionCall", "src": "624:18:1", "tryCall": false, "typeDescriptions": {"typeIdentifier": "t_tuple$__$", "typeString": "tuple()"}}, "id": 186, "nodeType": "ExpressionStatement", "src": "624:18:1"}, {"assignments": [188, null], "declarations": [{"constant": false, "id": 188, "mutability": "mutable", "name": "success", "nodeType": "VariableDeclaration", "scope": 202, "src": "653:12:1", "stateVariable": false, "storageLocation": "default", "typeDescriptions": {"typeIdentifier": "t_bool", "typeString": "bool"}, "typeName": {"id": 187, "name": "bool", "nodeType": "ElementaryTypeName", "src": "653:4:1", "typeDescriptions": {"typeIdentifier": "t_bool", "typeString": "bool"}}, "visibility": "internal"}, null], "id": 194, "initialValue": {"arguments": [{"hexValue": "", "id": 192, "isConstant": false, "isLValue": false, "isPure": true, "kind": "string", "lValueRequested": false, "nodeType": "Literal", "src": "686:2:1", "typeDescriptions": {"typeIdentifier": "t_stringliteral_c5d2460186f7233c927e7db2dcc703c0e500b653ca82273b7bfad8045d85a470", "typeString": "literal_string \"\""}, "value": ""}], "expression": {"argumentTypes": [{"typeIdentifier": "t_stringliteral_c5d2460186f7233c927e7db2dcc703c0e500b653ca82273b7bfad8045d85a470", "typeString": "literal_string \"\""}], "expression": {"expression": {"id": 189, "name": "msg", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": -15, "src": "670:3:1", "typeDescriptions": {"typeIdentifier": "t_magic_message", "typeString": "msg"}}, "id": 190, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "memberName": "sender", "nodeType": "MemberAccess", "src": "670:10:1", "typeDescriptions": {"typeIdentifier": "t_address_payable", "typeString": "address payable"}}, "id": 191, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "memberName": "call", "nodeType": "MemberAccess", "src": "670:15:1", "typeDescriptions": {"typeIdentifier": "t_function_barecall_payable$_t_bytes_memory_ptr_$returns$_t_bool_$_t_bytes_memory_ptr_$", "typeString": "function (bytes memory) payable returns (bool,bytes memory)"}}, "id": 193, "isConstant": false, "isLValue": false, "isPure": false, "kind": "functionCall", "lValueRequested": false, "names": [], "nodeType": "FunctionCall", "src": "670:19:1", "tryCall": false, "typeDescriptions": {"typeIdentifier": "t_tuple$_t_bool_$_t_bytes_memory_ptr_$", "typeString": "tuple(bool,bytes memory)"}}, "nodeType": "VariableDeclarationStatement", "src": "652:37:1"}, {"expression": {"arguments": [{"id": 196, "name": "success", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 188, "src": "707:7:1", "typeDescriptions": {"typeIdentifier": "t_bool", "typeString": "bool"}}], "expression": {"argumentTypes": [{"typeIdentifier": "t_bool", "typeString": "bool"}], "id": 195, "name": "require", "nodeType": "Identifier", "overloadedDeclarations": [-18, -18], "referencedDeclaration": -18, "src": "699:7:1", "typeDescriptions": {"typeIdentifier": "t_function_require_pure$_t_bool_$returns$__$", "typeString": "function (bool) pure"}}, "id": 197, "isConstant": false, "isLValue": false, "isPure": false, "kind": "functionCall", "lValueRequested": false, "names": [], "nodeType": "FunctionCall", "src": "699:16:1", "tryCall": false, "typeDescriptions": {"typeIdentifier": "t_tuple$__$", "typeString": "tuple()"}}, "id": 198, "nodeType": "ExpressionStatement", "src": "699:16:1"}, {"expression": {"arguments": [], "expression": {"argumentTypes": [], "id": 199, "name": "bad0", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 178, "src": "725:4:1", "typeDescriptions": {"typeIdentifier": "t_function_internal_nonpayable$__$returns$__$", "typeString": "function ()"}}, "id": 200, "isConstant": false, "isLValue": false, "isPure": false, "kind": "functionCall", "lValueRequested": false, "names": [], "nodeType": "FunctionCall", "src": "725:6:1", "tryCall": false, "typeDescriptions": {"typeIdentifier": "t_tuple$__$", "typeString": "tuple()"}}, "id": 201, "nodeType": "ExpressionStatement", "src": "725:6:1"}]}, "functionSelector": "d8f6d614", "id": 203, "implemented": true, "kind": "function", "modifiers": [], "name": "bad1", "nodeType": "FunctionDefinition", "parameters": {"id": 181, "nodeType": "ParameterList", "parameters": [{"constant": false, "id": 180, "mutability": "mutable", "name": "target", "nodeType": "VariableDeclaration", "scope": 203, "src": "591:14:1", "stateVariable": false, "storageLocation": "default", "typeDescriptions": {"typeIdentifier": "t_address", "typeString": "address"}, "typeName": {"id": 179, "name": "address", "nodeType": "ElementaryTypeName", "src": "591:7:1", "stateMutability": "nonpayable", "typeDescriptions": {"typeIdentifier": "t_address", "typeString": "address"}}, "visibility": "internal"}], "src": "590:16:1"}, "returnParameters": {"id": 182, "nodeType": "ParameterList", "parameters": [], "src": "614:0:1"}, "scope": 231, "src": "577:161:1", "stateMutability": "nonpayable", "virtual": false, "visibility": "public"}, {"body": {"id": 229, "nodeType": "Block", "src": "767:164:1", "statements": [{"expression": {"arguments": [{"id": 207, "name": "notCalled", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 123, "src": "785:9:1", "typeDescriptions": {"typeIdentifier": "t_bool", "typeString": "bool"}}], "expression": {"argumentTypes": [{"typeIdentifier": "t_bool", "typeString": "bool"}], "id": 206, "name": "require", "nodeType": "Identifier", "overloadedDeclarations": [-18, -18], "referencedDeclaration": -18, "src": "777:7:1", "typeDescriptions": {"typeIdentifier": "t_function_require_pure$_t_bool_$returns$__$", "typeString": "function (bool) pure"}}, "id": 208, "isConstant": false, "isLValue": false, "isPure": false, "kind": "functionCall", "lValueRequested": false, "names": [], "nodeType": "FunctionCall", "src": "777:18:1", "tryCall": false, "typeDescriptions": {"typeIdentifier": "t_tuple$__$", "typeString": "tuple()"}}, "id": 209, "nodeType": "ExpressionStatement", "src": "777:18:1"}, {"expression": {"id": 212, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "leftHandSide": {"id": 210, "name": "notCalled", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 123, "src": "805:9:1", "typeDescriptions": {"typeIdentifier": "t_bool", "typeString": "bool"}}, "nodeType": "Assignment", "operator": "=", "rightHandSide": {"hexValue": "74727565", "id": 211, "isConstant": false, "isLValue": false, "isPure": true, "kind": "bool", "lValueRequested": false, "nodeType": "Literal", "src": "817:4:1", "typeDescriptions": {"typeIdentifier": "t_bool", "typeString": "bool"}, "value": "true"}, "src": "805:16:1", "typeDescriptions": {"typeIdentifier": "t_bool", "typeString": "bool"}}, "id": 213, "nodeType": "ExpressionStatement", "src": "805:16:1"}, {"assignments": [215, null], "declarations": [{"constant": false, "id": 215, "mutability": "mutable", "name": "success", "nodeType": "VariableDeclaration", "scope": 229, "src": "832:12:1", "stateVariable": false, "storageLocation": "default", "typeDescriptions": {"typeIdentifier": "t_bool", "typeString": "bool"}, "typeName": {"id": 214, "name": "bool", "nodeType": "ElementaryTypeName", "src": "832:4:1", "typeDescriptions": {"typeIdentifier": "t_bool", "typeString": "bool"}}, "visibility": "internal"}, null], "id": 221, "initialValue": {"arguments": [{"hexValue": "", "id": 219, "isConstant": false, "isLValue": false, "isPure": true, "kind": "string", "lValueRequested": false, "nodeType": "Literal", "src": "865:2:1", "typeDescriptions": {"typeIdentifier": "t_stringliteral_c5d2460186f7233c927e7db2dcc703c0e500b653ca82273b7bfad8045d85a470", "typeString": "literal_string \"\""}, "value": ""}], "expression": {"argumentTypes": [{"typeIdentifier": "t_stringliteral_c5d2460186f7233c927e7db2dcc703c0e500b653ca82273b7bfad8045d85a470", "typeString": "literal_string \"\""}], "expression": {"expression": {"id": 216, "name": "msg", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": -15, "src": "849:3:1", "typeDescriptions": {"typeIdentifier": "t_magic_message", "typeString": "msg"}}, "id": 217, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "memberName": "sender", "nodeType": "MemberAccess", "src": "849:10:1", "typeDescriptions": {"typeIdentifier": "t_address_payable", "typeString": "address payable"}}, "id": 218, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "memberName": "call", "nodeType": "MemberAccess", "src": "849:15:1", "typeDescriptions": {"typeIdentifier": "t_function_barecall_payable$_t_bytes_memory_ptr_$returns$_t_bool_$_t_bytes_memory_ptr_$", "typeString": "function (bytes memory) payable returns (bool,bytes memory)"}}, "id": 220, "isConstant": false, "isLValue": false, "isPure": false, "kind": "functionCall", "lValueRequested": false, "names": [], "nodeType": "FunctionCall", "src": "849:19:1", "tryCall": false, "typeDescriptions": {"typeIdentifier": "t_tuple$_t_bool_$_t_bytes_memory_ptr_$", "typeString": "tuple(bool,bytes memory)"}}, "nodeType": "VariableDeclarationStatement", "src": "831:37:1"}, {"condition": {"id": 223, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "nodeType": "UnaryOperation", "operator": "!", "prefix": true, "src": "882:8:1", "subExpression": {"id": 222, "name": "success", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 215, "src": "883:7:1", "typeDescriptions": {"typeIdentifier": "t_bool", "typeString": "bool"}}, "typeDescriptions": {"typeIdentifier": "t_bool", "typeString": "bool"}}, "id": 228, "nodeType": "IfStatement", "src": "878:47:1", "trueBody": {"id": 227, "nodeType": "Block", "src": "892:33:1", "statements": [{"expression": {"arguments": [], "expression": {"argumentTypes": [], "id": 224, "name": "revert", "nodeType": "Identifier", "overloadedDeclarations": [-19, -19], "referencedDeclaration": -19, "src": "906:6:1", "typeDescriptions": {"typeIdentifier": "t_function_revert_pure$__$returns$__$", "typeString": "function () pure"}}, "id": 225, "isConstant": false, "isLValue": false, "isPure": false, "kind": "functionCall", "lValueRequested": false, "names": [], "nodeType": "FunctionCall", "src": "906:8:1", "tryCall": false, "typeDescriptions": {"typeIdentifier": "t_tuple$__$", "typeString": "tuple()"}}, "id": 226, "nodeType": "ExpressionStatement", "src": "906:8:1"}]}}]}, "functionSelector": "aa8fb40b", "id": 230, "implemented": true, "kind": "function", "modifiers": [], "name": "good", "nodeType": "FunctionDefinition", "parameters": {"id": 204, "nodeType": "ParameterList", "parameters": [], "src": "757:2:1"}, "returnParameters": {"id": 205, "nodeType": "ParameterList", "parameters": [], "src": "767:0:1"}, "scope": 231, "src": "744:187:1", "stateMutability": "nonpayable", "virtual": false, "visibility": "public"}], "scope": 232, "src": "82:852:1"}], "src": "28:907:1"}, "contracts": {"IContract": {"abi": [{"inputs": [], "name": "foo", "outputs": [], "stateMutability": "nonpayable", "type": "function"}], "bin": "", "bin-runtime": "", "srcmap": "", "srcmap-runtime": "", "filenames": {"absolute": "/Users/alpharush/tob/slither/tests/e2e/detectors/test_data/reentrancy-no-eth/0.7.6/reentrancy-write.sol", "used": "tests/e2e/detectors/test_data/reentrancy-no-eth/0.7.6/reentrancy-write.sol", "short": "tests/e2e/detectors/test_data/reentrancy-no-eth/0.7.6/reentrancy-write.sol", "relative": "tests/e2e/detectors/test_data/reentrancy-no-eth/0.7.6/reentrancy-write.sol"}, "libraries": {}, "is_dependency": false, "userdoc": {"methods": {}, "notice": null}, "devdoc": {"methods": {}, "author": null, "details": null, "title": null}}, "ReentrancyWrite": {"abi": [{"inputs": [{"internalType": "address", "name": "addr", "type": "address"}], "stateMutability": "nonpayable", "type": "constructor"}, {"inputs": [], "name": "bad0", "outputs": [], "stateMutability": "nonpayable", "type": "function"}, {"inputs": [{"internalType": "address", "name": "target", "type": "address"}], "name": "bad1", "outputs": [], "stateMutability": "nonpayable", "type": "function"}, {"inputs": [], "name": "good", "outputs": [], "stateMutability": "nonpayable", "type": "function"}], "bin": "608060405260016000806101000a81548160ff02191690831515021790555034801561002a57600080fd5b506040516103c73803806103c78339818101604052602081101561004d57600080fd5b810190808051906020019092919050505060008054906101000a900460ff1661007557600080fd5b60008173ffffffffffffffffffffffffffffffffffffffff166040518060000190506000604051808303816000865af19150503d80600081146100d4576040519150601f19603f3d011682016040523d82523d6000602084013e6100d9565b606091505b50509050806100e757600080fd5b60008060006101000a81548160ff02191690831515021790555050506102b5806101126000396000f3fe608060405234801561001057600080fd5b50600436106100415760003560e01c80638aeccda814610046578063aa8fb40b14610050578063d8f6d6141461005a575b600080fd5b61004e61009e565b005b610058610144565b005b61009c6004803603602081101561007057600080fd5b81019080803573ffffffffffffffffffffffffffffffffffffffff1690602001909291905050506101ea565b005b60008054906101000a900460ff166100b557600080fd5b60003373ffffffffffffffffffffffffffffffffffffffff166040518060000190506000604051808303816000865af19150503d8060008114610114576040519150601f19603f3d011682016040523d82523d6000602084013e610119565b606091505b505090508061012757600080fd5b60008060006101000a81548160ff02191690831515021790555050565b60008054906101000a900460ff1661015b57600080fd5b60016000806101000a81548160ff02191690831515021790555060003373ffffffffffffffffffffffffffffffffffffffff166040518060000190506000604051808303816000865af19150503d80600081146101d4576040519150601f19603f3d011682016040523d82523d6000602084013e6101d9565b606091505b50509050806101e757600080fd5b50565b60008054906101000a900460ff1661020157600080fd5b60003373ffffffffffffffffffffffffffffffffffffffff166040518060000190506000604051808303816000865af19150503d8060008114610260576040519150601f19603f3d011682016040523d82523d6000602084013e610265565b606091505b505090508061027357600080fd5b61027b61009e565b505056fea26469706673582212205ddfe27ccc6c825c415b69228fd129c07f71f91b867af3c17f90f16669e29d3e64736f6c63430007060033", "bin-runtime": "608060405234801561001057600080fd5b50600436106100415760003560e01c80638aeccda814610046578063aa8fb40b14610050578063d8f6d6141461005a575b600080fd5b61004e61009e565b005b610058610144565b005b61009c6004803603602081101561007057600080fd5b81019080803573ffffffffffffffffffffffffffffffffffffffff1690602001909291905050506101ea565b005b60008054906101000a900460ff166100b557600080fd5b60003373ffffffffffffffffffffffffffffffffffffffff166040518060000190506000604051808303816000865af19150503d8060008114610114576040519150601f19603f3d011682016040523d82523d6000602084013e610119565b606091505b505090508061012757600080fd5b60008060006101000a81548160ff02191690831515021790555050565b60008054906101000a900460ff1661015b57600080fd5b60016000806101000a81548160ff02191690831515021790555060003373ffffffffffffffffffffffffffffffffffffffff166040518060000190506000604051808303816000865af19150503d80600081146101d4576040519150601f19603f3d011682016040523d82523d6000602084013e6101d9565b606091505b50509050806101e757600080fd5b50565b60008054906101000a900460ff1661020157600080fd5b60003373ffffffffffffffffffffffffffffffffffffffff166040518060000190506000604051808303816000865af19150503d8060008114610260576040519150601f19603f3d011682016040523d82523d6000602084013e610265565b606091505b505090508061027357600080fd5b61027b61009e565b505056fea26469706673582212205ddfe27ccc6c825c415b69228fd129c07f71f91b867af3c17f90f16669e29d3e64736f6c63430007060033", "srcmap": "82:852:1:-:0;;;130:4;113:21;;;;;;;;;;;;;;;;;;;;192:185;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;236:9;;;;;;;;;;228:18;;;;;;257:12;274:4;:9;;:13;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;256:31;;;302:7;297:47;;325:8;;;297:47;365:5;353:9;;:17;;;;;;;;;;;;;;;;;;192:185;;82:852;;;;;;", "srcmap-runtime": "82:852:1:-:0;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;383:188;;;:::i;:::-;;744:187;;;:::i;:::-;;577:161;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;:::i;:::-;;383:188;424:9;;;;;;;;;;416:18;;;;;;445:12;462:10;:15;;:19;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;444:37;;;496:7;491:47;;519:8;;;491:47;559:5;547:9;;:17;;;;;;;;;;;;;;;;;;383:188;:::o;744:187::-;785:9;;;;;;;;;;777:18;;;;;;817:4;805:9;;:16;;;;;;;;;;;;;;;;;;832:12;849:10;:15;;:19;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;831:37;;;883:7;878:47;;906:8;;;878:47;744:187;:::o;577:161::-;632:9;;;;;;;;;;624:18;;;;;;653:12;670:10;:15;;:19;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;652:37;;;707:7;699:16;;;;;;725:6;:4;:6::i;:::-;577:161;;:::o", "filenames": {"absolute": "/Users/alpharush/tob/slither/tests/e2e/detectors/test_data/reentrancy-no-eth/0.7.6/reentrancy-write.sol", "used": "tests/e2e/detectors/test_data/reentrancy-no-eth/0.7.6/reentrancy-write.sol", "short": "tests/e2e/detectors/test_data/reentrancy-no-eth/0.7.6/reentrancy-write.sol", "relative": "tests/e2e/detectors/test_data/reentrancy-no-eth/0.7.6/reentrancy-write.sol"}, "libraries": {}, "is_dependency": false, "userdoc": {"methods": {}, "notice": null}, "devdoc": {"methods": {}, "author": null, "details": null, "title": null}}}}}, "filenames": [{"absolute": "/Users/alpharush/tob/slither/tests/e2e/detectors/test_data/reentrancy-no-eth/0.7.6/reentrancy-write.sol", "used": "tests/e2e/detectors/test_data/reentrancy-no-eth/0.7.6/reentrancy-write.sol", "short": "tests/e2e/detectors/test_data/reentrancy-no-eth/0.7.6/reentrancy-write.sol", "relative": "tests/e2e/detectors/test_data/reentrancy-no-eth/0.7.6/reentrancy-write.sol"}, {"absolute": "/Users/alpharush/tob/slither/tests/e2e/detectors/test_data/reentrancy-no-eth/0.7.6/reentrancy-write.sol", "used": "/Users/alpharush/tob/slither/tests/e2e/detectors/test_data/reentrancy-no-eth/0.7.6/reentrancy-write.sol", "short": "tests/e2e/detectors/test_data/reentrancy-no-eth/0.7.6/reentrancy-write.sol", "relative": "tests/e2e/detectors/test_data/reentrancy-no-eth/0.7.6/reentrancy-write.sol"}]}}, "package": null, "working_dir": "/Users/alpharush/tob/slither", "type": 1, "unit_tests": [], "crytic_version": "0.0.2", "source_content": {"/Users/alpharush/tob/slither/tests/e2e/detectors/test_data/reentrancy-no-eth/0.7.6/reentrancy-write.sol": "// pragma solidity 0.4.26;\n\ninterface IContract {\n    function foo() external;\n}\n\ncontract ReentrancyWrite {\n    bool notCalled = true;\n\n    // Should not detect reentrancy in constructor\n    constructor(address addr) {\n        require(notCalled);\n        (bool success,) = addr.call(\"\");\n        if (!success) {\n            revert();\n        }\n        notCalled = false;\n    }\n\n    function bad0() public {\n        require(notCalled);\n        (bool success,) = msg.sender.call(\"\");\n        if (!success) {\n            revert();\n        }\n        notCalled = false;\n    }\n\n    function bad1(address target) public {\n        require(notCalled);\n        (bool success,) = msg.sender.call(\"\");\n        require(success);\n        bad0();\n    }\n\n    function good() public {\n        require(notCalled);\n        notCalled = true;\n        (bool success,) = msg.sender.call(\"\");\n        if (!success) {\n            revert();\n        }\n    }\n\n}\n"}}