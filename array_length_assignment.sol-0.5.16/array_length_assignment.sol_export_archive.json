{"compilation_units": {"/Users/alpharush/tob/slither/tests/e2e/detectors/test_data/controlled-array-length/0.5.16/array_length_assignment.sol": {"compiler": {"compiler": "solc", "version": "0.5.16", "optimized": false}, "source_units": {"tests/e2e/detectors/test_data/controlled-array-length/0.5.16/array_length_assignment.sol": {"ast": {"absolutePath": "tests/e2e/detectors/test_data/controlled-array-length/0.5.16/array_length_assignment.sol", "exportedSymbols": {"ArrayLengthAssignment": [255]}, "id": 256, "nodeType": "SourceUnit", "nodes": [{"baseContracts": [], "contractDependencies": [], "contractKind": "contract", "documentation": null, "fullyImplemented": true, "id": 255, "linearizedBaseContracts": [255], "name": "ArrayLengthAssignment", "nodeType": "ContractDefinition", "nodes": [{"constant": false, "id": 130, "name": "x", "nodeType": "VariableDeclaration", "scope": 255, "src": "37:6:1", "stateVariable": true, "storageLocation": "default", "typeDescriptions": {"typeIdentifier": "t_uint256", "typeString": "uint256"}, "typeName": {"id": 129, "name": "uint", "nodeType": "ElementaryTypeName", "src": "37:4:1", "typeDescriptions": {"typeIdentifier": "t_uint256", "typeString": "uint256"}}, "value": null, "visibility": "internal"}, {"constant": false, "id": 133, "name": "arr", "nodeType": "VariableDeclaration", "scope": 255, "src": "49:13:1", "stateVariable": true, "storageLocation": "default", "typeDescriptions": {"typeIdentifier": "t_array$_t_uint120_$dyn_storage", "typeString": "uint120[]"}, "typeName": {"baseType": {"id": 131, "name": "uint120", "nodeType": "ElementaryTypeName", "src": "49:7:1", "typeDescriptions": {"typeIdentifier": "t_uint120", "typeString": "uint120"}}, "id": 132, "length": null, "nodeType": "ArrayTypeName", "src": "49:9:1", "typeDescriptions": {"typeIdentifier": "t_array$_t_uint120_$dyn_storage_ptr", "typeString": "uint120[]"}}, "value": null, "visibility": "internal"}, {"constant": false, "id": 136, "name": "arr2", "nodeType": "VariableDeclaration", "scope": 255, "src": "68:14:1", "stateVariable": true, "storageLocation": "default", "typeDescriptions": {"typeIdentifier": "t_array$_t_uint120_$dyn_storage", "typeString": "uint120[]"}, "typeName": {"baseType": {"id": 134, "name": "uint120", "nodeType": "ElementaryTypeName", "src": "68:7:1", "typeDescriptions": {"typeIdentifier": "t_uint120", "typeString": "uint120"}}, "id": 135, "length": null, "nodeType": "ArrayTypeName", "src": "68:9:1", "typeDescriptions": {"typeIdentifier": "t_array$_t_uint120_$dyn_storage_ptr", "typeString": "uint120[]"}}, "value": null, "visibility": "internal"}, {"constant": false, "id": 139, "name": "arr3", "nodeType": "VariableDeclaration", "scope": 255, "src": "88:14:1", "stateVariable": true, "storageLocation": "default", "typeDescriptions": {"typeIdentifier": "t_array$_t_uint256_$dyn_storage", "typeString": "uint256[]"}, "typeName": {"baseType": {"id": 137, "name": "uint256", "nodeType": "ElementaryTypeName", "src": "88:7:1", "typeDescriptions": {"typeIdentifier": "t_uint256", "typeString": "uint256"}}, "id": 138, "length": null, "nodeType": "ArrayTypeName", "src": "88:9:1", "typeDescriptions": {"typeIdentifier": "t_array$_t_uint256_$dyn_storage_ptr", "typeString": "uint256[]"}}, "value": null, "visibility": "internal"}, {"body": {"id": 146, "nodeType": "Block", "src": "129:22:1", "statements": [{"expression": {"argumentTypes": null, "id": 144, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "leftHandSide": {"argumentTypes": null, "id": 142, "name": "x", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 130, "src": "139:1:1", "typeDescriptions": {"typeIdentifier": "t_uint256", "typeString": "uint256"}}, "nodeType": "Assignment", "operator": "=", "rightHandSide": {"argumentTypes": null, "hexValue": "37", "id": 143, "isConstant": false, "isLValue": false, "isPure": true, "kind": "number", "lValueRequested": false, "nodeType": "Literal", "src": "143:1:1", "subdenomination": null, "typeDescriptions": {"typeIdentifier": "t_rational_7_by_1", "typeString": "int_const 7"}, "value": "7"}, "src": "139:5:1", "typeDescriptions": {"typeIdentifier": "t_uint256", "typeString": "uint256"}}, "id": 145, "nodeType": "ExpressionStatement", "src": "139:5:1"}]}, "documentation": null, "id": 147, "implemented": true, "kind": "constructor", "modifiers": [], "name": "", "nodeType": "FunctionDefinition", "parameters": {"id": 140, "nodeType": "ParameterList", "parameters": [], "src": "119:2:1"}, "returnParameters": {"id": 141, "nodeType": "ParameterList", "parameters": [], "src": "129:0:1"}, "scope": 255, "src": "108:43:1", "stateMutability": "nonpayable", "superFunction": null, "visibility": "public"}, {"canonicalName": "ArrayLengthAssignment.TestStructWithArray", "id": 155, "members": [{"constant": false, "id": 150, "name": "x", "nodeType": "VariableDeclaration", "scope": 155, "src": "194:8:1", "stateVariable": false, "storageLocation": "default", "typeDescriptions": {"typeIdentifier": "t_array$_t_uint256_$dyn_storage_ptr", "typeString": "uint256[]"}, "typeName": {"baseType": {"id": 148, "name": "uint", "nodeType": "ElementaryTypeName", "src": "194:4:1", "typeDescriptions": {"typeIdentifier": "t_uint256", "typeString": "uint256"}}, "id": 149, "length": null, "nodeType": "ArrayTypeName", "src": "194:6:1", "typeDescriptions": {"typeIdentifier": "t_array$_t_uint256_$dyn_storage_ptr", "typeString": "uint256[]"}}, "value": null, "visibility": "internal"}, {"constant": false, "id": 154, "name": "y", "nodeType": "VariableDeclaration", "scope": 155, "src": "212:10:1", "stateVariable": false, "storageLocation": "default", "typeDescriptions": {"typeIdentifier": "t_array$_t_array$_t_uint256_$dyn_storage_$dyn_storage_ptr", "typeString": "uint256[][]"}, "typeName": {"baseType": {"baseType": {"id": 151, "name": "uint", "nodeType": "ElementaryTypeName", "src": "212:4:1", "typeDescriptions": {"typeIdentifier": "t_uint256", "typeString": "uint256"}}, "id": 152, "length": null, "nodeType": "ArrayTypeName", "src": "212:6:1", "typeDescriptions": {"typeIdentifier": "t_array$_t_uint256_$dyn_storage_ptr", "typeString": "uint256[]"}}, "id": 153, "length": null, "nodeType": "ArrayTypeName", "src": "212:8:1", "typeDescriptions": {"typeIdentifier": "t_array$_t_array$_t_uint256_$dyn_storage_$dyn_storage_ptr", "typeString": "uint256[][]"}}, "value": null, "visibility": "internal"}], "name": "TestStructWithArray", "nodeType": "StructDefinition", "scope": 255, "src": "157:72:1", "visibility": "public"}, {"canonicalName": "ArrayLengthAssignment.TestStructWithStructWithArray", "id": 161, "members": [{"constant": false, "id": 157, "name": "subStruct", "nodeType": "VariableDeclaration", "scope": 161, "src": "281:29:1", "stateVariable": false, "storageLocation": "default", "typeDescriptions": {"typeIdentifier": "t_struct$_TestStructWithArray_$155_storage_ptr", "typeString": "struct ArrayLengthAssignment.TestStructWithArray"}, "typeName": {"contractScope": null, "id": 156, "name": "TestStructWithArray", "nodeType": "UserDefinedTypeName", "referencedDeclaration": 155, "src": "281:19:1", "typeDescriptions": {"typeIdentifier": "t_struct$_TestStructWithArray_$155_storage_ptr", "typeString": "struct ArrayLengthAssignment.TestStructWithArray"}}, "value": null, "visibility": "internal"}, {"constant": false, "id": 160, "name": "z", "nodeType": "VariableDeclaration", "scope": 161, "src": "320:8:1", "stateVariable": false, "storageLocation": "default", "typeDescriptions": {"typeIdentifier": "t_array$_t_uint256_$dyn_storage_ptr", "typeString": "uint256[]"}, "typeName": {"baseType": {"id": 158, "name": "uint", "nodeType": "ElementaryTypeName", "src": "320:4:1", "typeDescriptions": {"typeIdentifier": "t_uint256", "typeString": "uint256"}}, "id": 159, "length": null, "nodeType": "ArrayTypeName", "src": "320:6:1", "typeDescriptions": {"typeIdentifier": "t_array$_t_uint256_$dyn_storage_ptr", "typeString": "uint256[]"}}, "value": null, "visibility": "internal"}], "name": "TestStructWithStructWithArray", "nodeType": "StructDefinition", "scope": 255, "src": "234:101:1", "visibility": "public"}, {"constant": false, "id": 163, "name": "a", "nodeType": "VariableDeclaration", "scope": 255, "src": "341:21:1", "stateVariable": true, "storageLocation": "default", "typeDescriptions": {"typeIdentifier": "t_struct$_TestStructWithArray_$155_storage", "typeString": "struct ArrayLengthAssignment.TestStructWithArray"}, "typeName": {"contractScope": null, "id": 162, "name": "TestStructWithArray", "nodeType": "UserDefinedTypeName", "referencedDeclaration": 155, "src": "341:19:1", "typeDescriptions": {"typeIdentifier": "t_struct$_TestStructWithArray_$155_storage_ptr", "typeString": "struct ArrayLengthAssignment.TestStructWithArray"}}, "value": null, "visibility": "internal"}, {"constant": false, "id": 165, "name": "b", "nodeType": "VariableDeclaration", "scope": 255, "src": "368:31:1", "stateVariable": true, "storageLocation": "default", "typeDescriptions": {"typeIdentifier": "t_struct$_TestStructWithStructWithArray_$161_storage", "typeString": "struct ArrayLengthAssignment.TestStructWithStructWithArray"}, "typeName": {"contractScope": null, "id": 164, "name": "TestStructWithStructWithArray", "nodeType": "UserDefinedTypeName", "referencedDeclaration": 161, "src": "368:29:1", "typeDescriptions": {"typeIdentifier": "t_struct$_TestStructWithStructWithArray_$161_storage_ptr", "typeString": "struct ArrayLengthAssignment.TestStructWithStructWithArray"}}, "value": null, "visibility": "internal"}, {"body": {"id": 253, "nodeType": "Block", "src": "449:604:1", "statements": [{"expression": {"argumentTypes": null, "id": 174, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "leftHandSide": {"argumentTypes": null, "id": 172, "name": "x", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 130, "src": "459:1:1", "typeDescriptions": {"typeIdentifier": "t_uint256", "typeString": "uint256"}}, "nodeType": "Assignment", "operator": "+=", "rightHandSide": {"argumentTypes": null, "hexValue": "31", "id": 173, "isConstant": false, "isLValue": false, "isPure": true, "kind": "number", "lValueRequested": false, "nodeType": "Literal", "src": "464:1:1", "subdenomination": null, "typeDescriptions": {"typeIdentifier": "t_rational_1_by_1", "typeString": "int_const 1"}, "value": "1"}, "src": "459:6:1", "typeDescriptions": {"typeIdentifier": "t_uint256", "typeString": "uint256"}}, "id": 175, "nodeType": "ExpressionStatement", "src": "459:6:1"}, {"condition": {"argumentTypes": null, "commonType": {"typeIdentifier": "t_uint256", "typeString": "uint256"}, "id": 178, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "leftExpression": {"argumentTypes": null, "id": 176, "name": "x", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 130, "src": "478:1:1", "typeDescriptions": {"typeIdentifier": "t_uint256", "typeString": "uint256"}}, "nodeType": "BinaryOperation", "operator": ">", "rightExpression": {"argumentTypes": null, "hexValue": "33", "id": 177, "isConstant": false, "isLValue": false, "isPure": true, "kind": "number", "lValueRequested": false, "nodeType": "Literal", "src": "482:1:1", "subdenomination": null, "typeDescriptions": {"typeIdentifier": "t_rational_3_by_1", "typeString": "int_const 3"}, "value": "3"}, "src": "478:5:1", "typeDescriptions": {"typeIdentifier": "t_bool", "typeString": "bool"}}, "falseBody": {"id": 204, "nodeType": "Block", "src": "569:146:1", "statements": [{"expression": {"argumentTypes": null, "id": 196, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "leftHandSide": {"argumentTypes": null, "id": 192, "name": "x", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 130, "src": "664:1:1", "typeDescriptions": {"typeIdentifier": "t_uint256", "typeString": "uint256"}}, "nodeType": "Assignment", "operator": "=", "rightHandSide": {"argumentTypes": null, "id": 195, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "nodeType": "UnaryOperation", "operator": "++", "prefix": false, "src": "668:13:1", "subExpression": {"argumentTypes": null, "expression": {"argumentTypes": null, "id": 193, "name": "arr2", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 136, "src": "668:4:1", "typeDescriptions": {"typeIdentifier": "t_array$_t_uint120_$dyn_storage", "typeString": "uint120[] storage ref"}}, "id": 194, "isConstant": false, "isLValue": true, "isPure": false, "lValueRequested": true, "memberName": "length", "nodeType": "MemberAccess", "referencedDeclaration": null, "src": "668:11:1", "typeDescriptions": {"typeIdentifier": "t_uint256", "typeString": "uint256"}}, "typeDescriptions": {"typeIdentifier": "t_uint256", "typeString": "uint256"}}, "src": "664:17:1", "typeDescriptions": {"typeIdentifier": "t_uint256", "typeString": "uint256"}}, "id": 197, "nodeType": "ExpressionStatement", "src": "664:17:1"}, {"expression": {"argumentTypes": null, "id": 202, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "leftHandSide": {"argumentTypes": null, "id": 198, "name": "x", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 130, "src": "695:1:1", "typeDescriptions": {"typeIdentifier": "t_uint256", "typeString": "uint256"}}, "nodeType": "Assignment", "operator": "=", "rightHandSide": {"argumentTypes": null, "commonType": {"typeIdentifier": "t_rational_10_by_1", "typeString": "int_const 10"}, "id": 201, "isConstant": false, "isLValue": false, "isPure": true, "lValueRequested": false, "leftExpression": {"argumentTypes": null, "hexValue": "37", "id": 199, "isConstant": false, "isLValue": false, "isPure": true, "kind": "number", "lValueRequested": false, "nodeType": "Literal", "src": "699:1:1", "subdenomination": null, "typeDescriptions": {"typeIdentifier": "t_rational_7_by_1", "typeString": "int_const 7"}, "value": "7"}, "nodeType": "BinaryOperation", "operator": "+", "rightExpression": {"argumentTypes": null, "hexValue": "33", "id": 200, "isConstant": false, "isLValue": false, "isPure": true, "kind": "number", "lValueRequested": false, "nodeType": "Literal", "src": "703:1:1", "subdenomination": null, "typeDescriptions": {"typeIdentifier": "t_rational_3_by_1", "typeString": "int_const 3"}, "value": "3"}, "src": "699:5:1", "typeDescriptions": {"typeIdentifier": "t_rational_10_by_1", "typeString": "int_const 10"}}, "src": "695:9:1", "typeDescriptions": {"typeIdentifier": "t_uint256", "typeString": "uint256"}}, "id": 203, "nodeType": "ExpressionStatement", "src": "695:9:1"}]}, "id": 205, "nodeType": "IfStatement", "src": "475:240:1", "trueBody": {"id": 191, "nodeType": "Block", "src": "485:71:1", "statements": [{"expression": {"argumentTypes": null, "id": 183, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "leftHandSide": {"argumentTypes": null, "expression": {"argumentTypes": null, "id": 179, "name": "arr", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 133, "src": "499:3:1", "typeDescriptions": {"typeIdentifier": "t_array$_t_uint120_$dyn_storage", "typeString": "uint120[] storage ref"}}, "id": 181, "isConstant": false, "isLValue": true, "isPure": false, "lValueRequested": true, "memberName": "length", "nodeType": "MemberAccess", "referencedDeclaration": null, "src": "499:10:1", "typeDescriptions": {"typeIdentifier": "t_uint256", "typeString": "uint256"}}, "nodeType": "Assignment", "operator": "=", "rightHandSide": {"argumentTypes": null, "hexValue": "37", "id": 182, "isConstant": false, "isLValue": false, "isPure": true, "kind": "number", "lValueRequested": false, "nodeType": "Literal", "src": "512:1:1", "subdenomination": null, "typeDescriptions": {"typeIdentifier": "t_rational_7_by_1", "typeString": "int_const 7"}, "value": "7"}, "src": "499:14:1", "typeDescriptions": {"typeIdentifier": "t_uint256", "typeString": "uint256"}}, "id": 184, "nodeType": "ExpressionStatement", "src": "499:14:1"}, {"expression": {"argumentTypes": null, "id": 189, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "leftHandSide": {"argumentTypes": null, "expression": {"argumentTypes": null, "id": 185, "name": "arr", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 133, "src": "527:3:1", "typeDescriptions": {"typeIdentifier": "t_array$_t_uint120_$dyn_storage", "typeString": "uint120[] storage ref"}}, "id": 187, "isConstant": false, "isLValue": true, "isPure": false, "lValueRequested": true, "memberName": "length", "nodeType": "MemberAccess", "referencedDeclaration": null, "src": "527:10:1", "typeDescriptions": {"typeIdentifier": "t_uint256", "typeString": "uint256"}}, "nodeType": "Assignment", "operator": "=", "rightHandSide": {"argumentTypes": null, "id": 188, "name": "param", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 167, "src": "540:5:1", "typeDescriptions": {"typeIdentifier": "t_uint256", "typeString": "uint256"}}, "src": "527:18:1", "typeDescriptions": {"typeIdentifier": "t_uint256", "typeString": "uint256"}}, "id": 190, "nodeType": "ExpressionStatement", "src": "527:18:1"}]}}, {"expression": {"argumentTypes": null, "id": 211, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "nodeType": "UnaryOperation", "operator": "++", "prefix": false, "src": "796:12:1", "subExpression": {"argumentTypes": null, "expression": {"argumentTypes": null, "expression": {"argumentTypes": null, "id": 206, "name": "a", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 163, "src": "796:1:1", "typeDescriptions": {"typeIdentifier": "t_struct$_TestStructWithArray_$155_storage", "typeString": "struct ArrayLengthAssignment.TestStructWithArray storage ref"}}, "id": 209, "isConstant": false, "isLValue": true, "isPure": false, "lValueRequested": false, "memberName": "x", "nodeType": "MemberAccess", "referencedDeclaration": 150, "src": "796:3:1", "typeDescriptions": {"typeIdentifier": "t_array$_t_uint256_$dyn_storage", "typeString": "uint256[] storage ref"}}, "id": 210, "isConstant": false, "isLValue": true, "isPure": false, "lValueRequested": true, "memberName": "length", "nodeType": "MemberAccess", "referencedDeclaration": null, "src": "796:10:1", "typeDescriptions": {"typeIdentifier": "t_uint256", "typeString": "uint256"}}, "typeDescriptions": {"typeIdentifier": "t_uint256", "typeString": "uint256"}}, "id": 212, "nodeType": "ExpressionStatement", "src": "796:12:1"}, {"expression": {"argumentTypes": null, "id": 219, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "leftHandSide": {"argumentTypes": null, "expression": {"argumentTypes": null, "expression": {"argumentTypes": null, "id": 213, "name": "a", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 163, "src": "818:1:1", "typeDescriptions": {"typeIdentifier": "t_struct$_TestStructWithArray_$155_storage", "typeString": "struct ArrayLengthAssignment.TestStructWithArray storage ref"}}, "id": 216, "isConstant": false, "isLValue": true, "isPure": false, "lValueRequested": false, "memberName": "x", "nodeType": "MemberAccess", "referencedDeclaration": 150, "src": "818:3:1", "typeDescriptions": {"typeIdentifier": "t_array$_t_uint256_$dyn_storage", "typeString": "uint256[] storage ref"}}, "id": 217, "isConstant": false, "isLValue": true, "isPure": false, "lValueRequested": true, "memberName": "length", "nodeType": "MemberAccess", "referencedDeclaration": null, "src": "818:10:1", "typeDescriptions": {"typeIdentifier": "t_uint256", "typeString": "uint256"}}, "nodeType": "Assignment", "operator": "=", "rightHandSide": {"argumentTypes": null, "id": 218, "name": "param", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 167, "src": "831:5:1", "typeDescriptions": {"typeIdentifier": "t_uint256", "typeString": "uint256"}}, "src": "818:18:1", "typeDescriptions": {"typeIdentifier": "t_uint256", "typeString": "uint256"}}, "id": 220, "nodeType": "ExpressionStatement", "src": "818:18:1"}, {"expression": {"argumentTypes": null, "id": 228, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "nodeType": "UnaryOperation", "operator": "--", "prefix": false, "src": "932:22:1", "subExpression": {"argumentTypes": null, "expression": {"argumentTypes": null, "expression": {"argumentTypes": null, "expression": {"argumentTypes": null, "id": 221, "name": "b", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 165, "src": "932:1:1", "typeDescriptions": {"typeIdentifier": "t_struct$_TestStructWithStructWithArray_$161_storage", "typeString": "struct ArrayLengthAssignment.TestStructWithStructWithArray storage ref"}}, "id": 225, "isConstant": false, "isLValue": true, "isPure": false, "lValueRequested": false, "memberName": "subStruct", "nodeType": "MemberAccess", "referencedDeclaration": 157, "src": "932:11:1", "typeDescriptions": {"typeIdentifier": "t_struct$_TestStructWithArray_$155_storage", "typeString": "struct ArrayLengthAssignment.TestStructWithArray storage ref"}}, "id": 226, "isConstant": false, "isLValue": true, "isPure": false, "lValueRequested": false, "memberName": "x", "nodeType": "MemberAccess", "referencedDeclaration": 150, "src": "932:13:1", "typeDescriptions": {"typeIdentifier": "t_array$_t_uint256_$dyn_storage", "typeString": "uint256[] storage ref"}}, "id": 227, "isConstant": false, "isLValue": true, "isPure": false, "lValueRequested": true, "memberName": "length", "nodeType": "MemberAccess", "referencedDeclaration": null, "src": "932:20:1", "typeDescriptions": {"typeIdentifier": "t_uint256", "typeString": "uint256"}}, "typeDescriptions": {"typeIdentifier": "t_uint256", "typeString": "uint256"}}, "id": 229, "nodeType": "ExpressionStatement", "src": "932:22:1"}, {"expression": {"argumentTypes": null, "id": 240, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "leftHandSide": {"argumentTypes": null, "expression": {"argumentTypes": null, "expression": {"argumentTypes": null, "expression": {"argumentTypes": null, "id": 230, "name": "b", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 165, "src": "964:1:1", "typeDescriptions": {"typeIdentifier": "t_struct$_TestStructWithStructWithArray_$161_storage", "typeString": "struct ArrayLengthAssignment.TestStructWithStructWithArray storage ref"}}, "id": 234, "isConstant": false, "isLValue": true, "isPure": false, "lValueRequested": false, "memberName": "subStruct", "nodeType": "MemberAccess", "referencedDeclaration": 157, "src": "964:11:1", "typeDescriptions": {"typeIdentifier": "t_struct$_TestStructWithArray_$155_storage", "typeString": "struct ArrayLengthAssignment.TestStructWithArray storage ref"}}, "id": 235, "isConstant": false, "isLValue": true, "isPure": false, "lValueRequested": false, "memberName": "x", "nodeType": "MemberAccess", "referencedDeclaration": 150, "src": "964:13:1", "typeDescriptions": {"typeIdentifier": "t_array$_t_uint256_$dyn_storage", "typeString": "uint256[] storage ref"}}, "id": 236, "isConstant": false, "isLValue": true, "isPure": false, "lValueRequested": true, "memberName": "length", "nodeType": "MemberAccess", "referencedDeclaration": null, "src": "964:20:1", "typeDescriptions": {"typeIdentifier": "t_uint256", "typeString": "uint256"}}, "nodeType": "Assignment", "operator": "=", "rightHandSide": {"argumentTypes": null, "commonType": {"typeIdentifier": "t_uint256", "typeString": "uint256"}, "id": 239, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "leftExpression": {"argumentTypes": null, "id": 237, "name": "param", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 167, "src": "987:5:1", "typeDescriptions": {"typeIdentifier": "t_uint256", "typeString": "uint256"}}, "nodeType": "BinaryOperation", "operator": "+", "rightExpression": {"argumentTypes": null, "hexValue": "31", "id": 238, "isConstant": false, "isLValue": false, "isPure": true, "kind": "number", "lValueRequested": false, "nodeType": "Literal", "src": "995:1:1", "subdenomination": null, "typeDescriptions": {"typeIdentifier": "t_rational_1_by_1", "typeString": "int_const 1"}, "value": "1"}, "src": "987:9:1", "typeDescriptions": {"typeIdentifier": "t_uint256", "typeString": "uint256"}}, "src": "964:32:1", "typeDescriptions": {"typeIdentifier": "t_uint256", "typeString": "uint256"}}, "id": 241, "nodeType": "ExpressionStatement", "src": "964:32:1"}, {"expression": {"argumentTypes": null, "id": 246, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "leftHandSide": {"argumentTypes": null, "baseExpression": {"argumentTypes": null, "id": 242, "name": "arr3", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 139, "src": "1007:4:1", "typeDescriptions": {"typeIdentifier": "t_array$_t_uint256_$dyn_storage", "typeString": "uint256[] storage ref"}}, "id": 244, "indexExpression": {"argumentTypes": null, "hexValue": "30", "id": 243, "isConstant": false, "isLValue": false, "isPure": true, "kind": "number", "lValueRequested": false, "nodeType": "Literal", "src": "1012:1:1", "subdenomination": null, "typeDescriptions": {"typeIdentifier": "t_rational_0_by_1", "typeString": "int_const 0"}, "value": "0"}, "isConstant": false, "isLValue": true, "isPure": false, "lValueRequested": true, "nodeType": "IndexAccess", "src": "1007:7:1", "typeDescriptions": {"typeIdentifier": "t_uint256", "typeString": "uint256"}}, "nodeType": "Assignment", "operator": "=", "rightHandSide": {"argumentTypes": null, "id": 245, "name": "param2", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 169, "src": "1017:6:1", "typeDescriptions": {"typeIdentifier": "t_uint256", "typeString": "uint256"}}, "src": "1007:16:1", "typeDescriptions": {"typeIdentifier": "t_uint256", "typeString": "uint256"}}, "id": 247, "nodeType": "ExpressionStatement", "src": "1007:16:1"}, {"expression": {"argumentTypes": null, "id": 251, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "nodeType": "UnaryOperation", "operator": "++", "prefix": false, "src": "1033:13:1", "subExpression": {"argumentTypes": null, "expression": {"argumentTypes": null, "id": 248, "name": "arr3", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 139, "src": "1033:4:1", "typeDescriptions": {"typeIdentifier": "t_array$_t_uint256_$dyn_storage", "typeString": "uint256[] storage ref"}}, "id": 250, "isConstant": false, "isLValue": true, "isPure": false, "lValueRequested": true, "memberName": "length", "nodeType": "MemberAccess", "referencedDeclaration": null, "src": "1033:11:1", "typeDescriptions": {"typeIdentifier": "t_uint256", "typeString": "uint256"}}, "typeDescriptions": {"typeIdentifier": "t_uint256", "typeString": "uint256"}}, "id": 252, "nodeType": "ExpressionStatement", "src": "1033:13:1"}]}, "documentation": null, "id": 254, "implemented": true, "kind": "function", "modifiers": [], "name": "f", "nodeType": "FunctionDefinition", "parameters": {"id": 170, "nodeType": "ParameterList", "parameters": [{"constant": false, "id": 167, "name": "param", "nodeType": "VariableDeclaration", "scope": 254, "src": "417:10:1", "stateVariable": false, "storageLocation": "default", "typeDescriptions": {"typeIdentifier": "t_uint256", "typeString": "uint256"}, "typeName": {"id": 166, "name": "uint", "nodeType": "ElementaryTypeName", "src": "417:4:1", "typeDescriptions": {"typeIdentifier": "t_uint256", "typeString": "uint256"}}, "value": null, "visibility": "internal"}, {"constant": false, "id": 169, "name": "param2", "nodeType": "VariableDeclaration", "scope": 254, "src": "429:11:1", "stateVariable": false, "storageLocation": "default", "typeDescriptions": {"typeIdentifier": "t_uint256", "typeString": "uint256"}, "typeName": {"id": 168, "name": "uint", "nodeType": "ElementaryTypeName", "src": "429:4:1", "typeDescriptions": {"typeIdentifier": "t_uint256", "typeString": "uint256"}}, "value": null, "visibility": "internal"}], "src": "416:25:1"}, "returnParameters": {"id": 171, "nodeType": "ParameterList", "parameters": [], "src": "449:0:1"}, "scope": 255, "src": "406:647:1", "stateMutability": "nonpayable", "superFunction": null, "visibility": "public"}], "scope": 256, "src": "0:1055:1"}], "src": "0:1056:1"}, "contracts": {"ArrayLengthAssignment": {"abi": [{"inputs": [], "payable": false, "stateMutability": "nonpayable", "type": "constructor"}, {"constant": false, "inputs": [{"internalType": "uint256", "name": "param", "type": "uint256"}, {"internalType": "uint256", "name": "param2", "type": "uint256"}], "name": "f", "outputs": [], "payable": false, "stateMutability": "nonpayable", "type": "function"}], "bin": "608060405234801561001057600080fd5b50600760008190555061021e806100286000396000f3fe608060405234801561001057600080fd5b506004361061002b5760003560e01c806313d1aa2e14610030575b600080fd5b6100666004803603604081101561004657600080fd5b810190808035906020019092919080359060200190929190505050610068565b005b60016000808282540192505081905550600360005411156100a7576007600181610092919061015e565b50816001816100a1919061015e565b506100ca565b600280548091906001016100bb919061015e565b600081905550600a6000819055505b600460000180548091906001016100e19190610198565b50816004600001816100f39190610198565b50600660000160000180548091906001900361010f9190610198565b50600182016006600001600001816101279190610198565b5080600360008154811061013757fe5b9060005260206000200181905550600380548091906001016101599190610198565b505050565b81548183558181111561019357600101600290048160010160029004836000526020600020918201910161019291906101c4565b5b505050565b8154818355818111156101bf578183600052602060002091820191016101be91906101c4565b5b505050565b6101e691905b808211156101e25760008160009055506001016101ca565b5090565b9056fea265627a7a723158206f62fb46732c73ccb517407815e3976e0608a6ada2e8705578434e01170ff0b164736f6c63430005100032", "bin-runtime": "608060405234801561001057600080fd5b506004361061002b5760003560e01c806313d1aa2e14610030575b600080fd5b6100666004803603604081101561004657600080fd5b810190808035906020019092919080359060200190929190505050610068565b005b60016000808282540192505081905550600360005411156100a7576007600181610092919061015e565b50816001816100a1919061015e565b506100ca565b600280548091906001016100bb919061015e565b600081905550600a6000819055505b600460000180548091906001016100e19190610198565b50816004600001816100f39190610198565b50600660000160000180548091906001900361010f9190610198565b50600182016006600001600001816101279190610198565b5080600360008154811061013757fe5b9060005260206000200181905550600380548091906001016101599190610198565b505050565b81548183558181111561019357600101600290048160010160029004836000526020600020918201910161019291906101c4565b5b505050565b8154818355818111156101bf578183600052602060002091820191016101be91906101c4565b5b505050565b6101e691905b808211156101e25760008160009055506001016101ca565b5090565b9056fea265627a7a723158206f62fb46732c73ccb517407815e3976e0608a6ada2e8705578434e01170ff0b164736f6c63430005100032", "srcmap": "0:1055:1:-;;;108:43;8:9:-1;5:2;;;30:1;27;20:12;5:2;108:43:1;143:1;139;:5;;;;0:1055;;;;;;", "srcmap-runtime": "0:1055:1:-;;;;8:9:-1;5:2;;;30:1;27;20:12;5:2;0:1055:1;;;;;;;;;;;;;;;;;;;406:647;;;;;;13:2:-1;8:3;5:11;2:2;;;29:1;26;19:12;2:2;406:647:1;;;;;;;;;;;;;;;;;;;;;;;;;;:::i;:::-;;;464:1;459;;:6;;;;;;;;;;;482:1;478;;:5;475:240;;;512:1;499:3;:14;;;;;:::i;:::-;;540:5;527:3;:18;;;;;:::i;:::-;;475:240;;;668:4;:13;;;;;;;;;;;:::i;:::-;664:1;:17;;;;699:5;695:1;:9;;;;475:240;796:1;:3;;:12;;;;;;;;;;;:::i;:::-;;831:5;818:1;:3;;:18;;;;;:::i;:::-;;932:1;:11;;:13;;:22;;;;;;;;;;;;:::i;:::-;;995:1;987:5;:9;964:1;:11;;:13;;:32;;;;;:::i;:::-;;1017:6;1007:4;1012:1;1007:7;;;;;;;;;;;;;;;:16;;;;1033:4;:13;;;;;;;;;;;:::i;:::-;;406:647;;:::o;0:1055::-;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;:::i;:::-;;;;;:::o;:::-;;;;;;;;;;;;;;;;;;;;;;;;;;;;:::i;:::-;;;;;:::o;:::-;;;;;;;;;;;;;;;;;;;;;;;;;;;:::o", "filenames": {"absolute": "/Users/alpharush/tob/slither/tests/e2e/detectors/test_data/controlled-array-length/0.5.16/array_length_assignment.sol", "used": "tests/e2e/detectors/test_data/controlled-array-length/0.5.16/array_length_assignment.sol", "short": "tests/e2e/detectors/test_data/controlled-array-length/0.5.16/array_length_assignment.sol", "relative": "tests/e2e/detectors/test_data/controlled-array-length/0.5.16/array_length_assignment.sol"}, "libraries": {}, "is_dependency": false, "userdoc": {"methods": {}, "notice": null}, "devdoc": {"methods": {}, "author": null, "details": null, "title": null}}}}}, "filenames": [{"absolute": "/Users/alpharush/tob/slither/tests/e2e/detectors/test_data/controlled-array-length/0.5.16/array_length_assignment.sol", "used": "tests/e2e/detectors/test_data/controlled-array-length/0.5.16/array_length_assignment.sol", "short": "tests/e2e/detectors/test_data/controlled-array-length/0.5.16/array_length_assignment.sol", "relative": "tests/e2e/detectors/test_data/controlled-array-length/0.5.16/array_length_assignment.sol"}, {"absolute": "/Users/alpharush/tob/slither/tests/e2e/detectors/test_data/controlled-array-length/0.5.16/array_length_assignment.sol", "used": "/Users/alpharush/tob/slither/tests/e2e/detectors/test_data/controlled-array-length/0.5.16/array_length_assignment.sol", "short": "tests/e2e/detectors/test_data/controlled-array-length/0.5.16/array_length_assignment.sol", "relative": "tests/e2e/detectors/test_data/controlled-array-length/0.5.16/array_length_assignment.sol"}]}}, "package": null, "working_dir": "/Users/alpharush/tob/slither", "type": 1, "unit_tests": [], "crytic_version": "0.0.2", "source_content": {"/Users/alpharush/tob/slither/tests/e2e/detectors/test_data/controlled-array-length/0.5.16/array_length_assignment.sol": "contract ArrayLengthAssignment {\n    uint x;\n    uint120[] arr;\n    uint120[] arr2;\n    uint256[] arr3;\n    constructor() public {\n        x = 7;\n    }\n\n    struct TestStructWithArray {\n        uint[] x;\n        uint[][] y;\n    }\n    struct TestStructWithStructWithArray {\n        TestStructWithArray subStruct;\n        uint[] z;\n    }\n\n    TestStructWithArray a;\n    TestStructWithStructWithArray b;\n\n    function f(uint param, uint param2) public {\n        x += 1;\n        if(x > 3) {\n            arr.length = 7;\n            arr.length = param;\n        }\n        else{\n            // Array length that is incremented/decremented should not be found.\n            x = arr2.length++;\n            x = 7 + 3;\n        }\n\n        // Array length setting in structs should not be detected too.\n        a.x.length++;\n        a.x.length = param;\n    \n\n        // Array length setting in embedded structs should not be detected too.\n        b.subStruct.x.length--;\n        b.subStruct.x.length = param + 1;\n\n        arr3[0] = param2;\n        arr3.length++;\n    }\n}\n"}}