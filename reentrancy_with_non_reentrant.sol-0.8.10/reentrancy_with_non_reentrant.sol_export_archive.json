{"compilation_units": {"/Users/alpharush/tob/slither/tests/e2e/detectors/test_data/reentrancy-eth/0.8.10/reentrancy_with_non_reentrant.sol": {"compiler": {"compiler": "solc", "version": "0.8.10", "optimized": false}, "source_units": {"tests/e2e/detectors/test_data/reentrancy-eth/0.8.10/reentrancy_with_non_reentrant.sol": {"ast": {"absolutePath": "tests/e2e/detectors/test_data/reentrancy-eth/0.8.10/reentrancy_with_non_reentrant.sol", "exportedSymbols": {"Receiver": [4], "TestBugWithPublicVariable": [370], "TestWithBug": [73], "TestWithBugInternal": [230], "TestWithBugNonReentrantRead": [427], "TestWithoutBug": [144], "TestWithoutBugInternal": [318]}, "id": 428, "nodeType": "SourceUnit", "nodes": [{"abstract": false, "baseContracts": [], "canonicalName": "Receiver", "contractDependencies": [], "contractKind": "interface", "fullyImplemented": false, "id": 4, "linearizedBaseContracts": [4], "name": "Receiver", "nameLocation": "10:8:0", "nodeType": "ContractDefinition", "nodes": [{"functionSelector": "1ad6506b", "id": 3, "implemented": false, "kind": "function", "modifiers": [], "name": "send_funds", "nameLocation": "33:10:0", "nodeType": "FunctionDefinition", "parameters": {"id": 1, "nodeType": "ParameterList", "parameters": [], "src": "43:2:0"}, "returnParameters": {"id": 2, "nodeType": "ParameterList", "parameters": [], "src": "62:0:0"}, "scope": 4, "src": "24:39:0", "stateMutability": "payable", "virtual": false, "visibility": "external"}], "scope": 428, "src": "0:65:0", "usedErrors": []}, {"abstract": false, "baseContracts": [], "canonicalName": "TestWithBug", "contractDependencies": [], "contractKind": "contract", "fullyImplemented": true, "id": 73, "linearizedBaseContracts": [73], "name": "TestWithBug", "nameLocation": "76:11:0", "nodeType": "ContractDefinition", "nodes": [{"constant": false, "id": 8, "mutability": "mutable", "name": "balances", "nameLocation": "119:8:0", "nodeType": "VariableDeclaration", "scope": 73, "src": "94:33:0", "stateVariable": true, "storageLocation": "default", "typeDescriptions": {"typeIdentifier": "t_mapping$_t_address_$_t_uint256_$", "typeString": "mapping(address => uint256)"}, "typeName": {"id": 7, "keyType": {"id": 5, "name": "address", "nodeType": "ElementaryTypeName", "src": "102:7:0", "typeDescriptions": {"typeIdentifier": "t_address", "typeString": "address"}}, "nodeType": "Mapping", "src": "94:24:0", "typeDescriptions": {"typeIdentifier": "t_mapping$_t_address_$_t_uint256_$", "typeString": "mapping(address => uint256)"}, "valueType": {"id": 6, "name": "uint", "nodeType": "ElementaryTypeName", "src": "113:4:0", "typeDescriptions": {"typeIdentifier": "t_uint256", "typeString": "uint256"}}}, "visibility": "internal"}, {"body": {"id": 11, "nodeType": "Block", "src": "157:18:0", "statements": [{"id": 10, "nodeType": "PlaceholderStatement", "src": "167:1:0"}]}, "id": 12, "name": "nonReentrant", "nameLocation": "143:12:0", "nodeType": "ModifierDefinition", "parameters": {"id": 9, "nodeType": "ParameterList", "parameters": [], "src": "155:2:0"}, "src": "134:41:0", "virtual": false, "visibility": "internal"}, {"body": {"id": 44, "nodeType": "Block", "src": "231:157:0", "statements": [{"expression": {"arguments": [{"commonType": {"typeIdentifier": "t_uint256", "typeString": "uint256"}, "id": 25, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "leftExpression": {"id": 20, "name": "amount", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 14, "src": "250:6:0", "typeDescriptions": {"typeIdentifier": "t_uint256", "typeString": "uint256"}}, "nodeType": "BinaryOperation", "operator": "<=", "rightExpression": {"baseExpression": {"id": 21, "name": "balances", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 8, "src": "260:8:0", "typeDescriptions": {"typeIdentifier": "t_mapping$_t_address_$_t_uint256_$", "typeString": "mapping(address => uint256)"}}, "id": 24, "indexExpression": {"expression": {"id": 22, "name": "msg", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": -15, "src": "269:3:0", "typeDescriptions": {"typeIdentifier": "t_magic_message", "typeString": "msg"}}, "id": 23, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "memberName": "sender", "nodeType": "MemberAccess", "src": "269:10:0", "typeDescriptions": {"typeIdentifier": "t_address", "typeString": "address"}}, "isConstant": false, "isLValue": true, "isPure": false, "lValueRequested": false, "nodeType": "IndexAccess", "src": "260:20:0", "typeDescriptions": {"typeIdentifier": "t_uint256", "typeString": "uint256"}}, "src": "250:30:0", "typeDescriptions": {"typeIdentifier": "t_bool", "typeString": "bool"}}], "expression": {"argumentTypes": [{"typeIdentifier": "t_bool", "typeString": "bool"}], "id": 19, "name": "require", "nodeType": "Identifier", "overloadedDeclarations": [-18, -18], "referencedDeclaration": -18, "src": "242:7:0", "typeDescriptions": {"typeIdentifier": "t_function_require_pure$_t_bool_$returns$__$", "typeString": "function (bool) pure"}}, "id": 26, "isConstant": false, "isLValue": false, "isPure": false, "kind": "functionCall", "lValueRequested": false, "names": [], "nodeType": "FunctionCall", "src": "242:39:0", "tryCall": false, "typeDescriptions": {"typeIdentifier": "t_tuple$__$", "typeString": "tuple()"}}, "id": 27, "nodeType": "ExpressionStatement", "src": "242:39:0"}, {"expression": {"arguments": [], "expression": {"argumentTypes": [], "expression": {"argumentTypes": [], "expression": {"arguments": [{"expression": {"id": 29, "name": "msg", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": -15, "src": "301:3:0", "typeDescriptions": {"typeIdentifier": "t_magic_message", "typeString": "msg"}}, "id": 30, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "memberName": "sender", "nodeType": "MemberAccess", "src": "301:10:0", "typeDescriptions": {"typeIdentifier": "t_address", "typeString": "address"}}], "expression": {"argumentTypes": [{"typeIdentifier": "t_address", "typeString": "address"}], "id": 28, "name": "Receiver", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 4, "src": "292:8:0", "typeDescriptions": {"typeIdentifier": "t_type$_t_contract$_Receiver_$4_$", "typeString": "type(contract Receiver)"}}, "id": 31, "isConstant": false, "isLValue": false, "isPure": false, "kind": "typeConversion", "lValueRequested": false, "names": [], "nodeType": "FunctionCall", "src": "292:20:0", "tryCall": false, "typeDescriptions": {"typeIdentifier": "t_contract$_Receiver_$4", "typeString": "contract Receiver"}}, "id": 32, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "memberName": "send_funds", "nodeType": "MemberAccess", "referencedDeclaration": 3, "src": "292:31:0", "typeDescriptions": {"typeIdentifier": "t_function_external_payable$__$returns$__$", "typeString": "function () payable external"}}, "id": 34, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "names": ["value"], "nodeType": "FunctionCallOptions", "options": [{"id": 33, "name": "amount", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 14, "src": "331:6:0", "typeDescriptions": {"typeIdentifier": "t_uint256", "typeString": "uint256"}}], "src": "292:46:0", "typeDescriptions": {"typeIdentifier": "t_function_external_payable$__$returns$__$value", "typeString": "function () payable external"}}, "id": 35, "isConstant": false, "isLValue": false, "isPure": false, "kind": "functionCall", "lValueRequested": false, "names": [], "nodeType": "FunctionCall", "src": "292:48:0", "tryCall": false, "typeDescriptions": {"typeIdentifier": "t_tuple$__$", "typeString": "tuple()"}}, "id": 36, "nodeType": "ExpressionStatement", "src": "292:48:0"}, {"expression": {"id": 42, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "leftHandSide": {"baseExpression": {"id": 37, "name": "balances", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 8, "src": "351:8:0", "typeDescriptions": {"typeIdentifier": "t_mapping$_t_address_$_t_uint256_$", "typeString": "mapping(address => uint256)"}}, "id": 40, "indexExpression": {"expression": {"id": 38, "name": "msg", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": -15, "src": "360:3:0", "typeDescriptions": {"typeIdentifier": "t_magic_message", "typeString": "msg"}}, "id": 39, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "memberName": "sender", "nodeType": "MemberAccess", "src": "360:10:0", "typeDescriptions": {"typeIdentifier": "t_address", "typeString": "address"}}, "isConstant": false, "isLValue": true, "isPure": false, "lValueRequested": true, "nodeType": "IndexAccess", "src": "351:20:0", "typeDescriptions": {"typeIdentifier": "t_uint256", "typeString": "uint256"}}, "nodeType": "Assignment", "operator": "-=", "rightHandSide": {"id": 41, "name": "amount", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 14, "src": "375:6:0", "typeDescriptions": {"typeIdentifier": "t_uint256", "typeString": "uint256"}}, "src": "351:30:0", "typeDescriptions": {"typeIdentifier": "t_uint256", "typeString": "uint256"}}, "id": 43, "nodeType": "ExpressionStatement", "src": "351:30:0"}]}, "functionSelector": "2e1a7d4d", "id": 45, "implemented": true, "kind": "function", "modifiers": [{"id": 17, "kind": "modifierInvocation", "modifierName": {"id": 16, "name": "nonReentrant", "nodeType": "IdentifierPath", "referencedDeclaration": 12, "src": "212:12:0"}, "nodeType": "ModifierInvocation", "src": "212:12:0"}], "name": "withdraw", "nameLocation": "190:8:0", "nodeType": "FunctionDefinition", "parameters": {"id": 15, "nodeType": "ParameterList", "parameters": [{"constant": false, "id": 14, "mutability": "mutable", "name": "amount", "nameLocation": "204:6:0", "nodeType": "VariableDeclaration", "scope": 45, "src": "199:11:0", "stateVariable": false, "storageLocation": "default", "typeDescriptions": {"typeIdentifier": "t_uint256", "typeString": "uint256"}, "typeName": {"id": 13, "name": "uint", "nodeType": "ElementaryTypeName", "src": "199:4:0", "typeDescriptions": {"typeIdentifier": "t_uint256", "typeString": "uint256"}}, "visibility": "internal"}], "src": "198:13:0"}, "returnParameters": {"id": 18, "nodeType": "ParameterList", "parameters": [], "src": "231:0:0"}, "scope": 73, "src": "181:207:0", "stateMutability": "nonpayable", "virtual": false, "visibility": "public"}, {"body": {"id": 71, "nodeType": "Block", "src": "424:146:0", "statements": [{"assignments": [49], "declarations": [{"constant": false, "id": 49, "mutability": "mutable", "name": "amount", "nameLocation": "440:6:0", "nodeType": "VariableDeclaration", "scope": 71, "src": "435:11:0", "stateVariable": false, "storageLocation": "default", "typeDescriptions": {"typeIdentifier": "t_uint256", "typeString": "uint256"}, "typeName": {"id": 48, "name": "uint", "nodeType": "ElementaryTypeName", "src": "435:4:0", "typeDescriptions": {"typeIdentifier": "t_uint256", "typeString": "uint256"}}, "visibility": "internal"}], "id": 54, "initialValue": {"baseExpression": {"id": 50, "name": "balances", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 8, "src": "449:8:0", "typeDescriptions": {"typeIdentifier": "t_mapping$_t_address_$_t_uint256_$", "typeString": "mapping(address => uint256)"}}, "id": 53, "indexExpression": {"expression": {"id": 51, "name": "msg", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": -15, "src": "458:3:0", "typeDescriptions": {"typeIdentifier": "t_magic_message", "typeString": "msg"}}, "id": 52, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "memberName": "sender", "nodeType": "MemberAccess", "src": "458:10:0", "typeDescriptions": {"typeIdentifier": "t_address", "typeString": "address"}}, "isConstant": false, "isLValue": true, "isPure": false, "lValueRequested": false, "nodeType": "IndexAccess", "src": "449:20:0", "typeDescriptions": {"typeIdentifier": "t_uint256", "typeString": "uint256"}}, "nodeType": "VariableDeclarationStatement", "src": "435:34:0"}, {"expression": {"id": 60, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "leftHandSide": {"baseExpression": {"id": 55, "name": "balances", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 8, "src": "480:8:0", "typeDescriptions": {"typeIdentifier": "t_mapping$_t_address_$_t_uint256_$", "typeString": "mapping(address => uint256)"}}, "id": 58, "indexExpression": {"expression": {"id": 56, "name": "msg", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": -15, "src": "489:3:0", "typeDescriptions": {"typeIdentifier": "t_magic_message", "typeString": "msg"}}, "id": 57, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "memberName": "sender", "nodeType": "MemberAccess", "src": "489:10:0", "typeDescriptions": {"typeIdentifier": "t_address", "typeString": "address"}}, "isConstant": false, "isLValue": true, "isPure": false, "lValueRequested": true, "nodeType": "IndexAccess", "src": "480:20:0", "typeDescriptions": {"typeIdentifier": "t_uint256", "typeString": "uint256"}}, "nodeType": "Assignment", "operator": "=", "rightHandSide": {"hexValue": "30", "id": 59, "isConstant": false, "isLValue": false, "isPure": true, "kind": "number", "lValueRequested": false, "nodeType": "Literal", "src": "503:1:0", "typeDescriptions": {"typeIdentifier": "t_rational_0_by_1", "typeString": "int_const 0"}, "value": "0"}, "src": "480:24:0", "typeDescriptions": {"typeIdentifier": "t_uint256", "typeString": "uint256"}}, "id": 61, "nodeType": "ExpressionStatement", "src": "480:24:0"}, {"expression": {"arguments": [], "expression": {"argumentTypes": [], "expression": {"argumentTypes": [], "expression": {"arguments": [{"expression": {"id": 63, "name": "msg", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": -15, "src": "524:3:0", "typeDescriptions": {"typeIdentifier": "t_magic_message", "typeString": "msg"}}, "id": 64, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "memberName": "sender", "nodeType": "MemberAccess", "src": "524:10:0", "typeDescriptions": {"typeIdentifier": "t_address", "typeString": "address"}}], "expression": {"argumentTypes": [{"typeIdentifier": "t_address", "typeString": "address"}], "id": 62, "name": "Receiver", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 4, "src": "515:8:0", "typeDescriptions": {"typeIdentifier": "t_type$_t_contract$_Receiver_$4_$", "typeString": "type(contract Receiver)"}}, "id": 65, "isConstant": false, "isLValue": false, "isPure": false, "kind": "typeConversion", "lValueRequested": false, "names": [], "nodeType": "FunctionCall", "src": "515:20:0", "tryCall": false, "typeDescriptions": {"typeIdentifier": "t_contract$_Receiver_$4", "typeString": "contract Receiver"}}, "id": 66, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "memberName": "send_funds", "nodeType": "MemberAccess", "referencedDeclaration": 3, "src": "515:31:0", "typeDescriptions": {"typeIdentifier": "t_function_external_payable$__$returns$__$", "typeString": "function () payable external"}}, "id": 68, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "names": ["value"], "nodeType": "FunctionCallOptions", "options": [{"id": 67, "name": "amount", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 49, "src": "554:6:0", "typeDescriptions": {"typeIdentifier": "t_uint256", "typeString": "uint256"}}], "src": "515:46:0", "typeDescriptions": {"typeIdentifier": "t_function_external_payable$__$returns$__$value", "typeString": "function () payable external"}}, "id": 69, "isConstant": false, "isLValue": false, "isPure": false, "kind": "functionCall", "lValueRequested": false, "names": [], "nodeType": "FunctionCall", "src": "515:48:0", "tryCall": false, "typeDescriptions": {"typeIdentifier": "t_tuple$__$", "typeString": "tuple()"}}, "id": 70, "nodeType": "ExpressionStatement", "src": "515:48:0"}]}, "functionSelector": "dd473d2b", "id": 72, "implemented": true, "kind": "function", "modifiers": [], "name": "withdraw_all", "nameLocation": "403:12:0", "nodeType": "FunctionDefinition", "parameters": {"id": 46, "nodeType": "ParameterList", "parameters": [], "src": "415:2:0"}, "returnParameters": {"id": 47, "nodeType": "ParameterList", "parameters": [], "src": "424:0:0"}, "scope": 73, "src": "394:176:0", "stateMutability": "nonpayable", "virtual": false, "visibility": "public"}], "scope": 428, "src": "67:506:0", "usedErrors": []}, {"abstract": false, "baseContracts": [], "canonicalName": "TestWithoutBug", "contractDependencies": [], "contractKind": "contract", "fullyImplemented": true, "id": 144, "linearizedBaseContracts": [144], "name": "TestWithoutBug", "nameLocation": "585:14:0", "nodeType": "ContractDefinition", "nodes": [{"constant": false, "id": 77, "mutability": "mutable", "name": "balances", "nameLocation": "631:8:0", "nodeType": "VariableDeclaration", "scope": 144, "src": "606:33:0", "stateVariable": true, "storageLocation": "default", "typeDescriptions": {"typeIdentifier": "t_mapping$_t_address_$_t_uint256_$", "typeString": "mapping(address => uint256)"}, "typeName": {"id": 76, "keyType": {"id": 74, "name": "address", "nodeType": "ElementaryTypeName", "src": "614:7:0", "typeDescriptions": {"typeIdentifier": "t_address", "typeString": "address"}}, "nodeType": "Mapping", "src": "606:24:0", "typeDescriptions": {"typeIdentifier": "t_mapping$_t_address_$_t_uint256_$", "typeString": "mapping(address => uint256)"}, "valueType": {"id": 75, "name": "uint", "nodeType": "ElementaryTypeName", "src": "625:4:0", "typeDescriptions": {"typeIdentifier": "t_uint256", "typeString": "uint256"}}}, "visibility": "internal"}, {"body": {"id": 80, "nodeType": "Block", "src": "669:18:0", "statements": [{"id": 79, "nodeType": "PlaceholderStatement", "src": "679:1:0"}]}, "id": 81, "name": "nonReentrant", "nameLocation": "655:12:0", "nodeType": "ModifierDefinition", "parameters": {"id": 78, "nodeType": "ParameterList", "parameters": [], "src": "667:2:0"}, "src": "646:41:0", "virtual": false, "visibility": "internal"}, {"body": {"id": 113, "nodeType": "Block", "src": "743:157:0", "statements": [{"expression": {"arguments": [{"commonType": {"typeIdentifier": "t_uint256", "typeString": "uint256"}, "id": 94, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "leftExpression": {"id": 89, "name": "amount", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 83, "src": "762:6:0", "typeDescriptions": {"typeIdentifier": "t_uint256", "typeString": "uint256"}}, "nodeType": "BinaryOperation", "operator": "<=", "rightExpression": {"baseExpression": {"id": 90, "name": "balances", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 77, "src": "772:8:0", "typeDescriptions": {"typeIdentifier": "t_mapping$_t_address_$_t_uint256_$", "typeString": "mapping(address => uint256)"}}, "id": 93, "indexExpression": {"expression": {"id": 91, "name": "msg", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": -15, "src": "781:3:0", "typeDescriptions": {"typeIdentifier": "t_magic_message", "typeString": "msg"}}, "id": 92, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "memberName": "sender", "nodeType": "MemberAccess", "src": "781:10:0", "typeDescriptions": {"typeIdentifier": "t_address", "typeString": "address"}}, "isConstant": false, "isLValue": true, "isPure": false, "lValueRequested": false, "nodeType": "IndexAccess", "src": "772:20:0", "typeDescriptions": {"typeIdentifier": "t_uint256", "typeString": "uint256"}}, "src": "762:30:0", "typeDescriptions": {"typeIdentifier": "t_bool", "typeString": "bool"}}], "expression": {"argumentTypes": [{"typeIdentifier": "t_bool", "typeString": "bool"}], "id": 88, "name": "require", "nodeType": "Identifier", "overloadedDeclarations": [-18, -18], "referencedDeclaration": -18, "src": "754:7:0", "typeDescriptions": {"typeIdentifier": "t_function_require_pure$_t_bool_$returns$__$", "typeString": "function (bool) pure"}}, "id": 95, "isConstant": false, "isLValue": false, "isPure": false, "kind": "functionCall", "lValueRequested": false, "names": [], "nodeType": "FunctionCall", "src": "754:39:0", "tryCall": false, "typeDescriptions": {"typeIdentifier": "t_tuple$__$", "typeString": "tuple()"}}, "id": 96, "nodeType": "ExpressionStatement", "src": "754:39:0"}, {"expression": {"arguments": [], "expression": {"argumentTypes": [], "expression": {"argumentTypes": [], "expression": {"arguments": [{"expression": {"id": 98, "name": "msg", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": -15, "src": "813:3:0", "typeDescriptions": {"typeIdentifier": "t_magic_message", "typeString": "msg"}}, "id": 99, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "memberName": "sender", "nodeType": "MemberAccess", "src": "813:10:0", "typeDescriptions": {"typeIdentifier": "t_address", "typeString": "address"}}], "expression": {"argumentTypes": [{"typeIdentifier": "t_address", "typeString": "address"}], "id": 97, "name": "Receiver", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 4, "src": "804:8:0", "typeDescriptions": {"typeIdentifier": "t_type$_t_contract$_Receiver_$4_$", "typeString": "type(contract Receiver)"}}, "id": 100, "isConstant": false, "isLValue": false, "isPure": false, "kind": "typeConversion", "lValueRequested": false, "names": [], "nodeType": "FunctionCall", "src": "804:20:0", "tryCall": false, "typeDescriptions": {"typeIdentifier": "t_contract$_Receiver_$4", "typeString": "contract Receiver"}}, "id": 101, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "memberName": "send_funds", "nodeType": "MemberAccess", "referencedDeclaration": 3, "src": "804:31:0", "typeDescriptions": {"typeIdentifier": "t_function_external_payable$__$returns$__$", "typeString": "function () payable external"}}, "id": 103, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "names": ["value"], "nodeType": "FunctionCallOptions", "options": [{"id": 102, "name": "amount", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 83, "src": "843:6:0", "typeDescriptions": {"typeIdentifier": "t_uint256", "typeString": "uint256"}}], "src": "804:46:0", "typeDescriptions": {"typeIdentifier": "t_function_external_payable$__$returns$__$value", "typeString": "function () payable external"}}, "id": 104, "isConstant": false, "isLValue": false, "isPure": false, "kind": "functionCall", "lValueRequested": false, "names": [], "nodeType": "FunctionCall", "src": "804:48:0", "tryCall": false, "typeDescriptions": {"typeIdentifier": "t_tuple$__$", "typeString": "tuple()"}}, "id": 105, "nodeType": "ExpressionStatement", "src": "804:48:0"}, {"expression": {"id": 111, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "leftHandSide": {"baseExpression": {"id": 106, "name": "balances", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 77, "src": "863:8:0", "typeDescriptions": {"typeIdentifier": "t_mapping$_t_address_$_t_uint256_$", "typeString": "mapping(address => uint256)"}}, "id": 109, "indexExpression": {"expression": {"id": 107, "name": "msg", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": -15, "src": "872:3:0", "typeDescriptions": {"typeIdentifier": "t_magic_message", "typeString": "msg"}}, "id": 108, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "memberName": "sender", "nodeType": "MemberAccess", "src": "872:10:0", "typeDescriptions": {"typeIdentifier": "t_address", "typeString": "address"}}, "isConstant": false, "isLValue": true, "isPure": false, "lValueRequested": true, "nodeType": "IndexAccess", "src": "863:20:0", "typeDescriptions": {"typeIdentifier": "t_uint256", "typeString": "uint256"}}, "nodeType": "Assignment", "operator": "-=", "rightHandSide": {"id": 110, "name": "amount", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 83, "src": "887:6:0", "typeDescriptions": {"typeIdentifier": "t_uint256", "typeString": "uint256"}}, "src": "863:30:0", "typeDescriptions": {"typeIdentifier": "t_uint256", "typeString": "uint256"}}, "id": 112, "nodeType": "ExpressionStatement", "src": "863:30:0"}]}, "functionSelector": "2e1a7d4d", "id": 114, "implemented": true, "kind": "function", "modifiers": [{"id": 86, "kind": "modifierInvocation", "modifierName": {"id": 85, "name": "nonReentrant", "nodeType": "IdentifierPath", "referencedDeclaration": 81, "src": "724:12:0"}, "nodeType": "ModifierInvocation", "src": "724:12:0"}], "name": "withdraw", "nameLocation": "702:8:0", "nodeType": "FunctionDefinition", "parameters": {"id": 84, "nodeType": "ParameterList", "parameters": [{"constant": false, "id": 83, "mutability": "mutable", "name": "amount", "nameLocation": "716:6:0", "nodeType": "VariableDeclaration", "scope": 114, "src": "711:11:0", "stateVariable": false, "storageLocation": "default", "typeDescriptions": {"typeIdentifier": "t_uint256", "typeString": "uint256"}, "typeName": {"id": 82, "name": "uint", "nodeType": "ElementaryTypeName", "src": "711:4:0", "typeDescriptions": {"typeIdentifier": "t_uint256", "typeString": "uint256"}}, "visibility": "internal"}], "src": "710:13:0"}, "returnParameters": {"id": 87, "nodeType": "ParameterList", "parameters": [], "src": "743:0:0"}, "scope": 144, "src": "693:207:0", "stateMutability": "nonpayable", "virtual": false, "visibility": "public"}, {"body": {"id": 142, "nodeType": "Block", "src": "949:146:0", "statements": [{"assignments": [120], "declarations": [{"constant": false, "id": 120, "mutability": "mutable", "name": "amount", "nameLocation": "965:6:0", "nodeType": "VariableDeclaration", "scope": 142, "src": "960:11:0", "stateVariable": false, "storageLocation": "default", "typeDescriptions": {"typeIdentifier": "t_uint256", "typeString": "uint256"}, "typeName": {"id": 119, "name": "uint", "nodeType": "ElementaryTypeName", "src": "960:4:0", "typeDescriptions": {"typeIdentifier": "t_uint256", "typeString": "uint256"}}, "visibility": "internal"}], "id": 125, "initialValue": {"baseExpression": {"id": 121, "name": "balances", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 77, "src": "974:8:0", "typeDescriptions": {"typeIdentifier": "t_mapping$_t_address_$_t_uint256_$", "typeString": "mapping(address => uint256)"}}, "id": 124, "indexExpression": {"expression": {"id": 122, "name": "msg", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": -15, "src": "983:3:0", "typeDescriptions": {"typeIdentifier": "t_magic_message", "typeString": "msg"}}, "id": 123, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "memberName": "sender", "nodeType": "MemberAccess", "src": "983:10:0", "typeDescriptions": {"typeIdentifier": "t_address", "typeString": "address"}}, "isConstant": false, "isLValue": true, "isPure": false, "lValueRequested": false, "nodeType": "IndexAccess", "src": "974:20:0", "typeDescriptions": {"typeIdentifier": "t_uint256", "typeString": "uint256"}}, "nodeType": "VariableDeclarationStatement", "src": "960:34:0"}, {"expression": {"id": 131, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "leftHandSide": {"baseExpression": {"id": 126, "name": "balances", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 77, "src": "1005:8:0", "typeDescriptions": {"typeIdentifier": "t_mapping$_t_address_$_t_uint256_$", "typeString": "mapping(address => uint256)"}}, "id": 129, "indexExpression": {"expression": {"id": 127, "name": "msg", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": -15, "src": "1014:3:0", "typeDescriptions": {"typeIdentifier": "t_magic_message", "typeString": "msg"}}, "id": 128, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "memberName": "sender", "nodeType": "MemberAccess", "src": "1014:10:0", "typeDescriptions": {"typeIdentifier": "t_address", "typeString": "address"}}, "isConstant": false, "isLValue": true, "isPure": false, "lValueRequested": true, "nodeType": "IndexAccess", "src": "1005:20:0", "typeDescriptions": {"typeIdentifier": "t_uint256", "typeString": "uint256"}}, "nodeType": "Assignment", "operator": "=", "rightHandSide": {"hexValue": "30", "id": 130, "isConstant": false, "isLValue": false, "isPure": true, "kind": "number", "lValueRequested": false, "nodeType": "Literal", "src": "1028:1:0", "typeDescriptions": {"typeIdentifier": "t_rational_0_by_1", "typeString": "int_const 0"}, "value": "0"}, "src": "1005:24:0", "typeDescriptions": {"typeIdentifier": "t_uint256", "typeString": "uint256"}}, "id": 132, "nodeType": "ExpressionStatement", "src": "1005:24:0"}, {"expression": {"arguments": [], "expression": {"argumentTypes": [], "expression": {"argumentTypes": [], "expression": {"arguments": [{"expression": {"id": 134, "name": "msg", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": -15, "src": "1049:3:0", "typeDescriptions": {"typeIdentifier": "t_magic_message", "typeString": "msg"}}, "id": 135, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "memberName": "sender", "nodeType": "MemberAccess", "src": "1049:10:0", "typeDescriptions": {"typeIdentifier": "t_address", "typeString": "address"}}], "expression": {"argumentTypes": [{"typeIdentifier": "t_address", "typeString": "address"}], "id": 133, "name": "Receiver", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 4, "src": "1040:8:0", "typeDescriptions": {"typeIdentifier": "t_type$_t_contract$_Receiver_$4_$", "typeString": "type(contract Receiver)"}}, "id": 136, "isConstant": false, "isLValue": false, "isPure": false, "kind": "typeConversion", "lValueRequested": false, "names": [], "nodeType": "FunctionCall", "src": "1040:20:0", "tryCall": false, "typeDescriptions": {"typeIdentifier": "t_contract$_Receiver_$4", "typeString": "contract Receiver"}}, "id": 137, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "memberName": "send_funds", "nodeType": "MemberAccess", "referencedDeclaration": 3, "src": "1040:31:0", "typeDescriptions": {"typeIdentifier": "t_function_external_payable$__$returns$__$", "typeString": "function () payable external"}}, "id": 139, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "names": ["value"], "nodeType": "FunctionCallOptions", "options": [{"id": 138, "name": "amount", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 120, "src": "1079:6:0", "typeDescriptions": {"typeIdentifier": "t_uint256", "typeString": "uint256"}}], "src": "1040:46:0", "typeDescriptions": {"typeIdentifier": "t_function_external_payable$__$returns$__$value", "typeString": "function () payable external"}}, "id": 140, "isConstant": false, "isLValue": false, "isPure": false, "kind": "functionCall", "lValueRequested": false, "names": [], "nodeType": "FunctionCall", "src": "1040:48:0", "tryCall": false, "typeDescriptions": {"typeIdentifier": "t_tuple$__$", "typeString": "tuple()"}}, "id": 141, "nodeType": "ExpressionStatement", "src": "1040:48:0"}]}, "functionSelector": "dd473d2b", "id": 143, "implemented": true, "kind": "function", "modifiers": [{"id": 117, "kind": "modifierInvocation", "modifierName": {"id": 116, "name": "nonReentrant", "nodeType": "IdentifierPath", "referencedDeclaration": 81, "src": "930:12:0"}, "nodeType": "ModifierInvocation", "src": "930:12:0"}], "name": "withdraw_all", "nameLocation": "915:12:0", "nodeType": "FunctionDefinition", "parameters": {"id": 115, "nodeType": "ParameterList", "parameters": [], "src": "927:2:0"}, "returnParameters": {"id": 118, "nodeType": "ParameterList", "parameters": [], "src": "949:0:0"}, "scope": 144, "src": "906:189:0", "stateMutability": "nonpayable", "virtual": false, "visibility": "public"}], "scope": 428, "src": "576:522:0", "usedErrors": []}, {"abstract": false, "baseContracts": [], "canonicalName": "TestWithBugInternal", "contractDependencies": [], "contractKind": "contract", "fullyImplemented": true, "id": 230, "linearizedBaseContracts": [230], "name": "TestWithBugInternal", "nameLocation": "1109:19:0", "nodeType": "ContractDefinition", "nodes": [{"constant": false, "id": 148, "mutability": "mutable", "name": "balances", "nameLocation": "1160:8:0", "nodeType": "VariableDeclaration", "scope": 230, "src": "1135:33:0", "stateVariable": true, "storageLocation": "default", "typeDescriptions": {"typeIdentifier": "t_mapping$_t_address_$_t_uint256_$", "typeString": "mapping(address => uint256)"}, "typeName": {"id": 147, "keyType": {"id": 145, "name": "address", "nodeType": "ElementaryTypeName", "src": "1143:7:0", "typeDescriptions": {"typeIdentifier": "t_address", "typeString": "address"}}, "nodeType": "Mapping", "src": "1135:24:0", "typeDescriptions": {"typeIdentifier": "t_mapping$_t_address_$_t_uint256_$", "typeString": "mapping(address => uint256)"}, "valueType": {"id": 146, "name": "uint", "nodeType": "ElementaryTypeName", "src": "1154:4:0", "typeDescriptions": {"typeIdentifier": "t_uint256", "typeString": "uint256"}}}, "visibility": "internal"}, {"body": {"id": 151, "nodeType": "Block", "src": "1198:18:0", "statements": [{"id": 150, "nodeType": "PlaceholderStatement", "src": "1208:1:0"}]}, "id": 152, "name": "nonReentrant", "nameLocation": "1184:12:0", "nodeType": "ModifierDefinition", "parameters": {"id": 149, "nodeType": "ParameterList", "parameters": [], "src": "1196:2:0"}, "src": "1175:41:0", "virtual": false, "visibility": "internal"}, {"body": {"id": 163, "nodeType": "Block", "src": "1272:42:0", "statements": [{"expression": {"arguments": [{"id": 160, "name": "amount", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 154, "src": "1300:6:0", "typeDescriptions": {"typeIdentifier": "t_uint256", "typeString": "uint256"}}], "expression": {"argumentTypes": [{"typeIdentifier": "t_uint256", "typeString": "uint256"}], "id": 159, "name": "withdraw_internal", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 195, "src": "1282:17:0", "typeDescriptions": {"typeIdentifier": "t_function_internal_nonpayable$_t_uint256_$returns$__$", "typeString": "function (uint256)"}}, "id": 161, "isConstant": false, "isLValue": false, "isPure": false, "kind": "functionCall", "lValueRequested": false, "names": [], "nodeType": "FunctionCall", "src": "1282:25:0", "tryCall": false, "typeDescriptions": {"typeIdentifier": "t_tuple$__$", "typeString": "tuple()"}}, "id": 162, "nodeType": "ExpressionStatement", "src": "1282:25:0"}]}, "functionSelector": "2e1a7d4d", "id": 164, "implemented": true, "kind": "function", "modifiers": [{"id": 157, "kind": "modifierInvocation", "modifierName": {"id": 156, "name": "nonReentrant", "nodeType": "IdentifierPath", "referencedDeclaration": 152, "src": "1253:12:0"}, "nodeType": "ModifierInvocation", "src": "1253:12:0"}], "name": "withdraw", "nameLocation": "1231:8:0", "nodeType": "FunctionDefinition", "parameters": {"id": 155, "nodeType": "ParameterList", "parameters": [{"constant": false, "id": 154, "mutability": "mutable", "name": "amount", "nameLocation": "1245:6:0", "nodeType": "VariableDeclaration", "scope": 164, "src": "1240:11:0", "stateVariable": false, "storageLocation": "default", "typeDescriptions": {"typeIdentifier": "t_uint256", "typeString": "uint256"}, "typeName": {"id": 153, "name": "uint", "nodeType": "ElementaryTypeName", "src": "1240:4:0", "typeDescriptions": {"typeIdentifier": "t_uint256", "typeString": "uint256"}}, "visibility": "internal"}], "src": "1239:13:0"}, "returnParameters": {"id": 158, "nodeType": "ParameterList", "parameters": [], "src": "1272:0:0"}, "scope": 230, "src": "1222:92:0", "stateMutability": "nonpayable", "virtual": false, "visibility": "public"}, {"body": {"id": 194, "nodeType": "Block", "src": "1368:157:0", "statements": [{"expression": {"arguments": [{"commonType": {"typeIdentifier": "t_uint256", "typeString": "uint256"}, "id": 175, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "leftExpression": {"id": 170, "name": "amount", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 166, "src": "1387:6:0", "typeDescriptions": {"typeIdentifier": "t_uint256", "typeString": "uint256"}}, "nodeType": "BinaryOperation", "operator": "<=", "rightExpression": {"baseExpression": {"id": 171, "name": "balances", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 148, "src": "1397:8:0", "typeDescriptions": {"typeIdentifier": "t_mapping$_t_address_$_t_uint256_$", "typeString": "mapping(address => uint256)"}}, "id": 174, "indexExpression": {"expression": {"id": 172, "name": "msg", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": -15, "src": "1406:3:0", "typeDescriptions": {"typeIdentifier": "t_magic_message", "typeString": "msg"}}, "id": 173, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "memberName": "sender", "nodeType": "MemberAccess", "src": "1406:10:0", "typeDescriptions": {"typeIdentifier": "t_address", "typeString": "address"}}, "isConstant": false, "isLValue": true, "isPure": false, "lValueRequested": false, "nodeType": "IndexAccess", "src": "1397:20:0", "typeDescriptions": {"typeIdentifier": "t_uint256", "typeString": "uint256"}}, "src": "1387:30:0", "typeDescriptions": {"typeIdentifier": "t_bool", "typeString": "bool"}}], "expression": {"argumentTypes": [{"typeIdentifier": "t_bool", "typeString": "bool"}], "id": 169, "name": "require", "nodeType": "Identifier", "overloadedDeclarations": [-18, -18], "referencedDeclaration": -18, "src": "1379:7:0", "typeDescriptions": {"typeIdentifier": "t_function_require_pure$_t_bool_$returns$__$", "typeString": "function (bool) pure"}}, "id": 176, "isConstant": false, "isLValue": false, "isPure": false, "kind": "functionCall", "lValueRequested": false, "names": [], "nodeType": "FunctionCall", "src": "1379:39:0", "tryCall": false, "typeDescriptions": {"typeIdentifier": "t_tuple$__$", "typeString": "tuple()"}}, "id": 177, "nodeType": "ExpressionStatement", "src": "1379:39:0"}, {"expression": {"arguments": [], "expression": {"argumentTypes": [], "expression": {"argumentTypes": [], "expression": {"arguments": [{"expression": {"id": 179, "name": "msg", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": -15, "src": "1438:3:0", "typeDescriptions": {"typeIdentifier": "t_magic_message", "typeString": "msg"}}, "id": 180, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "memberName": "sender", "nodeType": "MemberAccess", "src": "1438:10:0", "typeDescriptions": {"typeIdentifier": "t_address", "typeString": "address"}}], "expression": {"argumentTypes": [{"typeIdentifier": "t_address", "typeString": "address"}], "id": 178, "name": "Receiver", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 4, "src": "1429:8:0", "typeDescriptions": {"typeIdentifier": "t_type$_t_contract$_Receiver_$4_$", "typeString": "type(contract Receiver)"}}, "id": 181, "isConstant": false, "isLValue": false, "isPure": false, "kind": "typeConversion", "lValueRequested": false, "names": [], "nodeType": "FunctionCall", "src": "1429:20:0", "tryCall": false, "typeDescriptions": {"typeIdentifier": "t_contract$_Receiver_$4", "typeString": "contract Receiver"}}, "id": 182, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "memberName": "send_funds", "nodeType": "MemberAccess", "referencedDeclaration": 3, "src": "1429:31:0", "typeDescriptions": {"typeIdentifier": "t_function_external_payable$__$returns$__$", "typeString": "function () payable external"}}, "id": 184, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "names": ["value"], "nodeType": "FunctionCallOptions", "options": [{"id": 183, "name": "amount", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 166, "src": "1468:6:0", "typeDescriptions": {"typeIdentifier": "t_uint256", "typeString": "uint256"}}], "src": "1429:46:0", "typeDescriptions": {"typeIdentifier": "t_function_external_payable$__$returns$__$value", "typeString": "function () payable external"}}, "id": 185, "isConstant": false, "isLValue": false, "isPure": false, "kind": "functionCall", "lValueRequested": false, "names": [], "nodeType": "FunctionCall", "src": "1429:48:0", "tryCall": false, "typeDescriptions": {"typeIdentifier": "t_tuple$__$", "typeString": "tuple()"}}, "id": 186, "nodeType": "ExpressionStatement", "src": "1429:48:0"}, {"expression": {"id": 192, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "leftHandSide": {"baseExpression": {"id": 187, "name": "balances", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 148, "src": "1488:8:0", "typeDescriptions": {"typeIdentifier": "t_mapping$_t_address_$_t_uint256_$", "typeString": "mapping(address => uint256)"}}, "id": 190, "indexExpression": {"expression": {"id": 188, "name": "msg", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": -15, "src": "1497:3:0", "typeDescriptions": {"typeIdentifier": "t_magic_message", "typeString": "msg"}}, "id": 189, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "memberName": "sender", "nodeType": "MemberAccess", "src": "1497:10:0", "typeDescriptions": {"typeIdentifier": "t_address", "typeString": "address"}}, "isConstant": false, "isLValue": true, "isPure": false, "lValueRequested": true, "nodeType": "IndexAccess", "src": "1488:20:0", "typeDescriptions": {"typeIdentifier": "t_uint256", "typeString": "uint256"}}, "nodeType": "Assignment", "operator": "-=", "rightHandSide": {"id": 191, "name": "amount", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 166, "src": "1512:6:0", "typeDescriptions": {"typeIdentifier": "t_uint256", "typeString": "uint256"}}, "src": "1488:30:0", "typeDescriptions": {"typeIdentifier": "t_uint256", "typeString": "uint256"}}, "id": 193, "nodeType": "ExpressionStatement", "src": "1488:30:0"}]}, "id": 195, "implemented": true, "kind": "function", "modifiers": [], "name": "withdraw_internal", "nameLocation": "1329:17:0", "nodeType": "FunctionDefinition", "parameters": {"id": 167, "nodeType": "ParameterList", "parameters": [{"constant": false, "id": 166, "mutability": "mutable", "name": "amount", "nameLocation": "1352:6:0", "nodeType": "VariableDeclaration", "scope": 195, "src": "1347:11:0", "stateVariable": false, "storageLocation": "default", "typeDescriptions": {"typeIdentifier": "t_uint256", "typeString": "uint256"}, "typeName": {"id": 165, "name": "uint", "nodeType": "ElementaryTypeName", "src": "1347:4:0", "typeDescriptions": {"typeIdentifier": "t_uint256", "typeString": "uint256"}}, "visibility": "internal"}], "src": "1346:13:0"}, "returnParameters": {"id": 168, "nodeType": "ParameterList", "parameters": [], "src": "1368:0:0"}, "scope": 230, "src": "1320:205:0", "stateMutability": "nonpayable", "virtual": false, "visibility": "internal"}, {"body": {"id": 201, "nodeType": "Block", "src": "1561:40:0", "statements": [{"expression": {"arguments": [], "expression": {"argumentTypes": [], "id": 198, "name": "withdraw_all_internal", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 229, "src": "1571:21:0", "typeDescriptions": {"typeIdentifier": "t_function_internal_nonpayable$__$returns$__$", "typeString": "function ()"}}, "id": 199, "isConstant": false, "isLValue": false, "isPure": false, "kind": "functionCall", "lValueRequested": false, "names": [], "nodeType": "FunctionCall", "src": "1571:23:0", "tryCall": false, "typeDescriptions": {"typeIdentifier": "t_tuple$__$", "typeString": "tuple()"}}, "id": 200, "nodeType": "ExpressionStatement", "src": "1571:23:0"}]}, "functionSelector": "dd473d2b", "id": 202, "implemented": true, "kind": "function", "modifiers": [], "name": "withdraw_all", "nameLocation": "1540:12:0", "nodeType": "FunctionDefinition", "parameters": {"id": 196, "nodeType": "ParameterList", "parameters": [], "src": "1552:2:0"}, "returnParameters": {"id": 197, "nodeType": "ParameterList", "parameters": [], "src": "1561:0:0"}, "scope": 230, "src": "1531:70:0", "stateMutability": "nonpayable", "virtual": false, "visibility": "public"}, {"body": {"id": 228, "nodeType": "Block", "src": "1649:146:0", "statements": [{"assignments": [206], "declarations": [{"constant": false, "id": 206, "mutability": "mutable", "name": "amount", "nameLocation": "1665:6:0", "nodeType": "VariableDeclaration", "scope": 228, "src": "1660:11:0", "stateVariable": false, "storageLocation": "default", "typeDescriptions": {"typeIdentifier": "t_uint256", "typeString": "uint256"}, "typeName": {"id": 205, "name": "uint", "nodeType": "ElementaryTypeName", "src": "1660:4:0", "typeDescriptions": {"typeIdentifier": "t_uint256", "typeString": "uint256"}}, "visibility": "internal"}], "id": 211, "initialValue": {"baseExpression": {"id": 207, "name": "balances", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 148, "src": "1674:8:0", "typeDescriptions": {"typeIdentifier": "t_mapping$_t_address_$_t_uint256_$", "typeString": "mapping(address => uint256)"}}, "id": 210, "indexExpression": {"expression": {"id": 208, "name": "msg", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": -15, "src": "1683:3:0", "typeDescriptions": {"typeIdentifier": "t_magic_message", "typeString": "msg"}}, "id": 209, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "memberName": "sender", "nodeType": "MemberAccess", "src": "1683:10:0", "typeDescriptions": {"typeIdentifier": "t_address", "typeString": "address"}}, "isConstant": false, "isLValue": true, "isPure": false, "lValueRequested": false, "nodeType": "IndexAccess", "src": "1674:20:0", "typeDescriptions": {"typeIdentifier": "t_uint256", "typeString": "uint256"}}, "nodeType": "VariableDeclarationStatement", "src": "1660:34:0"}, {"expression": {"id": 217, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "leftHandSide": {"baseExpression": {"id": 212, "name": "balances", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 148, "src": "1705:8:0", "typeDescriptions": {"typeIdentifier": "t_mapping$_t_address_$_t_uint256_$", "typeString": "mapping(address => uint256)"}}, "id": 215, "indexExpression": {"expression": {"id": 213, "name": "msg", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": -15, "src": "1714:3:0", "typeDescriptions": {"typeIdentifier": "t_magic_message", "typeString": "msg"}}, "id": 214, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "memberName": "sender", "nodeType": "MemberAccess", "src": "1714:10:0", "typeDescriptions": {"typeIdentifier": "t_address", "typeString": "address"}}, "isConstant": false, "isLValue": true, "isPure": false, "lValueRequested": true, "nodeType": "IndexAccess", "src": "1705:20:0", "typeDescriptions": {"typeIdentifier": "t_uint256", "typeString": "uint256"}}, "nodeType": "Assignment", "operator": "=", "rightHandSide": {"hexValue": "30", "id": 216, "isConstant": false, "isLValue": false, "isPure": true, "kind": "number", "lValueRequested": false, "nodeType": "Literal", "src": "1728:1:0", "typeDescriptions": {"typeIdentifier": "t_rational_0_by_1", "typeString": "int_const 0"}, "value": "0"}, "src": "1705:24:0", "typeDescriptions": {"typeIdentifier": "t_uint256", "typeString": "uint256"}}, "id": 218, "nodeType": "ExpressionStatement", "src": "1705:24:0"}, {"expression": {"arguments": [], "expression": {"argumentTypes": [], "expression": {"argumentTypes": [], "expression": {"arguments": [{"expression": {"id": 220, "name": "msg", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": -15, "src": "1749:3:0", "typeDescriptions": {"typeIdentifier": "t_magic_message", "typeString": "msg"}}, "id": 221, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "memberName": "sender", "nodeType": "MemberAccess", "src": "1749:10:0", "typeDescriptions": {"typeIdentifier": "t_address", "typeString": "address"}}], "expression": {"argumentTypes": [{"typeIdentifier": "t_address", "typeString": "address"}], "id": 219, "name": "Receiver", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 4, "src": "1740:8:0", "typeDescriptions": {"typeIdentifier": "t_type$_t_contract$_Receiver_$4_$", "typeString": "type(contract Receiver)"}}, "id": 222, "isConstant": false, "isLValue": false, "isPure": false, "kind": "typeConversion", "lValueRequested": false, "names": [], "nodeType": "FunctionCall", "src": "1740:20:0", "tryCall": false, "typeDescriptions": {"typeIdentifier": "t_contract$_Receiver_$4", "typeString": "contract Receiver"}}, "id": 223, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "memberName": "send_funds", "nodeType": "MemberAccess", "referencedDeclaration": 3, "src": "1740:31:0", "typeDescriptions": {"typeIdentifier": "t_function_external_payable$__$returns$__$", "typeString": "function () payable external"}}, "id": 225, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "names": ["value"], "nodeType": "FunctionCallOptions", "options": [{"id": 224, "name": "amount", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 206, "src": "1779:6:0", "typeDescriptions": {"typeIdentifier": "t_uint256", "typeString": "uint256"}}], "src": "1740:46:0", "typeDescriptions": {"typeIdentifier": "t_function_external_payable$__$returns$__$value", "typeString": "function () payable external"}}, "id": 226, "isConstant": false, "isLValue": false, "isPure": false, "kind": "functionCall", "lValueRequested": false, "names": [], "nodeType": "FunctionCall", "src": "1740:48:0", "tryCall": false, "typeDescriptions": {"typeIdentifier": "t_tuple$__$", "typeString": "tuple()"}}, "id": 227, "nodeType": "ExpressionStatement", "src": "1740:48:0"}]}, "id": 229, "implemented": true, "kind": "function", "modifiers": [], "name": "withdraw_all_internal", "nameLocation": "1616:21:0", "nodeType": "FunctionDefinition", "parameters": {"id": 203, "nodeType": "ParameterList", "parameters": [], "src": "1637:2:0"}, "returnParameters": {"id": 204, "nodeType": "ParameterList", "parameters": [], "src": "1649:0:0"}, "scope": 230, "src": "1607:188:0", "stateMutability": "nonpayable", "virtual": false, "visibility": "internal"}], "scope": 428, "src": "1100:698:0", "usedErrors": []}, {"abstract": false, "baseContracts": [], "canonicalName": "TestWithoutBugInternal", "contractDependencies": [], "contractKind": "contract", "fullyImplemented": true, "id": 318, "linearizedBaseContracts": [318], "name": "TestWithoutBugInternal", "nameLocation": "1809:22:0", "nodeType": "ContractDefinition", "nodes": [{"constant": false, "id": 234, "mutability": "mutable", "name": "balances", "nameLocation": "1863:8:0", "nodeType": "VariableDeclaration", "scope": 318, "src": "1838:33:0", "stateVariable": true, "storageLocation": "default", "typeDescriptions": {"typeIdentifier": "t_mapping$_t_address_$_t_uint256_$", "typeString": "mapping(address => uint256)"}, "typeName": {"id": 233, "keyType": {"id": 231, "name": "address", "nodeType": "ElementaryTypeName", "src": "1846:7:0", "typeDescriptions": {"typeIdentifier": "t_address", "typeString": "address"}}, "nodeType": "Mapping", "src": "1838:24:0", "typeDescriptions": {"typeIdentifier": "t_mapping$_t_address_$_t_uint256_$", "typeString": "mapping(address => uint256)"}, "valueType": {"id": 232, "name": "uint", "nodeType": "ElementaryTypeName", "src": "1857:4:0", "typeDescriptions": {"typeIdentifier": "t_uint256", "typeString": "uint256"}}}, "visibility": "internal"}, {"body": {"id": 237, "nodeType": "Block", "src": "1901:18:0", "statements": [{"id": 236, "nodeType": "PlaceholderStatement", "src": "1911:1:0"}]}, "id": 238, "name": "nonReentrant", "nameLocation": "1887:12:0", "nodeType": "ModifierDefinition", "parameters": {"id": 235, "nodeType": "ParameterList", "parameters": [], "src": "1899:2:0"}, "src": "1878:41:0", "virtual": false, "visibility": "internal"}, {"body": {"id": 249, "nodeType": "Block", "src": "1975:42:0", "statements": [{"expression": {"arguments": [{"id": 246, "name": "amount", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 240, "src": "2003:6:0", "typeDescriptions": {"typeIdentifier": "t_uint256", "typeString": "uint256"}}], "expression": {"argumentTypes": [{"typeIdentifier": "t_uint256", "typeString": "uint256"}], "id": 245, "name": "withdraw_internal", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 281, "src": "1985:17:0", "typeDescriptions": {"typeIdentifier": "t_function_internal_nonpayable$_t_uint256_$returns$__$", "typeString": "function (uint256)"}}, "id": 247, "isConstant": false, "isLValue": false, "isPure": false, "kind": "functionCall", "lValueRequested": false, "names": [], "nodeType": "FunctionCall", "src": "1985:25:0", "tryCall": false, "typeDescriptions": {"typeIdentifier": "t_tuple$__$", "typeString": "tuple()"}}, "id": 248, "nodeType": "ExpressionStatement", "src": "1985:25:0"}]}, "functionSelector": "2e1a7d4d", "id": 250, "implemented": true, "kind": "function", "modifiers": [{"id": 243, "kind": "modifierInvocation", "modifierName": {"id": 242, "name": "nonReentrant", "nodeType": "IdentifierPath", "referencedDeclaration": 238, "src": "1956:12:0"}, "nodeType": "ModifierInvocation", "src": "1956:12:0"}], "name": "withdraw", "nameLocation": "1934:8:0", "nodeType": "FunctionDefinition", "parameters": {"id": 241, "nodeType": "ParameterList", "parameters": [{"constant": false, "id": 240, "mutability": "mutable", "name": "amount", "nameLocation": "1948:6:0", "nodeType": "VariableDeclaration", "scope": 250, "src": "1943:11:0", "stateVariable": false, "storageLocation": "default", "typeDescriptions": {"typeIdentifier": "t_uint256", "typeString": "uint256"}, "typeName": {"id": 239, "name": "uint", "nodeType": "ElementaryTypeName", "src": "1943:4:0", "typeDescriptions": {"typeIdentifier": "t_uint256", "typeString": "uint256"}}, "visibility": "internal"}], "src": "1942:13:0"}, "returnParameters": {"id": 244, "nodeType": "ParameterList", "parameters": [], "src": "1975:0:0"}, "scope": 318, "src": "1925:92:0", "stateMutability": "nonpayable", "virtual": false, "visibility": "public"}, {"body": {"id": 280, "nodeType": "Block", "src": "2071:157:0", "statements": [{"expression": {"arguments": [{"commonType": {"typeIdentifier": "t_uint256", "typeString": "uint256"}, "id": 261, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "leftExpression": {"id": 256, "name": "amount", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 252, "src": "2090:6:0", "typeDescriptions": {"typeIdentifier": "t_uint256", "typeString": "uint256"}}, "nodeType": "BinaryOperation", "operator": "<=", "rightExpression": {"baseExpression": {"id": 257, "name": "balances", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 234, "src": "2100:8:0", "typeDescriptions": {"typeIdentifier": "t_mapping$_t_address_$_t_uint256_$", "typeString": "mapping(address => uint256)"}}, "id": 260, "indexExpression": {"expression": {"id": 258, "name": "msg", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": -15, "src": "2109:3:0", "typeDescriptions": {"typeIdentifier": "t_magic_message", "typeString": "msg"}}, "id": 259, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "memberName": "sender", "nodeType": "MemberAccess", "src": "2109:10:0", "typeDescriptions": {"typeIdentifier": "t_address", "typeString": "address"}}, "isConstant": false, "isLValue": true, "isPure": false, "lValueRequested": false, "nodeType": "IndexAccess", "src": "2100:20:0", "typeDescriptions": {"typeIdentifier": "t_uint256", "typeString": "uint256"}}, "src": "2090:30:0", "typeDescriptions": {"typeIdentifier": "t_bool", "typeString": "bool"}}], "expression": {"argumentTypes": [{"typeIdentifier": "t_bool", "typeString": "bool"}], "id": 255, "name": "require", "nodeType": "Identifier", "overloadedDeclarations": [-18, -18], "referencedDeclaration": -18, "src": "2082:7:0", "typeDescriptions": {"typeIdentifier": "t_function_require_pure$_t_bool_$returns$__$", "typeString": "function (bool) pure"}}, "id": 262, "isConstant": false, "isLValue": false, "isPure": false, "kind": "functionCall", "lValueRequested": false, "names": [], "nodeType": "FunctionCall", "src": "2082:39:0", "tryCall": false, "typeDescriptions": {"typeIdentifier": "t_tuple$__$", "typeString": "tuple()"}}, "id": 263, "nodeType": "ExpressionStatement", "src": "2082:39:0"}, {"expression": {"arguments": [], "expression": {"argumentTypes": [], "expression": {"argumentTypes": [], "expression": {"arguments": [{"expression": {"id": 265, "name": "msg", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": -15, "src": "2141:3:0", "typeDescriptions": {"typeIdentifier": "t_magic_message", "typeString": "msg"}}, "id": 266, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "memberName": "sender", "nodeType": "MemberAccess", "src": "2141:10:0", "typeDescriptions": {"typeIdentifier": "t_address", "typeString": "address"}}], "expression": {"argumentTypes": [{"typeIdentifier": "t_address", "typeString": "address"}], "id": 264, "name": "Receiver", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 4, "src": "2132:8:0", "typeDescriptions": {"typeIdentifier": "t_type$_t_contract$_Receiver_$4_$", "typeString": "type(contract Receiver)"}}, "id": 267, "isConstant": false, "isLValue": false, "isPure": false, "kind": "typeConversion", "lValueRequested": false, "names": [], "nodeType": "FunctionCall", "src": "2132:20:0", "tryCall": false, "typeDescriptions": {"typeIdentifier": "t_contract$_Receiver_$4", "typeString": "contract Receiver"}}, "id": 268, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "memberName": "send_funds", "nodeType": "MemberAccess", "referencedDeclaration": 3, "src": "2132:31:0", "typeDescriptions": {"typeIdentifier": "t_function_external_payable$__$returns$__$", "typeString": "function () payable external"}}, "id": 270, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "names": ["value"], "nodeType": "FunctionCallOptions", "options": [{"id": 269, "name": "amount", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 252, "src": "2171:6:0", "typeDescriptions": {"typeIdentifier": "t_uint256", "typeString": "uint256"}}], "src": "2132:46:0", "typeDescriptions": {"typeIdentifier": "t_function_external_payable$__$returns$__$value", "typeString": "function () payable external"}}, "id": 271, "isConstant": false, "isLValue": false, "isPure": false, "kind": "functionCall", "lValueRequested": false, "names": [], "nodeType": "FunctionCall", "src": "2132:48:0", "tryCall": false, "typeDescriptions": {"typeIdentifier": "t_tuple$__$", "typeString": "tuple()"}}, "id": 272, "nodeType": "ExpressionStatement", "src": "2132:48:0"}, {"expression": {"id": 278, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "leftHandSide": {"baseExpression": {"id": 273, "name": "balances", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 234, "src": "2191:8:0", "typeDescriptions": {"typeIdentifier": "t_mapping$_t_address_$_t_uint256_$", "typeString": "mapping(address => uint256)"}}, "id": 276, "indexExpression": {"expression": {"id": 274, "name": "msg", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": -15, "src": "2200:3:0", "typeDescriptions": {"typeIdentifier": "t_magic_message", "typeString": "msg"}}, "id": 275, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "memberName": "sender", "nodeType": "MemberAccess", "src": "2200:10:0", "typeDescriptions": {"typeIdentifier": "t_address", "typeString": "address"}}, "isConstant": false, "isLValue": true, "isPure": false, "lValueRequested": true, "nodeType": "IndexAccess", "src": "2191:20:0", "typeDescriptions": {"typeIdentifier": "t_uint256", "typeString": "uint256"}}, "nodeType": "Assignment", "operator": "-=", "rightHandSide": {"id": 277, "name": "amount", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 252, "src": "2215:6:0", "typeDescriptions": {"typeIdentifier": "t_uint256", "typeString": "uint256"}}, "src": "2191:30:0", "typeDescriptions": {"typeIdentifier": "t_uint256", "typeString": "uint256"}}, "id": 279, "nodeType": "ExpressionStatement", "src": "2191:30:0"}]}, "id": 281, "implemented": true, "kind": "function", "modifiers": [], "name": "withdraw_internal", "nameLocation": "2032:17:0", "nodeType": "FunctionDefinition", "parameters": {"id": 253, "nodeType": "ParameterList", "parameters": [{"constant": false, "id": 252, "mutability": "mutable", "name": "amount", "nameLocation": "2055:6:0", "nodeType": "VariableDeclaration", "scope": 281, "src": "2050:11:0", "stateVariable": false, "storageLocation": "default", "typeDescriptions": {"typeIdentifier": "t_uint256", "typeString": "uint256"}, "typeName": {"id": 251, "name": "uint", "nodeType": "ElementaryTypeName", "src": "2050:4:0", "typeDescriptions": {"typeIdentifier": "t_uint256", "typeString": "uint256"}}, "visibility": "internal"}], "src": "2049:13:0"}, "returnParameters": {"id": 254, "nodeType": "ParameterList", "parameters": [], "src": "2071:0:0"}, "scope": 318, "src": "2023:205:0", "stateMutability": "nonpayable", "virtual": false, "visibility": "internal"}, {"body": {"id": 289, "nodeType": "Block", "src": "2277:40:0", "statements": [{"expression": {"arguments": [], "expression": {"argumentTypes": [], "id": 286, "name": "withdraw_all_internal", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 317, "src": "2287:21:0", "typeDescriptions": {"typeIdentifier": "t_function_internal_nonpayable$__$returns$__$", "typeString": "function ()"}}, "id": 287, "isConstant": false, "isLValue": false, "isPure": false, "kind": "functionCall", "lValueRequested": false, "names": [], "nodeType": "FunctionCall", "src": "2287:23:0", "tryCall": false, "typeDescriptions": {"typeIdentifier": "t_tuple$__$", "typeString": "tuple()"}}, "id": 288, "nodeType": "ExpressionStatement", "src": "2287:23:0"}]}, "functionSelector": "dd473d2b", "id": 290, "implemented": true, "kind": "function", "modifiers": [{"id": 284, "kind": "modifierInvocation", "modifierName": {"id": 283, "name": "nonReentrant", "nodeType": "IdentifierPath", "referencedDeclaration": 238, "src": "2258:12:0"}, "nodeType": "ModifierInvocation", "src": "2258:12:0"}], "name": "withdraw_all", "nameLocation": "2243:12:0", "nodeType": "FunctionDefinition", "parameters": {"id": 282, "nodeType": "ParameterList", "parameters": [], "src": "2255:2:0"}, "returnParameters": {"id": 285, "nodeType": "ParameterList", "parameters": [], "src": "2277:0:0"}, "scope": 318, "src": "2234:83:0", "stateMutability": "nonpayable", "virtual": false, "visibility": "public"}, {"body": {"id": 316, "nodeType": "Block", "src": "2365:146:0", "statements": [{"assignments": [294], "declarations": [{"constant": false, "id": 294, "mutability": "mutable", "name": "amount", "nameLocation": "2381:6:0", "nodeType": "VariableDeclaration", "scope": 316, "src": "2376:11:0", "stateVariable": false, "storageLocation": "default", "typeDescriptions": {"typeIdentifier": "t_uint256", "typeString": "uint256"}, "typeName": {"id": 293, "name": "uint", "nodeType": "ElementaryTypeName", "src": "2376:4:0", "typeDescriptions": {"typeIdentifier": "t_uint256", "typeString": "uint256"}}, "visibility": "internal"}], "id": 299, "initialValue": {"baseExpression": {"id": 295, "name": "balances", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 234, "src": "2390:8:0", "typeDescriptions": {"typeIdentifier": "t_mapping$_t_address_$_t_uint256_$", "typeString": "mapping(address => uint256)"}}, "id": 298, "indexExpression": {"expression": {"id": 296, "name": "msg", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": -15, "src": "2399:3:0", "typeDescriptions": {"typeIdentifier": "t_magic_message", "typeString": "msg"}}, "id": 297, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "memberName": "sender", "nodeType": "MemberAccess", "src": "2399:10:0", "typeDescriptions": {"typeIdentifier": "t_address", "typeString": "address"}}, "isConstant": false, "isLValue": true, "isPure": false, "lValueRequested": false, "nodeType": "IndexAccess", "src": "2390:20:0", "typeDescriptions": {"typeIdentifier": "t_uint256", "typeString": "uint256"}}, "nodeType": "VariableDeclarationStatement", "src": "2376:34:0"}, {"expression": {"id": 305, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "leftHandSide": {"baseExpression": {"id": 300, "name": "balances", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 234, "src": "2421:8:0", "typeDescriptions": {"typeIdentifier": "t_mapping$_t_address_$_t_uint256_$", "typeString": "mapping(address => uint256)"}}, "id": 303, "indexExpression": {"expression": {"id": 301, "name": "msg", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": -15, "src": "2430:3:0", "typeDescriptions": {"typeIdentifier": "t_magic_message", "typeString": "msg"}}, "id": 302, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "memberName": "sender", "nodeType": "MemberAccess", "src": "2430:10:0", "typeDescriptions": {"typeIdentifier": "t_address", "typeString": "address"}}, "isConstant": false, "isLValue": true, "isPure": false, "lValueRequested": true, "nodeType": "IndexAccess", "src": "2421:20:0", "typeDescriptions": {"typeIdentifier": "t_uint256", "typeString": "uint256"}}, "nodeType": "Assignment", "operator": "=", "rightHandSide": {"hexValue": "30", "id": 304, "isConstant": false, "isLValue": false, "isPure": true, "kind": "number", "lValueRequested": false, "nodeType": "Literal", "src": "2444:1:0", "typeDescriptions": {"typeIdentifier": "t_rational_0_by_1", "typeString": "int_const 0"}, "value": "0"}, "src": "2421:24:0", "typeDescriptions": {"typeIdentifier": "t_uint256", "typeString": "uint256"}}, "id": 306, "nodeType": "ExpressionStatement", "src": "2421:24:0"}, {"expression": {"arguments": [], "expression": {"argumentTypes": [], "expression": {"argumentTypes": [], "expression": {"arguments": [{"expression": {"id": 308, "name": "msg", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": -15, "src": "2465:3:0", "typeDescriptions": {"typeIdentifier": "t_magic_message", "typeString": "msg"}}, "id": 309, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "memberName": "sender", "nodeType": "MemberAccess", "src": "2465:10:0", "typeDescriptions": {"typeIdentifier": "t_address", "typeString": "address"}}], "expression": {"argumentTypes": [{"typeIdentifier": "t_address", "typeString": "address"}], "id": 307, "name": "Receiver", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 4, "src": "2456:8:0", "typeDescriptions": {"typeIdentifier": "t_type$_t_contract$_Receiver_$4_$", "typeString": "type(contract Receiver)"}}, "id": 310, "isConstant": false, "isLValue": false, "isPure": false, "kind": "typeConversion", "lValueRequested": false, "names": [], "nodeType": "FunctionCall", "src": "2456:20:0", "tryCall": false, "typeDescriptions": {"typeIdentifier": "t_contract$_Receiver_$4", "typeString": "contract Receiver"}}, "id": 311, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "memberName": "send_funds", "nodeType": "MemberAccess", "referencedDeclaration": 3, "src": "2456:31:0", "typeDescriptions": {"typeIdentifier": "t_function_external_payable$__$returns$__$", "typeString": "function () payable external"}}, "id": 313, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "names": ["value"], "nodeType": "FunctionCallOptions", "options": [{"id": 312, "name": "amount", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 294, "src": "2495:6:0", "typeDescriptions": {"typeIdentifier": "t_uint256", "typeString": "uint256"}}], "src": "2456:46:0", "typeDescriptions": {"typeIdentifier": "t_function_external_payable$__$returns$__$value", "typeString": "function () payable external"}}, "id": 314, "isConstant": false, "isLValue": false, "isPure": false, "kind": "functionCall", "lValueRequested": false, "names": [], "nodeType": "FunctionCall", "src": "2456:48:0", "tryCall": false, "typeDescriptions": {"typeIdentifier": "t_tuple$__$", "typeString": "tuple()"}}, "id": 315, "nodeType": "ExpressionStatement", "src": "2456:48:0"}]}, "id": 317, "implemented": true, "kind": "function", "modifiers": [], "name": "withdraw_all_internal", "nameLocation": "2332:21:0", "nodeType": "FunctionDefinition", "parameters": {"id": 291, "nodeType": "ParameterList", "parameters": [], "src": "2353:2:0"}, "returnParameters": {"id": 292, "nodeType": "ParameterList", "parameters": [], "src": "2365:0:0"}, "scope": 318, "src": "2323:188:0", "stateMutability": "nonpayable", "virtual": false, "visibility": "internal"}], "scope": 428, "src": "1800:714:0", "usedErrors": []}, {"abstract": false, "baseContracts": [], "canonicalName": "TestBugWithPublicVariable", "contractDependencies": [], "contractKind": "contract", "fullyImplemented": true, "id": 370, "linearizedBaseContracts": [370], "name": "TestBugWithPublicVariable", "nameLocation": "2525:25:0", "nodeType": "ContractDefinition", "nodes": [{"constant": false, "functionSelector": "27e235e3", "id": 322, "mutability": "mutable", "name": "balances", "nameLocation": "2589:8:0", "nodeType": "VariableDeclaration", "scope": 370, "src": "2557:40:0", "stateVariable": true, "storageLocation": "default", "typeDescriptions": {"typeIdentifier": "t_mapping$_t_address_$_t_uint256_$", "typeString": "mapping(address => uint256)"}, "typeName": {"id": 321, "keyType": {"id": 319, "name": "address", "nodeType": "ElementaryTypeName", "src": "2565:7:0", "typeDescriptions": {"typeIdentifier": "t_address", "typeString": "address"}}, "nodeType": "Mapping", "src": "2557:24:0", "typeDescriptions": {"typeIdentifier": "t_mapping$_t_address_$_t_uint256_$", "typeString": "mapping(address => uint256)"}, "valueType": {"id": 320, "name": "uint", "nodeType": "ElementaryTypeName", "src": "2576:4:0", "typeDescriptions": {"typeIdentifier": "t_uint256", "typeString": "uint256"}}}, "visibility": "public"}, {"body": {"id": 325, "nodeType": "Block", "src": "2627:18:0", "statements": [{"id": 324, "nodeType": "PlaceholderStatement", "src": "2637:1:0"}]}, "id": 326, "name": "nonReentrant", "nameLocation": "2613:12:0", "nodeType": "ModifierDefinition", "parameters": {"id": 323, "nodeType": "ParameterList", "parameters": [], "src": "2625:2:0"}, "src": "2604:41:0", "virtual": false, "visibility": "internal"}, {"body": {"id": 337, "nodeType": "Block", "src": "2701:42:0", "statements": [{"expression": {"arguments": [{"id": 334, "name": "amount", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 328, "src": "2729:6:0", "typeDescriptions": {"typeIdentifier": "t_uint256", "typeString": "uint256"}}], "expression": {"argumentTypes": [{"typeIdentifier": "t_uint256", "typeString": "uint256"}], "id": 333, "name": "withdraw_internal", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 369, "src": "2711:17:0", "typeDescriptions": {"typeIdentifier": "t_function_internal_nonpayable$_t_uint256_$returns$__$", "typeString": "function (uint256)"}}, "id": 335, "isConstant": false, "isLValue": false, "isPure": false, "kind": "functionCall", "lValueRequested": false, "names": [], "nodeType": "FunctionCall", "src": "2711:25:0", "tryCall": false, "typeDescriptions": {"typeIdentifier": "t_tuple$__$", "typeString": "tuple()"}}, "id": 336, "nodeType": "ExpressionStatement", "src": "2711:25:0"}]}, "functionSelector": "2e1a7d4d", "id": 338, "implemented": true, "kind": "function", "modifiers": [{"id": 331, "kind": "modifierInvocation", "modifierName": {"id": 330, "name": "nonReentrant", "nodeType": "IdentifierPath", "referencedDeclaration": 326, "src": "2682:12:0"}, "nodeType": "ModifierInvocation", "src": "2682:12:0"}], "name": "withdraw", "nameLocation": "2660:8:0", "nodeType": "FunctionDefinition", "parameters": {"id": 329, "nodeType": "ParameterList", "parameters": [{"constant": false, "id": 328, "mutability": "mutable", "name": "amount", "nameLocation": "2674:6:0", "nodeType": "VariableDeclaration", "scope": 338, "src": "2669:11:0", "stateVariable": false, "storageLocation": "default", "typeDescriptions": {"typeIdentifier": "t_uint256", "typeString": "uint256"}, "typeName": {"id": 327, "name": "uint", "nodeType": "ElementaryTypeName", "src": "2669:4:0", "typeDescriptions": {"typeIdentifier": "t_uint256", "typeString": "uint256"}}, "visibility": "internal"}], "src": "2668:13:0"}, "returnParameters": {"id": 332, "nodeType": "ParameterList", "parameters": [], "src": "2701:0:0"}, "scope": 370, "src": "2651:92:0", "stateMutability": "nonpayable", "virtual": false, "visibility": "public"}, {"body": {"id": 368, "nodeType": "Block", "src": "2797:157:0", "statements": [{"expression": {"arguments": [{"commonType": {"typeIdentifier": "t_uint256", "typeString": "uint256"}, "id": 349, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "leftExpression": {"id": 344, "name": "amount", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 340, "src": "2816:6:0", "typeDescriptions": {"typeIdentifier": "t_uint256", "typeString": "uint256"}}, "nodeType": "BinaryOperation", "operator": "<=", "rightExpression": {"baseExpression": {"id": 345, "name": "balances", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 322, "src": "2826:8:0", "typeDescriptions": {"typeIdentifier": "t_mapping$_t_address_$_t_uint256_$", "typeString": "mapping(address => uint256)"}}, "id": 348, "indexExpression": {"expression": {"id": 346, "name": "msg", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": -15, "src": "2835:3:0", "typeDescriptions": {"typeIdentifier": "t_magic_message", "typeString": "msg"}}, "id": 347, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "memberName": "sender", "nodeType": "MemberAccess", "src": "2835:10:0", "typeDescriptions": {"typeIdentifier": "t_address", "typeString": "address"}}, "isConstant": false, "isLValue": true, "isPure": false, "lValueRequested": false, "nodeType": "IndexAccess", "src": "2826:20:0", "typeDescriptions": {"typeIdentifier": "t_uint256", "typeString": "uint256"}}, "src": "2816:30:0", "typeDescriptions": {"typeIdentifier": "t_bool", "typeString": "bool"}}], "expression": {"argumentTypes": [{"typeIdentifier": "t_bool", "typeString": "bool"}], "id": 343, "name": "require", "nodeType": "Identifier", "overloadedDeclarations": [-18, -18], "referencedDeclaration": -18, "src": "2808:7:0", "typeDescriptions": {"typeIdentifier": "t_function_require_pure$_t_bool_$returns$__$", "typeString": "function (bool) pure"}}, "id": 350, "isConstant": false, "isLValue": false, "isPure": false, "kind": "functionCall", "lValueRequested": false, "names": [], "nodeType": "FunctionCall", "src": "2808:39:0", "tryCall": false, "typeDescriptions": {"typeIdentifier": "t_tuple$__$", "typeString": "tuple()"}}, "id": 351, "nodeType": "ExpressionStatement", "src": "2808:39:0"}, {"expression": {"arguments": [], "expression": {"argumentTypes": [], "expression": {"argumentTypes": [], "expression": {"arguments": [{"expression": {"id": 353, "name": "msg", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": -15, "src": "2867:3:0", "typeDescriptions": {"typeIdentifier": "t_magic_message", "typeString": "msg"}}, "id": 354, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "memberName": "sender", "nodeType": "MemberAccess", "src": "2867:10:0", "typeDescriptions": {"typeIdentifier": "t_address", "typeString": "address"}}], "expression": {"argumentTypes": [{"typeIdentifier": "t_address", "typeString": "address"}], "id": 352, "name": "Receiver", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 4, "src": "2858:8:0", "typeDescriptions": {"typeIdentifier": "t_type$_t_contract$_Receiver_$4_$", "typeString": "type(contract Receiver)"}}, "id": 355, "isConstant": false, "isLValue": false, "isPure": false, "kind": "typeConversion", "lValueRequested": false, "names": [], "nodeType": "FunctionCall", "src": "2858:20:0", "tryCall": false, "typeDescriptions": {"typeIdentifier": "t_contract$_Receiver_$4", "typeString": "contract Receiver"}}, "id": 356, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "memberName": "send_funds", "nodeType": "MemberAccess", "referencedDeclaration": 3, "src": "2858:31:0", "typeDescriptions": {"typeIdentifier": "t_function_external_payable$__$returns$__$", "typeString": "function () payable external"}}, "id": 358, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "names": ["value"], "nodeType": "FunctionCallOptions", "options": [{"id": 357, "name": "amount", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 340, "src": "2897:6:0", "typeDescriptions": {"typeIdentifier": "t_uint256", "typeString": "uint256"}}], "src": "2858:46:0", "typeDescriptions": {"typeIdentifier": "t_function_external_payable$__$returns$__$value", "typeString": "function () payable external"}}, "id": 359, "isConstant": false, "isLValue": false, "isPure": false, "kind": "functionCall", "lValueRequested": false, "names": [], "nodeType": "FunctionCall", "src": "2858:48:0", "tryCall": false, "typeDescriptions": {"typeIdentifier": "t_tuple$__$", "typeString": "tuple()"}}, "id": 360, "nodeType": "ExpressionStatement", "src": "2858:48:0"}, {"expression": {"id": 366, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "leftHandSide": {"baseExpression": {"id": 361, "name": "balances", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 322, "src": "2917:8:0", "typeDescriptions": {"typeIdentifier": "t_mapping$_t_address_$_t_uint256_$", "typeString": "mapping(address => uint256)"}}, "id": 364, "indexExpression": {"expression": {"id": 362, "name": "msg", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": -15, "src": "2926:3:0", "typeDescriptions": {"typeIdentifier": "t_magic_message", "typeString": "msg"}}, "id": 363, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "memberName": "sender", "nodeType": "MemberAccess", "src": "2926:10:0", "typeDescriptions": {"typeIdentifier": "t_address", "typeString": "address"}}, "isConstant": false, "isLValue": true, "isPure": false, "lValueRequested": true, "nodeType": "IndexAccess", "src": "2917:20:0", "typeDescriptions": {"typeIdentifier": "t_uint256", "typeString": "uint256"}}, "nodeType": "Assignment", "operator": "-=", "rightHandSide": {"id": 365, "name": "amount", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 340, "src": "2941:6:0", "typeDescriptions": {"typeIdentifier": "t_uint256", "typeString": "uint256"}}, "src": "2917:30:0", "typeDescriptions": {"typeIdentifier": "t_uint256", "typeString": "uint256"}}, "id": 367, "nodeType": "ExpressionStatement", "src": "2917:30:0"}]}, "id": 369, "implemented": true, "kind": "function", "modifiers": [], "name": "withdraw_internal", "nameLocation": "2758:17:0", "nodeType": "FunctionDefinition", "parameters": {"id": 341, "nodeType": "ParameterList", "parameters": [{"constant": false, "id": 340, "mutability": "mutable", "name": "amount", "nameLocation": "2781:6:0", "nodeType": "VariableDeclaration", "scope": 369, "src": "2776:11:0", "stateVariable": false, "storageLocation": "default", "typeDescriptions": {"typeIdentifier": "t_uint256", "typeString": "uint256"}, "typeName": {"id": 339, "name": "uint", "nodeType": "ElementaryTypeName", "src": "2776:4:0", "typeDescriptions": {"typeIdentifier": "t_uint256", "typeString": "uint256"}}, "visibility": "internal"}], "src": "2775:13:0"}, "returnParameters": {"id": 342, "nodeType": "ParameterList", "parameters": [], "src": "2797:0:0"}, "scope": 370, "src": "2749:205:0", "stateMutability": "nonpayable", "virtual": false, "visibility": "internal"}], "scope": 428, "src": "2516:441:0", "usedErrors": []}, {"abstract": false, "baseContracts": [], "canonicalName": "TestWithBugNonReentrantRead", "contractDependencies": [], "contractKind": "contract", "fullyImplemented": true, "id": 427, "linearizedBaseContracts": [427], "name": "TestWithBugNonReentrantRead", "nameLocation": "2968:27:0", "nodeType": "ContractDefinition", "nodes": [{"constant": false, "id": 374, "mutability": "mutable", "name": "balances", "nameLocation": "3027:8:0", "nodeType": "VariableDeclaration", "scope": 427, "src": "3002:33:0", "stateVariable": true, "storageLocation": "default", "typeDescriptions": {"typeIdentifier": "t_mapping$_t_address_$_t_uint256_$", "typeString": "mapping(address => uint256)"}, "typeName": {"id": 373, "keyType": {"id": 371, "name": "address", "nodeType": "ElementaryTypeName", "src": "3010:7:0", "typeDescriptions": {"typeIdentifier": "t_address", "typeString": "address"}}, "nodeType": "Mapping", "src": "3002:24:0", "typeDescriptions": {"typeIdentifier": "t_mapping$_t_address_$_t_uint256_$", "typeString": "mapping(address => uint256)"}, "valueType": {"id": 372, "name": "uint", "nodeType": "ElementaryTypeName", "src": "3021:4:0", "typeDescriptions": {"typeIdentifier": "t_uint256", "typeString": "uint256"}}}, "visibility": "internal"}, {"body": {"id": 377, "nodeType": "Block", "src": "3065:18:0", "statements": [{"id": 376, "nodeType": "PlaceholderStatement", "src": "3075:1:0"}]}, "id": 378, "name": "nonReentrant", "nameLocation": "3051:12:0", "nodeType": "ModifierDefinition", "parameters": {"id": 375, "nodeType": "ParameterList", "parameters": [], "src": "3063:2:0"}, "src": "3042:41:0", "virtual": false, "visibility": "internal"}, {"body": {"id": 410, "nodeType": "Block", "src": "3139:157:0", "statements": [{"expression": {"arguments": [{"commonType": {"typeIdentifier": "t_uint256", "typeString": "uint256"}, "id": 391, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "leftExpression": {"id": 386, "name": "amount", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 380, "src": "3158:6:0", "typeDescriptions": {"typeIdentifier": "t_uint256", "typeString": "uint256"}}, "nodeType": "BinaryOperation", "operator": "<=", "rightExpression": {"baseExpression": {"id": 387, "name": "balances", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 374, "src": "3168:8:0", "typeDescriptions": {"typeIdentifier": "t_mapping$_t_address_$_t_uint256_$", "typeString": "mapping(address => uint256)"}}, "id": 390, "indexExpression": {"expression": {"id": 388, "name": "msg", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": -15, "src": "3177:3:0", "typeDescriptions": {"typeIdentifier": "t_magic_message", "typeString": "msg"}}, "id": 389, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "memberName": "sender", "nodeType": "MemberAccess", "src": "3177:10:0", "typeDescriptions": {"typeIdentifier": "t_address", "typeString": "address"}}, "isConstant": false, "isLValue": true, "isPure": false, "lValueRequested": false, "nodeType": "IndexAccess", "src": "3168:20:0", "typeDescriptions": {"typeIdentifier": "t_uint256", "typeString": "uint256"}}, "src": "3158:30:0", "typeDescriptions": {"typeIdentifier": "t_bool", "typeString": "bool"}}], "expression": {"argumentTypes": [{"typeIdentifier": "t_bool", "typeString": "bool"}], "id": 385, "name": "require", "nodeType": "Identifier", "overloadedDeclarations": [-18, -18], "referencedDeclaration": -18, "src": "3150:7:0", "typeDescriptions": {"typeIdentifier": "t_function_require_pure$_t_bool_$returns$__$", "typeString": "function (bool) pure"}}, "id": 392, "isConstant": false, "isLValue": false, "isPure": false, "kind": "functionCall", "lValueRequested": false, "names": [], "nodeType": "FunctionCall", "src": "3150:39:0", "tryCall": false, "typeDescriptions": {"typeIdentifier": "t_tuple$__$", "typeString": "tuple()"}}, "id": 393, "nodeType": "ExpressionStatement", "src": "3150:39:0"}, {"expression": {"arguments": [], "expression": {"argumentTypes": [], "expression": {"argumentTypes": [], "expression": {"arguments": [{"expression": {"id": 395, "name": "msg", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": -15, "src": "3209:3:0", "typeDescriptions": {"typeIdentifier": "t_magic_message", "typeString": "msg"}}, "id": 396, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "memberName": "sender", "nodeType": "MemberAccess", "src": "3209:10:0", "typeDescriptions": {"typeIdentifier": "t_address", "typeString": "address"}}], "expression": {"argumentTypes": [{"typeIdentifier": "t_address", "typeString": "address"}], "id": 394, "name": "Receiver", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 4, "src": "3200:8:0", "typeDescriptions": {"typeIdentifier": "t_type$_t_contract$_Receiver_$4_$", "typeString": "type(contract Receiver)"}}, "id": 397, "isConstant": false, "isLValue": false, "isPure": false, "kind": "typeConversion", "lValueRequested": false, "names": [], "nodeType": "FunctionCall", "src": "3200:20:0", "tryCall": false, "typeDescriptions": {"typeIdentifier": "t_contract$_Receiver_$4", "typeString": "contract Receiver"}}, "id": 398, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "memberName": "send_funds", "nodeType": "MemberAccess", "referencedDeclaration": 3, "src": "3200:31:0", "typeDescriptions": {"typeIdentifier": "t_function_external_payable$__$returns$__$", "typeString": "function () payable external"}}, "id": 400, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "names": ["value"], "nodeType": "FunctionCallOptions", "options": [{"id": 399, "name": "amount", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 380, "src": "3239:6:0", "typeDescriptions": {"typeIdentifier": "t_uint256", "typeString": "uint256"}}], "src": "3200:46:0", "typeDescriptions": {"typeIdentifier": "t_function_external_payable$__$returns$__$value", "typeString": "function () payable external"}}, "id": 401, "isConstant": false, "isLValue": false, "isPure": false, "kind": "functionCall", "lValueRequested": false, "names": [], "nodeType": "FunctionCall", "src": "3200:48:0", "tryCall": false, "typeDescriptions": {"typeIdentifier": "t_tuple$__$", "typeString": "tuple()"}}, "id": 402, "nodeType": "ExpressionStatement", "src": "3200:48:0"}, {"expression": {"id": 408, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "leftHandSide": {"baseExpression": {"id": 403, "name": "balances", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 374, "src": "3259:8:0", "typeDescriptions": {"typeIdentifier": "t_mapping$_t_address_$_t_uint256_$", "typeString": "mapping(address => uint256)"}}, "id": 406, "indexExpression": {"expression": {"id": 404, "name": "msg", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": -15, "src": "3268:3:0", "typeDescriptions": {"typeIdentifier": "t_magic_message", "typeString": "msg"}}, "id": 405, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "memberName": "sender", "nodeType": "MemberAccess", "src": "3268:10:0", "typeDescriptions": {"typeIdentifier": "t_address", "typeString": "address"}}, "isConstant": false, "isLValue": true, "isPure": false, "lValueRequested": true, "nodeType": "IndexAccess", "src": "3259:20:0", "typeDescriptions": {"typeIdentifier": "t_uint256", "typeString": "uint256"}}, "nodeType": "Assignment", "operator": "-=", "rightHandSide": {"id": 407, "name": "amount", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 380, "src": "3283:6:0", "typeDescriptions": {"typeIdentifier": "t_uint256", "typeString": "uint256"}}, "src": "3259:30:0", "typeDescriptions": {"typeIdentifier": "t_uint256", "typeString": "uint256"}}, "id": 409, "nodeType": "ExpressionStatement", "src": "3259:30:0"}]}, "functionSelector": "2e1a7d4d", "id": 411, "implemented": true, "kind": "function", "modifiers": [{"id": 383, "kind": "modifierInvocation", "modifierName": {"id": 382, "name": "nonReentrant", "nodeType": "IdentifierPath", "referencedDeclaration": 378, "src": "3120:12:0"}, "nodeType": "ModifierInvocation", "src": "3120:12:0"}], "name": "withdraw", "nameLocation": "3098:8:0", "nodeType": "FunctionDefinition", "parameters": {"id": 381, "nodeType": "ParameterList", "parameters": [{"constant": false, "id": 380, "mutability": "mutable", "name": "amount", "nameLocation": "3112:6:0", "nodeType": "VariableDeclaration", "scope": 411, "src": "3107:11:0", "stateVariable": false, "storageLocation": "default", "typeDescriptions": {"typeIdentifier": "t_uint256", "typeString": "uint256"}, "typeName": {"id": 379, "name": "uint", "nodeType": "ElementaryTypeName", "src": "3107:4:0", "typeDescriptions": {"typeIdentifier": "t_uint256", "typeString": "uint256"}}, "visibility": "internal"}], "src": "3106:13:0"}, "returnParameters": {"id": 384, "nodeType": "ParameterList", "parameters": [], "src": "3139:0:0"}, "scope": 427, "src": "3089:207:0", "stateMutability": "nonpayable", "virtual": false, "visibility": "public"}, {"body": {"id": 425, "nodeType": "Block", "src": "3509:76:0", "statements": [{"assignments": [417], "declarations": [{"constant": false, "id": 417, "mutability": "mutable", "name": "amount", "nameLocation": "3525:6:0", "nodeType": "VariableDeclaration", "scope": 425, "src": "3520:11:0", "stateVariable": false, "storageLocation": "default", "typeDescriptions": {"typeIdentifier": "t_uint256", "typeString": "uint256"}, "typeName": {"id": 416, "name": "uint", "nodeType": "ElementaryTypeName", "src": "3520:4:0", "typeDescriptions": {"typeIdentifier": "t_uint256", "typeString": "uint256"}}, "visibility": "internal"}], "id": 422, "initialValue": {"baseExpression": {"id": 418, "name": "balances", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 374, "src": "3534:8:0", "typeDescriptions": {"typeIdentifier": "t_mapping$_t_address_$_t_uint256_$", "typeString": "mapping(address => uint256)"}}, "id": 421, "indexExpression": {"expression": {"id": 419, "name": "msg", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": -15, "src": "3543:3:0", "typeDescriptions": {"typeIdentifier": "t_magic_message", "typeString": "msg"}}, "id": 420, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "memberName": "sender", "nodeType": "MemberAccess", "src": "3543:10:0", "typeDescriptions": {"typeIdentifier": "t_address", "typeString": "address"}}, "isConstant": false, "isLValue": true, "isPure": false, "lValueRequested": false, "nodeType": "IndexAccess", "src": "3534:20:0", "typeDescriptions": {"typeIdentifier": "t_uint256", "typeString": "uint256"}}, "nodeType": "VariableDeclarationStatement", "src": "3520:34:0"}, {"expression": {"id": 423, "name": "amount", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 417, "src": "3572:6:0", "typeDescriptions": {"typeIdentifier": "t_uint256", "typeString": "uint256"}}, "functionReturnParameters": 415, "id": 424, "nodeType": "Return", "src": "3565:13:0"}]}, "functionSelector": "57de26a4", "id": 426, "implemented": true, "kind": "function", "modifiers": [], "name": "read", "nameLocation": "3482:4:0", "nodeType": "FunctionDefinition", "parameters": {"id": 412, "nodeType": "ParameterList", "parameters": [], "src": "3486:2:0"}, "returnParameters": {"id": 415, "nodeType": "ParameterList", "parameters": [{"constant": false, "id": 414, "mutability": "mutable", "name": "", "nameLocation": "-1:-1:-1", "nodeType": "VariableDeclaration", "scope": 426, "src": "3504:4:0", "stateVariable": false, "storageLocation": "default", "typeDescriptions": {"typeIdentifier": "t_uint256", "typeString": "uint256"}, "typeName": {"id": 413, "name": "uint", "nodeType": "ElementaryTypeName", "src": "3504:4:0", "typeDescriptions": {"typeIdentifier": "t_uint256", "typeString": "uint256"}}, "visibility": "internal"}], "src": "3503:6:0"}, "scope": 427, "src": "3473:112:0", "stateMutability": "nonpayable", "virtual": false, "visibility": "public"}], "scope": 428, "src": "2959:629:0", "usedErrors": []}], "src": "0:3589:0"}, "contracts": {"TestWithoutBugInternal": {"abi": [{"inputs": [{"internalType": "uint256", "name": "amount", "type": "uint256"}], "name": "withdraw", "outputs": [], "stateMutability": "nonpayable", "type": "function"}, {"inputs": [], "name": "withdraw_all", "outputs": [], "stateMutability": "nonpayable", "type": "function"}], "bin": "608060405234801561001057600080fd5b50610367806100206000396000f3fe608060405234801561001057600080fd5b50600436106100365760003560e01c80632e1a7d4d1461003b578063dd473d2b14610057575b600080fd5b610055600480360381019061005091906102a1565b610061565b005b61005f61006d565b005b61006a81610077565b50565b61007561017b565b565b6000803373ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff168152602001908152602001600020548111156100c257600080fd5b3373ffffffffffffffffffffffffffffffffffffffff16631ad6506b826040518263ffffffff1660e01b81526004016000604051808303818588803b15801561010a57600080fd5b505af115801561011e573d6000803e3d6000fd5b5050505050806000803373ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff168152602001908152602001600020600082825461017191906102fd565b9250508190555050565b60008060003373ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff16815260200190815260200160002054905060008060003373ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff168152602001908152602001600020819055503373ffffffffffffffffffffffffffffffffffffffff16631ad6506b826040518263ffffffff1660e01b81526004016000604051808303818588803b15801561024a57600080fd5b505af115801561025e573d6000803e3d6000fd5b505050505050565b600080fd5b6000819050919050565b61027e8161026b565b811461028957600080fd5b50565b60008135905061029b81610275565b92915050565b6000602082840312156102b7576102b6610266565b5b60006102c58482850161028c565b91505092915050565b7f4e487b7100000000000000000000000000000000000000000000000000000000600052601160045260246000fd5b60006103088261026b565b91506103138361026b565b925082821015610326576103256102ce565b5b82820390509291505056fea26469706673582212200cb674a991aa13d3d9f793eb018ed153ae828c4e181f6d708517b2a765398f8e64736f6c634300080a0033", "bin-runtime": "608060405234801561001057600080fd5b50600436106100365760003560e01c80632e1a7d4d1461003b578063dd473d2b14610057575b600080fd5b610055600480360381019061005091906102a1565b610061565b005b61005f61006d565b005b61006a81610077565b50565b61007561017b565b565b6000803373ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff168152602001908152602001600020548111156100c257600080fd5b3373ffffffffffffffffffffffffffffffffffffffff16631ad6506b826040518263ffffffff1660e01b81526004016000604051808303818588803b15801561010a57600080fd5b505af115801561011e573d6000803e3d6000fd5b5050505050806000803373ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff168152602001908152602001600020600082825461017191906102fd565b9250508190555050565b60008060003373ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff16815260200190815260200160002054905060008060003373ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff168152602001908152602001600020819055503373ffffffffffffffffffffffffffffffffffffffff16631ad6506b826040518263ffffffff1660e01b81526004016000604051808303818588803b15801561024a57600080fd5b505af115801561025e573d6000803e3d6000fd5b505050505050565b600080fd5b6000819050919050565b61027e8161026b565b811461028957600080fd5b50565b60008135905061029b81610275565b92915050565b6000602082840312156102b7576102b6610266565b5b60006102c58482850161028c565b91505092915050565b7f4e487b7100000000000000000000000000000000000000000000000000000000600052601160045260246000fd5b60006103088261026b565b91506103138361026b565b925082821015610326576103256102ce565b5b82820390509291505056fea26469706673582212200cb674a991aa13d3d9f793eb018ed153ae828c4e181f6d708517b2a765398f8e64736f6c634300080a0033", "srcmap": "1800:714:0:-:0;;;;;;;;;;;;;;;;;;;", "srcmap-runtime": "1800:714:0:-:0;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;1925:92;;;;;;;;;;;;;:::i;:::-;;:::i;:::-;;2234:83;;;:::i;:::-;;1925:92;1985:25:::1;2003:6;1985:17;:25::i;:::-;1925:92:::0;:::o;2234:83::-;2287:23:::1;:21;:23::i;:::-;2234:83::o:0;2023:205::-;2100:8;:20;2109:10;2100:20;;;;;;;;;;;;;;;;2090:6;:30;;2082:39;;;;;;2141:10;2132:31;;;2171:6;2132:48;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;2215:6;2191:8;:20;2200:10;2191:20;;;;;;;;;;;;;;;;:30;;;;;;;:::i;:::-;;;;;;;;2023:205;:::o;2323:188::-;2376:11;2390:8;:20;2399:10;2390:20;;;;;;;;;;;;;;;;2376:34;;2444:1;2421:8;:20;2430:10;2421:20;;;;;;;;;;;;;;;:24;;;;2465:10;2456:31;;;2495:6;2456:48;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;2365:146;2323:188::o;88:117:1:-;197:1;194;187:12;334:77;371:7;400:5;389:16;;334:77;;;:::o;417:122::-;490:24;508:5;490:24;:::i;:::-;483:5;480:35;470:63;;529:1;526;519:12;470:63;417:122;:::o;545:139::-;591:5;629:6;616:20;607:29;;645:33;672:5;645:33;:::i;:::-;545:139;;;;:::o;690:329::-;749:6;798:2;786:9;777:7;773:23;769:32;766:119;;;804:79;;:::i;:::-;766:119;924:1;949:53;994:7;985:6;974:9;970:22;949:53;:::i;:::-;939:63;;895:117;690:329;;;;:::o;1025:180::-;1073:77;1070:1;1063:88;1170:4;1167:1;1160:15;1194:4;1191:1;1184:15;1211:191;1251:4;1271:20;1289:1;1271:20;:::i;:::-;1266:25;;1305:20;1323:1;1305:20;:::i;:::-;1300:25;;1344:1;1341;1338:8;1335:34;;;1349:18;;:::i;:::-;1335:34;1394:1;1391;1387:9;1379:17;;1211:191;;;;:::o", "filenames": {"absolute": "/Users/alpharush/tob/slither/tests/e2e/detectors/test_data/reentrancy-eth/0.8.10/reentrancy_with_non_reentrant.sol", "used": "tests/e2e/detectors/test_data/reentrancy-eth/0.8.10/reentrancy_with_non_reentrant.sol", "short": "tests/e2e/detectors/test_data/reentrancy-eth/0.8.10/reentrancy_with_non_reentrant.sol", "relative": "tests/e2e/detectors/test_data/reentrancy-eth/0.8.10/reentrancy_with_non_reentrant.sol"}, "libraries": {}, "is_dependency": false, "userdoc": {"methods": {}, "notice": null}, "devdoc": {"methods": {}, "author": null, "details": null, "title": null}}, "TestBugWithPublicVariable": {"abi": [{"inputs": [{"internalType": "address", "name": "", "type": "address"}], "name": "balances", "outputs": [{"internalType": "uint256", "name": "", "type": "uint256"}], "stateMutability": "view", "type": "function"}, {"inputs": [{"internalType": "uint256", "name": "amount", "type": "uint256"}], "name": "withdraw", "outputs": [], "stateMutability": "nonpayable", "type": "function"}], "bin": "608060405234801561001057600080fd5b50610365806100206000396000f3fe608060405234801561001057600080fd5b50600436106100365760003560e01c806327e235e31461003b5780632e1a7d4d1461006b575b600080fd5b61005560048036038101906100509190610212565b610087565b6040516100629190610258565b60405180910390f35b6100856004803603810190610080919061029f565b61009f565b005b60006020528060005260406000206000915090505481565b6100a8816100ab565b50565b6000803373ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff168152602001908152602001600020548111156100f657600080fd5b3373ffffffffffffffffffffffffffffffffffffffff16631ad6506b826040518263ffffffff1660e01b81526004016000604051808303818588803b15801561013e57600080fd5b505af1158015610152573d6000803e3d6000fd5b5050505050806000803373ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff16815260200190815260200160002060008282546101a591906102fb565b9250508190555050565b600080fd5b600073ffffffffffffffffffffffffffffffffffffffff82169050919050565b60006101df826101b4565b9050919050565b6101ef816101d4565b81146101fa57600080fd5b50565b60008135905061020c816101e6565b92915050565b600060208284031215610228576102276101af565b5b6000610236848285016101fd565b91505092915050565b6000819050919050565b6102528161023f565b82525050565b600060208201905061026d6000830184610249565b92915050565b61027c8161023f565b811461028757600080fd5b50565b60008135905061029981610273565b92915050565b6000602082840312156102b5576102b46101af565b5b60006102c38482850161028a565b91505092915050565b7f4e487b7100000000000000000000000000000000000000000000000000000000600052601160045260246000fd5b60006103068261023f565b91506103118361023f565b925082821015610324576103236102cc565b5b82820390509291505056fea2646970667358221220f9e6a62314df73f622b0216c4436cbf5e0355bd422b2e8ee8d0f6b0f4f921d4764736f6c634300080a0033", "bin-runtime": "608060405234801561001057600080fd5b50600436106100365760003560e01c806327e235e31461003b5780632e1a7d4d1461006b575b600080fd5b61005560048036038101906100509190610212565b610087565b6040516100629190610258565b60405180910390f35b6100856004803603810190610080919061029f565b61009f565b005b60006020528060005260406000206000915090505481565b6100a8816100ab565b50565b6000803373ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff168152602001908152602001600020548111156100f657600080fd5b3373ffffffffffffffffffffffffffffffffffffffff16631ad6506b826040518263ffffffff1660e01b81526004016000604051808303818588803b15801561013e57600080fd5b505af1158015610152573d6000803e3d6000fd5b5050505050806000803373ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff16815260200190815260200160002060008282546101a591906102fb565b9250508190555050565b600080fd5b600073ffffffffffffffffffffffffffffffffffffffff82169050919050565b60006101df826101b4565b9050919050565b6101ef816101d4565b81146101fa57600080fd5b50565b60008135905061020c816101e6565b92915050565b600060208284031215610228576102276101af565b5b6000610236848285016101fd565b91505092915050565b6000819050919050565b6102528161023f565b82525050565b600060208201905061026d6000830184610249565b92915050565b61027c8161023f565b811461028757600080fd5b50565b60008135905061029981610273565b92915050565b6000602082840312156102b5576102b46101af565b5b60006102c38482850161028a565b91505092915050565b7f4e487b7100000000000000000000000000000000000000000000000000000000600052601160045260246000fd5b60006103068261023f565b91506103118361023f565b925082821015610324576103236102cc565b5b82820390509291505056fea2646970667358221220f9e6a62314df73f622b0216c4436cbf5e0355bd422b2e8ee8d0f6b0f4f921d4764736f6c634300080a0033", "srcmap": "2516:441:0:-:0;;;;;;;;;;;;;;;;;;;", "srcmap-runtime": "2516:441:0:-:0;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;2557:40;;;;;;;;;;;;;:::i;:::-;;:::i;:::-;;;;;;;:::i;:::-;;;;;;;;2651:92;;;;;;;;;;;;;:::i;:::-;;:::i;:::-;;2557:40;;;;;;;;;;;;;;;;;:::o;2651:92::-;2711:25:::1;2729:6;2711:17;:25::i;:::-;2651:92:::0;:::o;2749:205::-;2826:8;:20;2835:10;2826:20;;;;;;;;;;;;;;;;2816:6;:30;;2808:39;;;;;;2867:10;2858:31;;;2897:6;2858:48;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;2941:6;2917:8;:20;2926:10;2917:20;;;;;;;;;;;;;;;;:30;;;;;;;:::i;:::-;;;;;;;;2749:205;:::o;88:117:1:-;197:1;194;187:12;334:126;371:7;411:42;404:5;400:54;389:65;;334:126;;;:::o;466:96::-;503:7;532:24;550:5;532:24;:::i;:::-;521:35;;466:96;;;:::o;568:122::-;641:24;659:5;641:24;:::i;:::-;634:5;631:35;621:63;;680:1;677;670:12;621:63;568:122;:::o;696:139::-;742:5;780:6;767:20;758:29;;796:33;823:5;796:33;:::i;:::-;696:139;;;;:::o;841:329::-;900:6;949:2;937:9;928:7;924:23;920:32;917:119;;;955:79;;:::i;:::-;917:119;1075:1;1100:53;1145:7;1136:6;1125:9;1121:22;1100:53;:::i;:::-;1090:63;;1046:117;841:329;;;;:::o;1176:77::-;1213:7;1242:5;1231:16;;1176:77;;;:::o;1259:118::-;1346:24;1364:5;1346:24;:::i;:::-;1341:3;1334:37;1259:118;;:::o;1383:222::-;1476:4;1514:2;1503:9;1499:18;1491:26;;1527:71;1595:1;1584:9;1580:17;1571:6;1527:71;:::i;:::-;1383:222;;;;:::o;1611:122::-;1684:24;1702:5;1684:24;:::i;:::-;1677:5;1674:35;1664:63;;1723:1;1720;1713:12;1664:63;1611:122;:::o;1739:139::-;1785:5;1823:6;1810:20;1801:29;;1839:33;1866:5;1839:33;:::i;:::-;1739:139;;;;:::o;1884:329::-;1943:6;1992:2;1980:9;1971:7;1967:23;1963:32;1960:119;;;1998:79;;:::i;:::-;1960:119;2118:1;2143:53;2188:7;2179:6;2168:9;2164:22;2143:53;:::i;:::-;2133:63;;2089:117;1884:329;;;;:::o;2219:180::-;2267:77;2264:1;2257:88;2364:4;2361:1;2354:15;2388:4;2385:1;2378:15;2405:191;2445:4;2465:20;2483:1;2465:20;:::i;:::-;2460:25;;2499:20;2517:1;2499:20;:::i;:::-;2494:25;;2538:1;2535;2532:8;2529:34;;;2543:18;;:::i;:::-;2529:34;2588:1;2585;2581:9;2573:17;;2405:191;;;;:::o", "filenames": {"absolute": "/Users/alpharush/tob/slither/tests/e2e/detectors/test_data/reentrancy-eth/0.8.10/reentrancy_with_non_reentrant.sol", "used": "tests/e2e/detectors/test_data/reentrancy-eth/0.8.10/reentrancy_with_non_reentrant.sol", "short": "tests/e2e/detectors/test_data/reentrancy-eth/0.8.10/reentrancy_with_non_reentrant.sol", "relative": "tests/e2e/detectors/test_data/reentrancy-eth/0.8.10/reentrancy_with_non_reentrant.sol"}, "libraries": {}, "is_dependency": false, "userdoc": {"methods": {}, "notice": null}, "devdoc": {"methods": {}, "author": null, "details": null, "title": null}}, "TestWithoutBug": {"abi": [{"inputs": [{"internalType": "uint256", "name": "amount", "type": "uint256"}], "name": "withdraw", "outputs": [], "stateMutability": "nonpayable", "type": "function"}, {"inputs": [], "name": "withdraw_all", "outputs": [], "stateMutability": "nonpayable", "type": "function"}], "bin": "608060405234801561001057600080fd5b50610351806100206000396000f3fe608060405234801561001057600080fd5b50600436106100365760003560e01c80632e1a7d4d1461003b578063dd473d2b14610057575b600080fd5b6100556004803603810190610050919061028b565b610061565b005b61005f610165565b005b6000803373ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff168152602001908152602001600020548111156100ac57600080fd5b3373ffffffffffffffffffffffffffffffffffffffff16631ad6506b826040518263ffffffff1660e01b81526004016000604051808303818588803b1580156100f457600080fd5b505af1158015610108573d6000803e3d6000fd5b5050505050806000803373ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff168152602001908152602001600020600082825461015b91906102e7565b9250508190555050565b60008060003373ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff16815260200190815260200160002054905060008060003373ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff168152602001908152602001600020819055503373ffffffffffffffffffffffffffffffffffffffff16631ad6506b826040518263ffffffff1660e01b81526004016000604051808303818588803b15801561023457600080fd5b505af1158015610248573d6000803e3d6000fd5b505050505050565b600080fd5b6000819050919050565b61026881610255565b811461027357600080fd5b50565b6000813590506102858161025f565b92915050565b6000602082840312156102a1576102a0610250565b5b60006102af84828501610276565b91505092915050565b7f4e487b7100000000000000000000000000000000000000000000000000000000600052601160045260246000fd5b60006102f282610255565b91506102fd83610255565b9250828210156103105761030f6102b8565b5b82820390509291505056fea2646970667358221220c887f1152b4c24eb94c10bd541e03eab583b0b2d44a709adbf353976ae15315064736f6c634300080a0033", "bin-runtime": "608060405234801561001057600080fd5b50600436106100365760003560e01c80632e1a7d4d1461003b578063dd473d2b14610057575b600080fd5b6100556004803603810190610050919061028b565b610061565b005b61005f610165565b005b6000803373ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff168152602001908152602001600020548111156100ac57600080fd5b3373ffffffffffffffffffffffffffffffffffffffff16631ad6506b826040518263ffffffff1660e01b81526004016000604051808303818588803b1580156100f457600080fd5b505af1158015610108573d6000803e3d6000fd5b5050505050806000803373ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff168152602001908152602001600020600082825461015b91906102e7565b9250508190555050565b60008060003373ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff16815260200190815260200160002054905060008060003373ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff168152602001908152602001600020819055503373ffffffffffffffffffffffffffffffffffffffff16631ad6506b826040518263ffffffff1660e01b81526004016000604051808303818588803b15801561023457600080fd5b505af1158015610248573d6000803e3d6000fd5b505050505050565b600080fd5b6000819050919050565b61026881610255565b811461027357600080fd5b50565b6000813590506102858161025f565b92915050565b6000602082840312156102a1576102a0610250565b5b60006102af84828501610276565b91505092915050565b7f4e487b7100000000000000000000000000000000000000000000000000000000600052601160045260246000fd5b60006102f282610255565b91506102fd83610255565b9250828210156103105761030f6102b8565b5b82820390509291505056fea2646970667358221220c887f1152b4c24eb94c10bd541e03eab583b0b2d44a709adbf353976ae15315064736f6c634300080a0033", "srcmap": "576:522:0:-:0;;;;;;;;;;;;;;;;;;;", "srcmap-runtime": "576:522:0:-:0;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;693:207;;;;;;;;;;;;;:::i;:::-;;:::i;:::-;;906:189;;;:::i;:::-;;693:207;772:8:::1;:20:::0;781:10:::1;772:20;;;;;;;;;;;;;;;;762:6;:30;;754:39;;;::::0;::::1;;813:10;804:31;;;843:6;804:48;;;;;;;;;;;;;;;;;;;;;;;;;;;;::::0;::::1;;;;;;;;;;;;::::0;::::1;;;;;;;;;;887:6;863:8;:20:::0;872:10:::1;863:20;;;;;;;;;;;;;;;;:30;;;;;;;:::i;:::-;;;;;;;;693:207:::0;:::o;906:189::-;960:11:::1;974:8:::0;:20:::1;983:10;974:20;;;;;;;;;;;;;;;;960:34;;1028:1;1005:8:::0;:20:::1;1014:10;1005:20;;;;;;;;;;;;;;;:24;;;;1049:10;1040:31;;;1079:6;1040:48;;;;;;;;;;;;;;;;;;;;;;;;;;;;::::0;::::1;;;;;;;;;;;;::::0;::::1;;;;;;;;;;949:146;906:189::o:0;88:117:1:-;197:1;194;187:12;334:77;371:7;400:5;389:16;;334:77;;;:::o;417:122::-;490:24;508:5;490:24;:::i;:::-;483:5;480:35;470:63;;529:1;526;519:12;470:63;417:122;:::o;545:139::-;591:5;629:6;616:20;607:29;;645:33;672:5;645:33;:::i;:::-;545:139;;;;:::o;690:329::-;749:6;798:2;786:9;777:7;773:23;769:32;766:119;;;804:79;;:::i;:::-;766:119;924:1;949:53;994:7;985:6;974:9;970:22;949:53;:::i;:::-;939:63;;895:117;690:329;;;;:::o;1025:180::-;1073:77;1070:1;1063:88;1170:4;1167:1;1160:15;1194:4;1191:1;1184:15;1211:191;1251:4;1271:20;1289:1;1271:20;:::i;:::-;1266:25;;1305:20;1323:1;1305:20;:::i;:::-;1300:25;;1344:1;1341;1338:8;1335:34;;;1349:18;;:::i;:::-;1335:34;1394:1;1391;1387:9;1379:17;;1211:191;;;;:::o", "filenames": {"absolute": "/Users/alpharush/tob/slither/tests/e2e/detectors/test_data/reentrancy-eth/0.8.10/reentrancy_with_non_reentrant.sol", "used": "tests/e2e/detectors/test_data/reentrancy-eth/0.8.10/reentrancy_with_non_reentrant.sol", "short": "tests/e2e/detectors/test_data/reentrancy-eth/0.8.10/reentrancy_with_non_reentrant.sol", "relative": "tests/e2e/detectors/test_data/reentrancy-eth/0.8.10/reentrancy_with_non_reentrant.sol"}, "libraries": {}, "is_dependency": false, "userdoc": {"methods": {}, "notice": null}, "devdoc": {"methods": {}, "author": null, "details": null, "title": null}}, "TestWithBugNonReentrantRead": {"abi": [{"inputs": [], "name": "read", "outputs": [{"internalType": "uint256", "name": "", "type": "uint256"}], "stateMutability": "nonpayable", "type": "function"}, {"inputs": [{"internalType": "uint256", "name": "amount", "type": "uint256"}], "name": "withdraw", "outputs": [], "stateMutability": "nonpayable", "type": "function"}], "bin": "608060405234801561001057600080fd5b506102ef806100206000396000f3fe608060405234801561001057600080fd5b50600436106100365760003560e01c80632e1a7d4d1461003b57806357de26a414610057575b600080fd5b610055600480360381019061005091906101ff565b610075565b005b61005f610179565b60405161006c919061023b565b60405180910390f35b6000803373ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff168152602001908152602001600020548111156100c057600080fd5b3373ffffffffffffffffffffffffffffffffffffffff16631ad6506b826040518263ffffffff1660e01b81526004016000604051808303818588803b15801561010857600080fd5b505af115801561011c573d6000803e3d6000fd5b5050505050806000803373ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff168152602001908152602001600020600082825461016f9190610285565b9250508190555050565b6000806000803373ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1681526020019081526020016000205490508091505090565b600080fd5b6000819050919050565b6101dc816101c9565b81146101e757600080fd5b50565b6000813590506101f9816101d3565b92915050565b600060208284031215610215576102146101c4565b5b6000610223848285016101ea565b91505092915050565b610235816101c9565b82525050565b6000602082019050610250600083018461022c565b92915050565b7f4e487b7100000000000000000000000000000000000000000000000000000000600052601160045260246000fd5b6000610290826101c9565b915061029b836101c9565b9250828210156102ae576102ad610256565b5b82820390509291505056fea2646970667358221220ac2d844219daab75fe800a6c832004bdf5fa8aae0566488764b4bc448bcd2dc964736f6c634300080a0033", "bin-runtime": "608060405234801561001057600080fd5b50600436106100365760003560e01c80632e1a7d4d1461003b57806357de26a414610057575b600080fd5b610055600480360381019061005091906101ff565b610075565b005b61005f610179565b60405161006c919061023b565b60405180910390f35b6000803373ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff168152602001908152602001600020548111156100c057600080fd5b3373ffffffffffffffffffffffffffffffffffffffff16631ad6506b826040518263ffffffff1660e01b81526004016000604051808303818588803b15801561010857600080fd5b505af115801561011c573d6000803e3d6000fd5b5050505050806000803373ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff168152602001908152602001600020600082825461016f9190610285565b9250508190555050565b6000806000803373ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1681526020019081526020016000205490508091505090565b600080fd5b6000819050919050565b6101dc816101c9565b81146101e757600080fd5b50565b6000813590506101f9816101d3565b92915050565b600060208284031215610215576102146101c4565b5b6000610223848285016101ea565b91505092915050565b610235816101c9565b82525050565b6000602082019050610250600083018461022c565b92915050565b7f4e487b7100000000000000000000000000000000000000000000000000000000600052601160045260246000fd5b6000610290826101c9565b915061029b836101c9565b9250828210156102ae576102ad610256565b5b82820390509291505056fea2646970667358221220ac2d844219daab75fe800a6c832004bdf5fa8aae0566488764b4bc448bcd2dc964736f6c634300080a0033", "srcmap": "2959:629:0:-:0;;;;;;;;;;;;;;;;;;;", "srcmap-runtime": "2959:629:0:-:0;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;3089:207;;;;;;;;;;;;;:::i;:::-;;:::i;:::-;;3473:112;;;:::i;:::-;;;;;;;:::i;:::-;;;;;;;;3089:207;3168:8:::1;:20:::0;3177:10:::1;3168:20;;;;;;;;;;;;;;;;3158:6;:30;;3150:39;;;::::0;::::1;;3209:10;3200:31;;;3239:6;3200:48;;;;;;;;;;;;;;;;;;;;;;;;;;;;::::0;::::1;;;;;;;;;;;;::::0;::::1;;;;;;;;;;3283:6;3259:8;:20:::0;3268:10:::1;3259:20;;;;;;;;;;;;;;;;:30;;;;;;;:::i;:::-;;;;;;;;3089:207:::0;:::o;3473:112::-;3504:4;3520:11;3534:8;:20;3543:10;3534:20;;;;;;;;;;;;;;;;3520:34;;3572:6;3565:13;;;3473:112;:::o;88:117:1:-;197:1;194;187:12;334:77;371:7;400:5;389:16;;334:77;;;:::o;417:122::-;490:24;508:5;490:24;:::i;:::-;483:5;480:35;470:63;;529:1;526;519:12;470:63;417:122;:::o;545:139::-;591:5;629:6;616:20;607:29;;645:33;672:5;645:33;:::i;:::-;545:139;;;;:::o;690:329::-;749:6;798:2;786:9;777:7;773:23;769:32;766:119;;;804:79;;:::i;:::-;766:119;924:1;949:53;994:7;985:6;974:9;970:22;949:53;:::i;:::-;939:63;;895:117;690:329;;;;:::o;1025:118::-;1112:24;1130:5;1112:24;:::i;:::-;1107:3;1100:37;1025:118;;:::o;1149:222::-;1242:4;1280:2;1269:9;1265:18;1257:26;;1293:71;1361:1;1350:9;1346:17;1337:6;1293:71;:::i;:::-;1149:222;;;;:::o;1377:180::-;1425:77;1422:1;1415:88;1522:4;1519:1;1512:15;1546:4;1543:1;1536:15;1563:191;1603:4;1623:20;1641:1;1623:20;:::i;:::-;1618:25;;1657:20;1675:1;1657:20;:::i;:::-;1652:25;;1696:1;1693;1690:8;1687:34;;;1701:18;;:::i;:::-;1687:34;1746:1;1743;1739:9;1731:17;;1563:191;;;;:::o", "filenames": {"absolute": "/Users/alpharush/tob/slither/tests/e2e/detectors/test_data/reentrancy-eth/0.8.10/reentrancy_with_non_reentrant.sol", "used": "tests/e2e/detectors/test_data/reentrancy-eth/0.8.10/reentrancy_with_non_reentrant.sol", "short": "tests/e2e/detectors/test_data/reentrancy-eth/0.8.10/reentrancy_with_non_reentrant.sol", "relative": "tests/e2e/detectors/test_data/reentrancy-eth/0.8.10/reentrancy_with_non_reentrant.sol"}, "libraries": {}, "is_dependency": false, "userdoc": {"methods": {}, "notice": null}, "devdoc": {"methods": {}, "author": null, "details": null, "title": null}}, "Receiver": {"abi": [{"inputs": [], "name": "send_funds", "outputs": [], "stateMutability": "payable", "type": "function"}], "bin": "", "bin-runtime": "", "srcmap": "", "srcmap-runtime": "", "filenames": {"absolute": "/Users/alpharush/tob/slither/tests/e2e/detectors/test_data/reentrancy-eth/0.8.10/reentrancy_with_non_reentrant.sol", "used": "tests/e2e/detectors/test_data/reentrancy-eth/0.8.10/reentrancy_with_non_reentrant.sol", "short": "tests/e2e/detectors/test_data/reentrancy-eth/0.8.10/reentrancy_with_non_reentrant.sol", "relative": "tests/e2e/detectors/test_data/reentrancy-eth/0.8.10/reentrancy_with_non_reentrant.sol"}, "libraries": {}, "is_dependency": false, "userdoc": {"methods": {}, "notice": null}, "devdoc": {"methods": {}, "author": null, "details": null, "title": null}}, "TestWithBugInternal": {"abi": [{"inputs": [{"internalType": "uint256", "name": "amount", "type": "uint256"}], "name": "withdraw", "outputs": [], "stateMutability": "nonpayable", "type": "function"}, {"inputs": [], "name": "withdraw_all", "outputs": [], "stateMutability": "nonpayable", "type": "function"}], "bin": "608060405234801561001057600080fd5b50610367806100206000396000f3fe608060405234801561001057600080fd5b50600436106100365760003560e01c80632e1a7d4d1461003b578063dd473d2b14610057575b600080fd5b610055600480360381019061005091906102a1565b610061565b005b61005f61006d565b005b61006a81610077565b50565b61007561017b565b565b6000803373ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff168152602001908152602001600020548111156100c257600080fd5b3373ffffffffffffffffffffffffffffffffffffffff16631ad6506b826040518263ffffffff1660e01b81526004016000604051808303818588803b15801561010a57600080fd5b505af115801561011e573d6000803e3d6000fd5b5050505050806000803373ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff168152602001908152602001600020600082825461017191906102fd565b9250508190555050565b60008060003373ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff16815260200190815260200160002054905060008060003373ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff168152602001908152602001600020819055503373ffffffffffffffffffffffffffffffffffffffff16631ad6506b826040518263ffffffff1660e01b81526004016000604051808303818588803b15801561024a57600080fd5b505af115801561025e573d6000803e3d6000fd5b505050505050565b600080fd5b6000819050919050565b61027e8161026b565b811461028957600080fd5b50565b60008135905061029b81610275565b92915050565b6000602082840312156102b7576102b6610266565b5b60006102c58482850161028c565b91505092915050565b7f4e487b7100000000000000000000000000000000000000000000000000000000600052601160045260246000fd5b60006103088261026b565b91506103138361026b565b925082821015610326576103256102ce565b5b82820390509291505056fea2646970667358221220665bffec788bfa5bac422d443a933e9a371337dafba6270e41b6517bb686cb2a64736f6c634300080a0033", "bin-runtime": "608060405234801561001057600080fd5b50600436106100365760003560e01c80632e1a7d4d1461003b578063dd473d2b14610057575b600080fd5b610055600480360381019061005091906102a1565b610061565b005b61005f61006d565b005b61006a81610077565b50565b61007561017b565b565b6000803373ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff168152602001908152602001600020548111156100c257600080fd5b3373ffffffffffffffffffffffffffffffffffffffff16631ad6506b826040518263ffffffff1660e01b81526004016000604051808303818588803b15801561010a57600080fd5b505af115801561011e573d6000803e3d6000fd5b5050505050806000803373ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff168152602001908152602001600020600082825461017191906102fd565b9250508190555050565b60008060003373ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff16815260200190815260200160002054905060008060003373ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff168152602001908152602001600020819055503373ffffffffffffffffffffffffffffffffffffffff16631ad6506b826040518263ffffffff1660e01b81526004016000604051808303818588803b15801561024a57600080fd5b505af115801561025e573d6000803e3d6000fd5b505050505050565b600080fd5b6000819050919050565b61027e8161026b565b811461028957600080fd5b50565b60008135905061029b81610275565b92915050565b6000602082840312156102b7576102b6610266565b5b60006102c58482850161028c565b91505092915050565b7f4e487b7100000000000000000000000000000000000000000000000000000000600052601160045260246000fd5b60006103088261026b565b91506103138361026b565b925082821015610326576103256102ce565b5b82820390509291505056fea2646970667358221220665bffec788bfa5bac422d443a933e9a371337dafba6270e41b6517bb686cb2a64736f6c634300080a0033", "srcmap": "1100:698:0:-:0;;;;;;;;;;;;;;;;;;;", "srcmap-runtime": "1100:698:0:-:0;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;1222:92;;;;;;;;;;;;;:::i;:::-;;:::i;:::-;;1531:70;;;:::i;:::-;;1222:92;1282:25:::1;1300:6;1282:17;:25::i;:::-;1222:92:::0;:::o;1531:70::-;1571:23;:21;:23::i;:::-;1531:70::o;1320:205::-;1397:8;:20;1406:10;1397:20;;;;;;;;;;;;;;;;1387:6;:30;;1379:39;;;;;;1438:10;1429:31;;;1468:6;1429:48;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;1512:6;1488:8;:20;1497:10;1488:20;;;;;;;;;;;;;;;;:30;;;;;;;:::i;:::-;;;;;;;;1320:205;:::o;1607:188::-;1660:11;1674:8;:20;1683:10;1674:20;;;;;;;;;;;;;;;;1660:34;;1728:1;1705:8;:20;1714:10;1705:20;;;;;;;;;;;;;;;:24;;;;1749:10;1740:31;;;1779:6;1740:48;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;1649:146;1607:188::o;88:117:1:-;197:1;194;187:12;334:77;371:7;400:5;389:16;;334:77;;;:::o;417:122::-;490:24;508:5;490:24;:::i;:::-;483:5;480:35;470:63;;529:1;526;519:12;470:63;417:122;:::o;545:139::-;591:5;629:6;616:20;607:29;;645:33;672:5;645:33;:::i;:::-;545:139;;;;:::o;690:329::-;749:6;798:2;786:9;777:7;773:23;769:32;766:119;;;804:79;;:::i;:::-;766:119;924:1;949:53;994:7;985:6;974:9;970:22;949:53;:::i;:::-;939:63;;895:117;690:329;;;;:::o;1025:180::-;1073:77;1070:1;1063:88;1170:4;1167:1;1160:15;1194:4;1191:1;1184:15;1211:191;1251:4;1271:20;1289:1;1271:20;:::i;:::-;1266:25;;1305:20;1323:1;1305:20;:::i;:::-;1300:25;;1344:1;1341;1338:8;1335:34;;;1349:18;;:::i;:::-;1335:34;1394:1;1391;1387:9;1379:17;;1211:191;;;;:::o", "filenames": {"absolute": "/Users/alpharush/tob/slither/tests/e2e/detectors/test_data/reentrancy-eth/0.8.10/reentrancy_with_non_reentrant.sol", "used": "tests/e2e/detectors/test_data/reentrancy-eth/0.8.10/reentrancy_with_non_reentrant.sol", "short": "tests/e2e/detectors/test_data/reentrancy-eth/0.8.10/reentrancy_with_non_reentrant.sol", "relative": "tests/e2e/detectors/test_data/reentrancy-eth/0.8.10/reentrancy_with_non_reentrant.sol"}, "libraries": {}, "is_dependency": false, "userdoc": {"methods": {}, "notice": null}, "devdoc": {"methods": {}, "author": null, "details": null, "title": null}}, "TestWithBug": {"abi": [{"inputs": [{"internalType": "uint256", "name": "amount", "type": "uint256"}], "name": "withdraw", "outputs": [], "stateMutability": "nonpayable", "type": "function"}, {"inputs": [], "name": "withdraw_all", "outputs": [], "stateMutability": "nonpayable", "type": "function"}], "bin": "608060405234801561001057600080fd5b50610351806100206000396000f3fe608060405234801561001057600080fd5b50600436106100365760003560e01c80632e1a7d4d1461003b578063dd473d2b14610057575b600080fd5b6100556004803603810190610050919061028b565b610061565b005b61005f610165565b005b6000803373ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff168152602001908152602001600020548111156100ac57600080fd5b3373ffffffffffffffffffffffffffffffffffffffff16631ad6506b826040518263ffffffff1660e01b81526004016000604051808303818588803b1580156100f457600080fd5b505af1158015610108573d6000803e3d6000fd5b5050505050806000803373ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff168152602001908152602001600020600082825461015b91906102e7565b9250508190555050565b60008060003373ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff16815260200190815260200160002054905060008060003373ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff168152602001908152602001600020819055503373ffffffffffffffffffffffffffffffffffffffff16631ad6506b826040518263ffffffff1660e01b81526004016000604051808303818588803b15801561023457600080fd5b505af1158015610248573d6000803e3d6000fd5b505050505050565b600080fd5b6000819050919050565b61026881610255565b811461027357600080fd5b50565b6000813590506102858161025f565b92915050565b6000602082840312156102a1576102a0610250565b5b60006102af84828501610276565b91505092915050565b7f4e487b7100000000000000000000000000000000000000000000000000000000600052601160045260246000fd5b60006102f282610255565b91506102fd83610255565b9250828210156103105761030f6102b8565b5b82820390509291505056fea26469706673582212202886520a373a9b2a44039b7f29e08d037c6c68922fbafe75b882d3d36cec217f64736f6c634300080a0033", "bin-runtime": "608060405234801561001057600080fd5b50600436106100365760003560e01c80632e1a7d4d1461003b578063dd473d2b14610057575b600080fd5b6100556004803603810190610050919061028b565b610061565b005b61005f610165565b005b6000803373ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff168152602001908152602001600020548111156100ac57600080fd5b3373ffffffffffffffffffffffffffffffffffffffff16631ad6506b826040518263ffffffff1660e01b81526004016000604051808303818588803b1580156100f457600080fd5b505af1158015610108573d6000803e3d6000fd5b5050505050806000803373ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff168152602001908152602001600020600082825461015b91906102e7565b9250508190555050565b60008060003373ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff16815260200190815260200160002054905060008060003373ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff168152602001908152602001600020819055503373ffffffffffffffffffffffffffffffffffffffff16631ad6506b826040518263ffffffff1660e01b81526004016000604051808303818588803b15801561023457600080fd5b505af1158015610248573d6000803e3d6000fd5b505050505050565b600080fd5b6000819050919050565b61026881610255565b811461027357600080fd5b50565b6000813590506102858161025f565b92915050565b6000602082840312156102a1576102a0610250565b5b60006102af84828501610276565b91505092915050565b7f4e487b7100000000000000000000000000000000000000000000000000000000600052601160045260246000fd5b60006102f282610255565b91506102fd83610255565b9250828210156103105761030f6102b8565b5b82820390509291505056fea26469706673582212202886520a373a9b2a44039b7f29e08d037c6c68922fbafe75b882d3d36cec217f64736f6c634300080a0033", "srcmap": "67:506:0:-:0;;;;;;;;;;;;;;;;;;;", "srcmap-runtime": "67:506:0:-:0;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;181:207;;;;;;;;;;;;;:::i;:::-;;:::i;:::-;;394:176;;;:::i;:::-;;181:207;260:8:::1;:20:::0;269:10:::1;260:20;;;;;;;;;;;;;;;;250:6;:30;;242:39;;;::::0;::::1;;301:10;292:31;;;331:6;292:48;;;;;;;;;;;;;;;;;;;;;;;;;;;;::::0;::::1;;;;;;;;;;;;::::0;::::1;;;;;;;;;;375:6;351:8;:20:::0;360:10:::1;351:20;;;;;;;;;;;;;;;;:30;;;;;;;:::i;:::-;;;;;;;;181:207:::0;:::o;394:176::-;435:11;449:8;:20;458:10;449:20;;;;;;;;;;;;;;;;435:34;;503:1;480:8;:20;489:10;480:20;;;;;;;;;;;;;;;:24;;;;524:10;515:31;;;554:6;515:48;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;424:146;394:176::o;88:117:1:-;197:1;194;187:12;334:77;371:7;400:5;389:16;;334:77;;;:::o;417:122::-;490:24;508:5;490:24;:::i;:::-;483:5;480:35;470:63;;529:1;526;519:12;470:63;417:122;:::o;545:139::-;591:5;629:6;616:20;607:29;;645:33;672:5;645:33;:::i;:::-;545:139;;;;:::o;690:329::-;749:6;798:2;786:9;777:7;773:23;769:32;766:119;;;804:79;;:::i;:::-;766:119;924:1;949:53;994:7;985:6;974:9;970:22;949:53;:::i;:::-;939:63;;895:117;690:329;;;;:::o;1025:180::-;1073:77;1070:1;1063:88;1170:4;1167:1;1160:15;1194:4;1191:1;1184:15;1211:191;1251:4;1271:20;1289:1;1271:20;:::i;:::-;1266:25;;1305:20;1323:1;1305:20;:::i;:::-;1300:25;;1344:1;1341;1338:8;1335:34;;;1349:18;;:::i;:::-;1335:34;1394:1;1391;1387:9;1379:17;;1211:191;;;;:::o", "filenames": {"absolute": "/Users/alpharush/tob/slither/tests/e2e/detectors/test_data/reentrancy-eth/0.8.10/reentrancy_with_non_reentrant.sol", "used": "tests/e2e/detectors/test_data/reentrancy-eth/0.8.10/reentrancy_with_non_reentrant.sol", "short": "tests/e2e/detectors/test_data/reentrancy-eth/0.8.10/reentrancy_with_non_reentrant.sol", "relative": "tests/e2e/detectors/test_data/reentrancy-eth/0.8.10/reentrancy_with_non_reentrant.sol"}, "libraries": {}, "is_dependency": false, "userdoc": {"methods": {}, "notice": null}, "devdoc": {"methods": {}, "author": null, "details": null, "title": null}}}}}, "filenames": [{"absolute": "/Users/alpharush/tob/slither/tests/e2e/detectors/test_data/reentrancy-eth/0.8.10/reentrancy_with_non_reentrant.sol", "used": "tests/e2e/detectors/test_data/reentrancy-eth/0.8.10/reentrancy_with_non_reentrant.sol", "short": "tests/e2e/detectors/test_data/reentrancy-eth/0.8.10/reentrancy_with_non_reentrant.sol", "relative": "tests/e2e/detectors/test_data/reentrancy-eth/0.8.10/reentrancy_with_non_reentrant.sol"}]}}, "package": null, "working_dir": "/Users/alpharush/tob/slither", "type": 1, "unit_tests": [], "crytic_version": "0.0.2", "source_content": {"/Users/alpharush/tob/slither/tests/e2e/detectors/test_data/reentrancy-eth/0.8.10/reentrancy_with_non_reentrant.sol": "interface Receiver{\n    function send_funds() payable external;\n}\n\ncontract TestWithBug{\n\n    mapping(address => uint) balances;\n\n    modifier nonReentrant(){\n        _;\n    }\n\n    function withdraw(uint amount) nonReentrant public{\n         require(amount <= balances[msg.sender]);\n         Receiver(msg.sender).send_funds{value: amount}();\n         balances[msg.sender] -= amount;\n    }\n\n    function withdraw_all() public{\n         uint amount = balances[msg.sender];\n         balances[msg.sender] = 0;\n         Receiver(msg.sender).send_funds{value: amount}();\n    }\n\n}\n\n\ncontract TestWithoutBug{\n\n    mapping(address => uint) balances;\n\n    modifier nonReentrant(){\n        _;\n    }\n\n    function withdraw(uint amount) nonReentrant public{\n         require(amount <= balances[msg.sender]);\n         Receiver(msg.sender).send_funds{value: amount}();\n         balances[msg.sender] -= amount;\n    }\n\n    function withdraw_all() nonReentrant public{\n         uint amount = balances[msg.sender];\n         balances[msg.sender] = 0;\n         Receiver(msg.sender).send_funds{value: amount}();\n    }\n\n}\n\ncontract TestWithBugInternal{\n\n    mapping(address => uint) balances;\n\n    modifier nonReentrant(){\n        _;\n    }\n\n    function withdraw(uint amount) nonReentrant public{\n        withdraw_internal(amount);\n    }\n\n    function withdraw_internal(uint amount) internal{\n         require(amount <= balances[msg.sender]);\n         Receiver(msg.sender).send_funds{value: amount}();\n         balances[msg.sender] -= amount;\n    }\n\n    function withdraw_all() public{\n        withdraw_all_internal();\n    }\n\n    function withdraw_all_internal() internal {\n         uint amount = balances[msg.sender];\n         balances[msg.sender] = 0;\n         Receiver(msg.sender).send_funds{value: amount}();\n    }\n\n}\n\ncontract TestWithoutBugInternal{\n\n    mapping(address => uint) balances;\n\n    modifier nonReentrant(){\n        _;\n    }\n\n    function withdraw(uint amount) nonReentrant public{\n        withdraw_internal(amount);\n    }\n\n    function withdraw_internal(uint amount) internal{\n         require(amount <= balances[msg.sender]);\n         Receiver(msg.sender).send_funds{value: amount}();\n         balances[msg.sender] -= amount;\n    }\n\n    function withdraw_all() nonReentrant public{\n        withdraw_all_internal();\n    }\n\n    function withdraw_all_internal() internal {\n         uint amount = balances[msg.sender];\n         balances[msg.sender] = 0;\n         Receiver(msg.sender).send_funds{value: amount}();\n    }\n\n}\n\ncontract TestBugWithPublicVariable{\n\n    mapping(address => uint) public balances;\n\n    modifier nonReentrant(){\n        _;\n    }\n\n    function withdraw(uint amount) nonReentrant public{\n        withdraw_internal(amount);\n    }\n\n    function withdraw_internal(uint amount) internal{\n         require(amount <= balances[msg.sender]);\n         Receiver(msg.sender).send_funds{value: amount}();\n         balances[msg.sender] -= amount;\n    }\n\n}\n\ncontract TestWithBugNonReentrantRead{\n\n    mapping(address => uint) balances;\n\n    modifier nonReentrant(){\n        _;\n    }\n\n    function withdraw(uint amount) nonReentrant public{\n         require(amount <= balances[msg.sender]);\n         Receiver(msg.sender).send_funds{value: amount}();\n         balances[msg.sender] -= amount;\n    }\n\n    // Simulate a reentrancy that allows to read variable in a potential incorrect state during a reentrancy\n    // This is more likely to impact protocol like reentrancy\n    function read() public returns(uint){\n         uint amount = balances[msg.sender];\n         return amount;\n    }\n\n}\n"}}