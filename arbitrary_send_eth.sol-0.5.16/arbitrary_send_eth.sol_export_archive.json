{"compilation_units": {"/Users/alpharush/tob/slither/tests/e2e/detectors/test_data/arbitrary-send-eth/0.5.16/arbitrary_send_eth.sol": {"compiler": {"compiler": "solc", "version": "0.5.16", "optimized": false}, "source_units": {"tests/e2e/detectors/test_data/arbitrary-send-eth/0.5.16/arbitrary_send_eth.sol": {"ast": {"absolutePath": "tests/e2e/detectors/test_data/arbitrary-send-eth/0.5.16/arbitrary_send_eth.sol", "exportedSymbols": {"Test": [229]}, "id": 230, "nodeType": "SourceUnit", "nodes": [{"baseContracts": [], "contractDependencies": [], "contractKind": "contract", "documentation": null, "fullyImplemented": true, "id": 229, "linearizedBaseContracts": [229], "name": "Test", "nodeType": "ContractDefinition", "nodes": [{"constant": false, "id": 117, "name": "destination", "nodeType": "VariableDeclaration", "scope": 229, "src": "20:27:1", "stateVariable": true, "storageLocation": "default", "typeDescriptions": {"typeIdentifier": "t_address_payable", "typeString": "address payable"}, "typeName": {"id": 116, "name": "address", "nodeType": "ElementaryTypeName", "src": "20:15:1", "stateMutability": "payable", "typeDescriptions": {"typeIdentifier": "t_address_payable", "typeString": "address payable"}}, "value": null, "visibility": "internal"}, {"constant": false, "id": 121, "name": "balances", "nodeType": "VariableDeclaration", "scope": 229, "src": "54:34:1", "stateVariable": true, "storageLocation": "default", "typeDescriptions": {"typeIdentifier": "t_mapping$_t_address_$_t_uint256_$", "typeString": "mapping(address => uint256)"}, "typeName": {"id": 120, "keyType": {"id": 118, "name": "address", "nodeType": "ElementaryTypeName", "src": "63:7:1", "typeDescriptions": {"typeIdentifier": "t_address", "typeString": "address"}}, "nodeType": "Mapping", "src": "54:25:1", "typeDescriptions": {"typeIdentifier": "t_mapping$_t_address_$_t_uint256_$", "typeString": "mapping(address => uint256)"}, "valueType": {"id": 119, "name": "uint", "nodeType": "ElementaryTypeName", "src": "74:4:1", "typeDescriptions": {"typeIdentifier": "t_uint256", "typeString": "uint256"}}}, "value": null, "visibility": "internal"}, {"body": {"id": 131, "nodeType": "Block", "src": "115:41:1", "statements": [{"expression": {"argumentTypes": null, "id": 129, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "leftHandSide": {"argumentTypes": null, "baseExpression": {"argumentTypes": null, "id": 124, "name": "balances", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 121, "src": "125:8:1", "typeDescriptions": {"typeIdentifier": "t_mapping$_t_address_$_t_uint256_$", "typeString": "mapping(address => uint256)"}}, "id": 127, "indexExpression": {"argumentTypes": null, "expression": {"argumentTypes": null, "id": 125, "name": "msg", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 244, "src": "134:3:1", "typeDescriptions": {"typeIdentifier": "t_magic_message", "typeString": "msg"}}, "id": 126, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "memberName": "sender", "nodeType": "MemberAccess", "referencedDeclaration": null, "src": "134:10:1", "typeDescriptions": {"typeIdentifier": "t_address_payable", "typeString": "address payable"}}, "isConstant": false, "isLValue": true, "isPure": false, "lValueRequested": true, "nodeType": "IndexAccess", "src": "125:20:1", "typeDescriptions": {"typeIdentifier": "t_uint256", "typeString": "uint256"}}, "nodeType": "Assignment", "operator": "=", "rightHandSide": {"argumentTypes": null, "hexValue": "30", "id": 128, "isConstant": false, "isLValue": false, "isPure": true, "kind": "number", "lValueRequested": false, "nodeType": "Literal", "src": "148:1:1", "subdenomination": null, "typeDescriptions": {"typeIdentifier": "t_rational_0_by_1", "typeString": "int_const 0"}, "value": "0"}, "src": "125:24:1", "typeDescriptions": {"typeIdentifier": "t_uint256", "typeString": "uint256"}}, "id": 130, "nodeType": "ExpressionStatement", "src": "125:24:1"}]}, "documentation": null, "id": 132, "implemented": true, "kind": "constructor", "modifiers": [], "name": "", "nodeType": "FunctionDefinition", "parameters": {"id": 122, "nodeType": "ParameterList", "parameters": [], "src": "106:2:1"}, "returnParameters": {"id": 123, "nodeType": "ParameterList", "parameters": [], "src": "115:0:1"}, "scope": 229, "src": "95:61:1", "stateMutability": "nonpayable", "superFunction": null, "visibility": "public"}, {"body": {"id": 146, "nodeType": "Block", "src": "186:55:1", "statements": [{"expression": {"argumentTypes": null, "arguments": [{"argumentTypes": null, "expression": {"argumentTypes": null, "arguments": [{"argumentTypes": null, "id": 141, "name": "this", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 260, "src": "220:4:1", "typeDescriptions": {"typeIdentifier": "t_contract$_Test_$229", "typeString": "contract Test"}}], "expression": {"argumentTypes": [{"typeIdentifier": "t_contract$_Test_$229", "typeString": "contract Test"}], "id": 140, "isConstant": false, "isLValue": false, "isPure": true, "lValueRequested": false, "nodeType": "ElementaryTypeNameExpression", "src": "212:7:1", "typeDescriptions": {"typeIdentifier": "t_type$_t_address_$", "typeString": "type(address)"}, "typeName": "address"}, "id": 142, "isConstant": false, "isLValue": false, "isPure": false, "kind": "typeConversion", "lValueRequested": false, "names": [], "nodeType": "FunctionCall", "src": "212:13:1", "typeDescriptions": {"typeIdentifier": "t_address", "typeString": "address"}}, "id": 143, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "memberName": "balance", "nodeType": "MemberAccess", "referencedDeclaration": null, "src": "212:21:1", "typeDescriptions": {"typeIdentifier": "t_uint256", "typeString": "uint256"}}], "expression": {"argumentTypes": [{"typeIdentifier": "t_uint256", "typeString": "uint256"}], "expression": {"argumentTypes": null, "expression": {"argumentTypes": null, "id": 135, "name": "msg", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 244, "src": "196:3:1", "typeDescriptions": {"typeIdentifier": "t_magic_message", "typeString": "msg"}}, "id": 138, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "memberName": "sender", "nodeType": "MemberAccess", "referencedDeclaration": null, "src": "196:10:1", "typeDescriptions": {"typeIdentifier": "t_address_payable", "typeString": "address payable"}}, "id": 139, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "memberName": "send", "nodeType": "MemberAccess", "referencedDeclaration": null, "src": "196:15:1", "typeDescriptions": {"typeIdentifier": "t_function_send_nonpayable$_t_uint256_$returns$_t_bool_$", "typeString": "function (uint256) returns (bool)"}}, "id": 144, "isConstant": false, "isLValue": false, "isPure": false, "kind": "functionCall", "lValueRequested": false, "names": [], "nodeType": "FunctionCall", "src": "196:38:1", "typeDescriptions": {"typeIdentifier": "t_bool", "typeString": "bool"}}, "id": 145, "nodeType": "ExpressionStatement", "src": "196:38:1"}]}, "documentation": null, "id": 147, "implemented": true, "kind": "function", "modifiers": [], "name": "direct", "nodeType": "FunctionDefinition", "parameters": {"id": 133, "nodeType": "ParameterList", "parameters": [], "src": "177:2:1"}, "returnParameters": {"id": 134, "nodeType": "ParameterList", "parameters": [], "src": "186:0:1"}, "scope": 229, "src": "162:79:1", "stateMutability": "nonpayable", "superFunction": null, "visibility": "public"}, {"body": {"id": 155, "nodeType": "Block", "src": "269:41:1", "statements": [{"expression": {"argumentTypes": null, "id": 153, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "leftHandSide": {"argumentTypes": null, "id": 150, "name": "destination", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 117, "src": "279:11:1", "typeDescriptions": {"typeIdentifier": "t_address_payable", "typeString": "address payable"}}, "nodeType": "Assignment", "operator": "=", "rightHandSide": {"argumentTypes": null, "expression": {"argumentTypes": null, "id": 151, "name": "msg", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 244, "src": "293:3:1", "typeDescriptions": {"typeIdentifier": "t_magic_message", "typeString": "msg"}}, "id": 152, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "memberName": "sender", "nodeType": "MemberAccess", "referencedDeclaration": null, "src": "293:10:1", "typeDescriptions": {"typeIdentifier": "t_address_payable", "typeString": "address payable"}}, "src": "279:24:1", "typeDescriptions": {"typeIdentifier": "t_address_payable", "typeString": "address payable"}}, "id": 154, "nodeType": "ExpressionStatement", "src": "279:24:1"}]}, "documentation": null, "id": 156, "implemented": true, "kind": "function", "modifiers": [], "name": "init", "nodeType": "FunctionDefinition", "parameters": {"id": 148, "nodeType": "ParameterList", "parameters": [], "src": "260:2:1"}, "returnParameters": {"id": 149, "nodeType": "ParameterList", "parameters": [], "src": "269:0:1"}, "scope": 229, "src": "247:63:1", "stateMutability": "nonpayable", "superFunction": null, "visibility": "public"}, {"body": {"id": 168, "nodeType": "Block", "src": "342:56:1", "statements": [{"expression": {"argumentTypes": null, "arguments": [{"argumentTypes": null, "expression": {"argumentTypes": null, "arguments": [{"argumentTypes": null, "id": 163, "name": "this", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 260, "src": "377:4:1", "typeDescriptions": {"typeIdentifier": "t_contract$_Test_$229", "typeString": "contract Test"}}], "expression": {"argumentTypes": [{"typeIdentifier": "t_contract$_Test_$229", "typeString": "contract Test"}], "id": 162, "isConstant": false, "isLValue": false, "isPure": true, "lValueRequested": false, "nodeType": "ElementaryTypeNameExpression", "src": "369:7:1", "typeDescriptions": {"typeIdentifier": "t_type$_t_address_$", "typeString": "type(address)"}, "typeName": "address"}, "id": 164, "isConstant": false, "isLValue": false, "isPure": false, "kind": "typeConversion", "lValueRequested": false, "names": [], "nodeType": "FunctionCall", "src": "369:13:1", "typeDescriptions": {"typeIdentifier": "t_address", "typeString": "address"}}, "id": 165, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "memberName": "balance", "nodeType": "MemberAccess", "referencedDeclaration": null, "src": "369:21:1", "typeDescriptions": {"typeIdentifier": "t_uint256", "typeString": "uint256"}}], "expression": {"argumentTypes": [{"typeIdentifier": "t_uint256", "typeString": "uint256"}], "expression": {"argumentTypes": null, "id": 159, "name": "destination", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 117, "src": "352:11:1", "typeDescriptions": {"typeIdentifier": "t_address_payable", "typeString": "address payable"}}, "id": 161, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "memberName": "send", "nodeType": "MemberAccess", "referencedDeclaration": null, "src": "352:16:1", "typeDescriptions": {"typeIdentifier": "t_function_send_nonpayable$_t_uint256_$returns$_t_bool_$", "typeString": "function (uint256) returns (bool)"}}, "id": 166, "isConstant": false, "isLValue": false, "isPure": false, "kind": "functionCall", "lValueRequested": false, "names": [], "nodeType": "FunctionCall", "src": "352:39:1", "typeDescriptions": {"typeIdentifier": "t_bool", "typeString": "bool"}}, "id": 167, "nodeType": "ExpressionStatement", "src": "352:39:1"}]}, "documentation": null, "id": 169, "implemented": true, "kind": "function", "modifiers": [], "name": "indirect", "nodeType": "FunctionDefinition", "parameters": {"id": 157, "nodeType": "ParameterList", "parameters": [], "src": "333:2:1"}, "returnParameters": {"id": 158, "nodeType": "ParameterList", "parameters": [], "src": "342:0:1"}, "scope": 229, "src": "316:82:1", "stateMutability": "nonpayable", "superFunction": null, "visibility": "public"}, {"body": {"id": 181, "nodeType": "Block", "src": "503:47:1", "statements": [{"expression": {"argumentTypes": null, "arguments": [{"argumentTypes": null, "expression": {"argumentTypes": null, "id": 177, "name": "msg", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 244, "src": "533:3:1", "typeDescriptions": {"typeIdentifier": "t_magic_message", "typeString": "msg"}}, "id": 178, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "memberName": "value", "nodeType": "MemberAccess", "referencedDeclaration": null, "src": "533:9:1", "typeDescriptions": {"typeIdentifier": "t_uint256", "typeString": "uint256"}}], "expression": {"argumentTypes": [{"typeIdentifier": "t_uint256", "typeString": "uint256"}], "expression": {"argumentTypes": null, "expression": {"argumentTypes": null, "id": 172, "name": "msg", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 244, "src": "513:3:1", "typeDescriptions": {"typeIdentifier": "t_magic_message", "typeString": "msg"}}, "id": 175, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "memberName": "sender", "nodeType": "MemberAccess", "referencedDeclaration": null, "src": "513:10:1", "typeDescriptions": {"typeIdentifier": "t_address_payable", "typeString": "address payable"}}, "id": 176, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "memberName": "transfer", "nodeType": "MemberAccess", "referencedDeclaration": null, "src": "513:19:1", "typeDescriptions": {"typeIdentifier": "t_function_transfer_nonpayable$_t_uint256_$returns$__$", "typeString": "function (uint256)"}}, "id": 179, "isConstant": false, "isLValue": false, "isPure": false, "kind": "functionCall", "lValueRequested": false, "names": [], "nodeType": "FunctionCall", "src": "513:30:1", "typeDescriptions": {"typeIdentifier": "t_tuple$__$", "typeString": "tuple()"}}, "id": 180, "nodeType": "ExpressionStatement", "src": "513:30:1"}]}, "documentation": null, "id": 182, "implemented": true, "kind": "function", "modifiers": [], "name": "repay", "nodeType": "FunctionDefinition", "parameters": {"id": 170, "nodeType": "ParameterList", "parameters": [], "src": "486:2:1"}, "returnParameters": {"id": 171, "nodeType": "ParameterList", "parameters": [], "src": "503:0:1"}, "scope": 229, "src": "472:78:1", "stateMutability": "payable", "superFunction": null, "visibility": "public"}, {"body": {"id": 200, "nodeType": "Block", "src": "582:78:1", "statements": [{"assignments": [186], "declarations": [{"constant": false, "id": 186, "name": "val", "nodeType": "VariableDeclaration", "scope": 200, "src": "592:8:1", "stateVariable": false, "storageLocation": "default", "typeDescriptions": {"typeIdentifier": "t_uint256", "typeString": "uint256"}, "typeName": {"id": 185, "name": "uint", "nodeType": "ElementaryTypeName", "src": "592:4:1", "typeDescriptions": {"typeIdentifier": "t_uint256", "typeString": "uint256"}}, "value": null, "visibility": "internal"}], "id": 191, "initialValue": {"argumentTypes": null, "baseExpression": {"argumentTypes": null, "id": 187, "name": "balances", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 121, "src": "603:8:1", "typeDescriptions": {"typeIdentifier": "t_mapping$_t_address_$_t_uint256_$", "typeString": "mapping(address => uint256)"}}, "id": 190, "indexExpression": {"argumentTypes": null, "expression": {"argumentTypes": null, "id": 188, "name": "msg", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 244, "src": "612:3:1", "typeDescriptions": {"typeIdentifier": "t_magic_message", "typeString": "msg"}}, "id": 189, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "memberName": "sender", "nodeType": "MemberAccess", "referencedDeclaration": null, "src": "612:10:1", "typeDescriptions": {"typeIdentifier": "t_address_payable", "typeString": "address payable"}}, "isConstant": false, "isLValue": true, "isPure": false, "lValueRequested": false, "nodeType": "IndexAccess", "src": "603:20:1", "typeDescriptions": {"typeIdentifier": "t_uint256", "typeString": "uint256"}}, "nodeType": "VariableDeclarationStatement", "src": "592:31:1"}, {"expression": {"argumentTypes": null, "arguments": [{"argumentTypes": null, "id": 197, "name": "val", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 186, "src": "649:3:1", "typeDescriptions": {"typeIdentifier": "t_uint256", "typeString": "uint256"}}], "expression": {"argumentTypes": [{"typeIdentifier": "t_uint256", "typeString": "uint256"}], "expression": {"argumentTypes": null, "expression": {"argumentTypes": null, "id": 192, "name": "msg", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 244, "src": "633:3:1", "typeDescriptions": {"typeIdentifier": "t_magic_message", "typeString": "msg"}}, "id": 195, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "memberName": "sender", "nodeType": "MemberAccess", "referencedDeclaration": null, "src": "633:10:1", "typeDescriptions": {"typeIdentifier": "t_address_payable", "typeString": "address payable"}}, "id": 196, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "memberName": "send", "nodeType": "MemberAccess", "referencedDeclaration": null, "src": "633:15:1", "typeDescriptions": {"typeIdentifier": "t_function_send_nonpayable$_t_uint256_$returns$_t_bool_$", "typeString": "function (uint256) returns (bool)"}}, "id": 198, "isConstant": false, "isLValue": false, "isPure": false, "kind": "functionCall", "lValueRequested": false, "names": [], "nodeType": "FunctionCall", "src": "633:20:1", "typeDescriptions": {"typeIdentifier": "t_bool", "typeString": "bool"}}, "id": 199, "nodeType": "ExpressionStatement", "src": "633:20:1"}]}, "documentation": null, "id": 201, "implemented": true, "kind": "function", "modifiers": [], "name": "withdraw", "nodeType": "FunctionDefinition", "parameters": {"id": 183, "nodeType": "ParameterList", "parameters": [], "src": "573:2:1"}, "returnParameters": {"id": 184, "nodeType": "ParameterList", "parameters": [], "src": "582:0:1"}, "scope": 229, "src": "556:104:1", "stateMutability": "nonpayable", "superFunction": null, "visibility": "public"}, {"body": {"id": 227, "nodeType": "Block", "src": "695:186:1", "statements": [{"assignments": [205], "declarations": [{"constant": false, "id": 205, "name": "value_send", "nodeType": "VariableDeclaration", "scope": 227, "src": "705:15:1", "stateVariable": false, "storageLocation": "default", "typeDescriptions": {"typeIdentifier": "t_uint256", "typeString": "uint256"}, "typeName": {"id": 204, "name": "uint", "nodeType": "ElementaryTypeName", "src": "705:4:1", "typeDescriptions": {"typeIdentifier": "t_uint256", "typeString": "uint256"}}, "value": null, "visibility": "internal"}], "id": 208, "initialValue": {"argumentTypes": null, "expression": {"argumentTypes": null, "id": 206, "name": "msg", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 244, "src": "723:3:1", "typeDescriptions": {"typeIdentifier": "t_magic_message", "typeString": "msg"}}, "id": 207, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "memberName": "value", "nodeType": "MemberAccess", "referencedDeclaration": null, "src": "723:9:1", "typeDescriptions": {"typeIdentifier": "t_uint256", "typeString": "uint256"}}, "nodeType": "VariableDeclarationStatement", "src": "705:27:1"}, {"assignments": [210], "declarations": [{"constant": false, "id": 210, "name": "value_spent", "nodeType": "VariableDeclaration", "scope": 227, "src": "742:16:1", "stateVariable": false, "storageLocation": "default", "typeDescriptions": {"typeIdentifier": "t_uint256", "typeString": "uint256"}, "typeName": {"id": 209, "name": "uint", "nodeType": "ElementaryTypeName", "src": "742:4:1", "typeDescriptions": {"typeIdentifier": "t_uint256", "typeString": "uint256"}}, "value": null, "visibility": "internal"}], "id": 212, "initialValue": {"argumentTypes": null, "hexValue": "30", "id": 211, "isConstant": false, "isLValue": false, "isPure": true, "kind": "number", "lValueRequested": false, "nodeType": "Literal", "src": "761:1:1", "subdenomination": null, "typeDescriptions": {"typeIdentifier": "t_rational_0_by_1", "typeString": "int_const 0"}, "value": "0"}, "nodeType": "VariableDeclarationStatement", "src": "742:20:1"}, {"assignments": [214], "declarations": [{"constant": false, "id": 214, "name": "remaining", "nodeType": "VariableDeclaration", "scope": 227, "src": "801:14:1", "stateVariable": false, "storageLocation": "default", "typeDescriptions": {"typeIdentifier": "t_uint256", "typeString": "uint256"}, "typeName": {"id": 213, "name": "uint", "nodeType": "ElementaryTypeName", "src": "801:4:1", "typeDescriptions": {"typeIdentifier": "t_uint256", "typeString": "uint256"}}, "value": null, "visibility": "internal"}], "id": 218, "initialValue": {"argumentTypes": null, "commonType": {"typeIdentifier": "t_uint256", "typeString": "uint256"}, "id": 217, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "leftExpression": {"argumentTypes": null, "id": 215, "name": "value_send", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 205, "src": "818:10:1", "typeDescriptions": {"typeIdentifier": "t_uint256", "typeString": "uint256"}}, "nodeType": "BinaryOperation", "operator": "-", "rightExpression": {"argumentTypes": null, "id": 216, "name": "value_spent", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 210, "src": "831:11:1", "typeDescriptions": {"typeIdentifier": "t_uint256", "typeString": "uint256"}}, "src": "818:24:1", "typeDescriptions": {"typeIdentifier": "t_uint256", "typeString": "uint256"}}, "nodeType": "VariableDeclarationStatement", "src": "801:41:1"}, {"expression": {"argumentTypes": null, "arguments": [{"argumentTypes": null, "id": 224, "name": "remaining", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 214, "src": "868:9:1", "typeDescriptions": {"typeIdentifier": "t_uint256", "typeString": "uint256"}}], "expression": {"argumentTypes": [{"typeIdentifier": "t_uint256", "typeString": "uint256"}], "expression": {"argumentTypes": null, "expression": {"argumentTypes": null, "id": 219, "name": "msg", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 244, "src": "852:3:1", "typeDescriptions": {"typeIdentifier": "t_magic_message", "typeString": "msg"}}, "id": 222, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "memberName": "sender", "nodeType": "MemberAccess", "referencedDeclaration": null, "src": "852:10:1", "typeDescriptions": {"typeIdentifier": "t_address_payable", "typeString": "address payable"}}, "id": 223, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "memberName": "send", "nodeType": "MemberAccess", "referencedDeclaration": null, "src": "852:15:1", "typeDescriptions": {"typeIdentifier": "t_function_send_nonpayable$_t_uint256_$returns$_t_bool_$", "typeString": "function (uint256) returns (bool)"}}, "id": 225, "isConstant": false, "isLValue": false, "isPure": false, "kind": "functionCall", "lValueRequested": false, "names": [], "nodeType": "FunctionCall", "src": "852:26:1", "typeDescriptions": {"typeIdentifier": "t_bool", "typeString": "bool"}}, "id": 226, "nodeType": "ExpressionStatement", "src": "852:26:1"}]}, "documentation": null, "id": 228, "implemented": true, "kind": "function", "modifiers": [], "name": "buy", "nodeType": "FunctionDefinition", "parameters": {"id": 202, "nodeType": "ParameterList", "parameters": [], "src": "678:2:1"}, "returnParameters": {"id": 203, "nodeType": "ParameterList", "parameters": [], "src": "695:0:1"}, "scope": 229, "src": "666:215:1", "stateMutability": "payable", "superFunction": null, "visibility": "public"}], "scope": 230, "src": "0:884:1"}], "src": "0:885:1"}, "contracts": {"Test": {"abi": [{"inputs": [], "payable": false, "stateMutability": "nonpayable", "type": "constructor"}, {"constant": false, "inputs": [], "name": "buy", "outputs": [], "payable": true, "stateMutability": "payable", "type": "function"}, {"constant": false, "inputs": [], "name": "direct", "outputs": [], "payable": false, "stateMutability": "nonpayable", "type": "function"}, {"constant": false, "inputs": [], "name": "indirect", "outputs": [], "payable": false, "stateMutability": "nonpayable", "type": "function"}, {"constant": false, "inputs": [], "name": "init", "outputs": [], "payable": false, "stateMutability": "nonpayable", "type": "function"}, {"constant": false, "inputs": [], "name": "repay", "outputs": [], "payable": true, "stateMutability": "payable", "type": "function"}, {"constant": false, "inputs": [], "name": "withdraw", "outputs": [], "payable": false, "stateMutability": "nonpayable", "type": "function"}], "bin": "608060405234801561001057600080fd5b506000600160003373ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff168152602001908152602001600020819055506102e4806100656000396000f3fe6080604052600436106100555760003560e01c8063222b14071461005a5780633ccfd60b14610071578063402d888314610088578063a533397914610092578063a6f2ae3a146100a9578063e1c7392a146100b3575b600080fd5b34801561006657600080fd5b5061006f6100ca565b005b34801561007d57600080fd5b50610086610102565b005b61009061017f565b005b34801561009e57600080fd5b506100a76101c8565b005b6100b1610221565b005b3480156100bf57600080fd5b506100c861026d565b005b3373ffffffffffffffffffffffffffffffffffffffff166108fc479081150290604051600060405180830381858888f1935050505050565b6000600160003373ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1681526020019081526020016000205490503373ffffffffffffffffffffffffffffffffffffffff166108fc829081150290604051600060405180830381858888f193505050505050565b3373ffffffffffffffffffffffffffffffffffffffff166108fc349081150290604051600060405180830381858888f193505050501580156101c5573d6000803e3d6000fd5b50565b6000809054906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff166108fc479081150290604051600060405180830381858888f1935050505050565b60003490506000809050600081830390503373ffffffffffffffffffffffffffffffffffffffff166108fc829081150290604051600060405180830381858888f1935050505050505050565b336000806101000a81548173ffffffffffffffffffffffffffffffffffffffff021916908373ffffffffffffffffffffffffffffffffffffffff16021790555056fea265627a7a72315820095c6d43430d9433ffa0028cb1a2e8ad57aa47d00948f15fc98d8e85195d7aeb64736f6c63430005100032", "bin-runtime": "6080604052600436106100555760003560e01c8063222b14071461005a5780633ccfd60b14610071578063402d888314610088578063a533397914610092578063a6f2ae3a146100a9578063e1c7392a146100b3575b600080fd5b34801561006657600080fd5b5061006f6100ca565b005b34801561007d57600080fd5b50610086610102565b005b61009061017f565b005b34801561009e57600080fd5b506100a76101c8565b005b6100b1610221565b005b3480156100bf57600080fd5b506100c861026d565b005b3373ffffffffffffffffffffffffffffffffffffffff166108fc479081150290604051600060405180830381858888f1935050505050565b6000600160003373ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1681526020019081526020016000205490503373ffffffffffffffffffffffffffffffffffffffff166108fc829081150290604051600060405180830381858888f193505050505050565b3373ffffffffffffffffffffffffffffffffffffffff166108fc349081150290604051600060405180830381858888f193505050501580156101c5573d6000803e3d6000fd5b50565b6000809054906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff166108fc479081150290604051600060405180830381858888f1935050505050565b60003490506000809050600081830390503373ffffffffffffffffffffffffffffffffffffffff166108fc829081150290604051600060405180830381858888f1935050505050505050565b336000806101000a81548173ffffffffffffffffffffffffffffffffffffffff021916908373ffffffffffffffffffffffffffffffffffffffff16021790555056fea265627a7a72315820095c6d43430d9433ffa0028cb1a2e8ad57aa47d00948f15fc98d8e85195d7aeb64736f6c63430005100032", "srcmap": "0:884:1:-;;;95:61;8:9:-1;5:2;;;30:1;27;20:12;5:2;95:61:1;148:1;125:8;:20;134:10;125:20;;;;;;;;;;;;;;;:24;;;;0:884;;;;;;", "srcmap-runtime": "0:884:1:-;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;162:79;;8:9:-1;5:2;;;30:1;27;20:12;5:2;162:79:1;;;:::i;:::-;;556:104;;8:9:-1;5:2;;;30:1;27;20:12;5:2;556:104:1;;;:::i;:::-;;472:78;;;:::i;:::-;;316:82;;8:9:-1;5:2;;;30:1;27;20:12;5:2;316:82:1;;;:::i;:::-;;666:215;;;:::i;:::-;;247:63;;8:9:-1;5:2;;;30:1;27;20:12;5:2;247:63:1;;;:::i;:::-;;162:79;196:10;:15;;:38;212:21;196:38;;;;;;;;;;;;;;;;;;;;;;;;162:79::o;556:104::-;592:8;603;:20;612:10;603:20;;;;;;;;;;;;;;;;592:31;;633:10;:15;;:20;649:3;633:20;;;;;;;;;;;;;;;;;;;;;;;;556:104;:::o;472:78::-;513:10;:19;;:30;533:9;513:30;;;;;;;;;;;;;;;;;;;;;;;;8:9:-1;5:2;;;45:16;42:1;39;24:38;77:16;74:1;67:27;5:2;513:30:1;472:78::o;316:82::-;352:11;;;;;;;;;;;:16;;:39;369:21;352:39;;;;;;;;;;;;;;;;;;;;;;;;316:82::o;666:215::-;705:15;723:9;705:27;;742:16;761:1;742:20;;801:14;831:11;818:10;:24;801:41;;852:10;:15;;:26;868:9;852:26;;;;;;;;;;;;;;;;;;;;;;;;666:215;;;:::o;247:63::-;293:10;279:11;;:24;;;;;;;;;;;;;;;;;;247:63::o", "filenames": {"absolute": "/Users/alpharush/tob/slither/tests/e2e/detectors/test_data/arbitrary-send-eth/0.5.16/arbitrary_send_eth.sol", "used": "tests/e2e/detectors/test_data/arbitrary-send-eth/0.5.16/arbitrary_send_eth.sol", "short": "tests/e2e/detectors/test_data/arbitrary-send-eth/0.5.16/arbitrary_send_eth.sol", "relative": "tests/e2e/detectors/test_data/arbitrary-send-eth/0.5.16/arbitrary_send_eth.sol"}, "libraries": {}, "is_dependency": false, "userdoc": {"methods": {}, "notice": null}, "devdoc": {"methods": {}, "author": null, "details": null, "title": null}}}}}, "filenames": [{"absolute": "/Users/alpharush/tob/slither/tests/e2e/detectors/test_data/arbitrary-send-eth/0.5.16/arbitrary_send_eth.sol", "used": "/Users/alpharush/tob/slither/tests/e2e/detectors/test_data/arbitrary-send-eth/0.5.16/arbitrary_send_eth.sol", "short": "tests/e2e/detectors/test_data/arbitrary-send-eth/0.5.16/arbitrary_send_eth.sol", "relative": "tests/e2e/detectors/test_data/arbitrary-send-eth/0.5.16/arbitrary_send_eth.sol"}, {"absolute": "/Users/alpharush/tob/slither/tests/e2e/detectors/test_data/arbitrary-send-eth/0.5.16/arbitrary_send_eth.sol", "used": "tests/e2e/detectors/test_data/arbitrary-send-eth/0.5.16/arbitrary_send_eth.sol", "short": "tests/e2e/detectors/test_data/arbitrary-send-eth/0.5.16/arbitrary_send_eth.sol", "relative": "tests/e2e/detectors/test_data/arbitrary-send-eth/0.5.16/arbitrary_send_eth.sol"}]}}, "package": null, "working_dir": "/Users/alpharush/tob/slither", "type": 1, "unit_tests": [], "crytic_version": "0.0.2", "source_content": {"/Users/alpharush/tob/slither/tests/e2e/detectors/test_data/arbitrary-send-eth/0.5.16/arbitrary_send_eth.sol": "contract Test{\n\n    address payable destination;\n\n    mapping (address => uint) balances;\n\n    constructor() public{\n        balances[msg.sender] = 0;\n    }\n\n    function direct() public{\n        msg.sender.send(address(this).balance);\n    }\n\n    function init() public{\n        destination = msg.sender;\n    }\n\n    function indirect() public{\n        destination.send(address(this).balance);\n    }\n\n    // these are legitimate calls\n    // and should not be detected\n    function repay() payable public{\n        msg.sender.transfer(msg.value);\n    }\n\n    function withdraw() public{\n        uint val = balances[msg.sender];\n        msg.sender.send(val);\n    }\n\n    function buy() payable public{\n        uint value_send = msg.value;\n        uint value_spent = 0 ; // simulate a buy of tokens\n        uint remaining = value_send - value_spent;\n        msg.sender.send(remaining);\n}\n\n}\n"}}