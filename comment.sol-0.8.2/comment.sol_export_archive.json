{"compilation_units": {"/Users/alpharush/tob/slither/tests/e2e/detectors/test_data/reentrancy-no-eth/0.8.2/comment.sol": {"compiler": {"compiler": "solc", "version": "0.8.2", "optimized": false}, "source_units": {"tests/e2e/detectors/test_data/reentrancy-no-eth/0.8.2/comment.sol": {"ast": {"absolutePath": "tests/e2e/detectors/test_data/reentrancy-no-eth/0.8.2/comment.sol", "exportedSymbols": {"I": [78], "ReentrancyAndWrite": [147]}, "id": 148, "nodeType": "SourceUnit", "nodes": [{"abstract": false, "baseContracts": [], "contractDependencies": [], "contractKind": "interface", "fullyImplemented": false, "id": 78, "linearizedBaseContracts": [78], "name": "I", "nameLocation": "10:1:1", "nodeType": "ContractDefinition", "nodes": [{"functionSelector": "2484461c", "id": 77, "implemented": false, "kind": "function", "modifiers": [], "name": "external_call", "nameLocation": "26:13:1", "nodeType": "FunctionDefinition", "parameters": {"id": 75, "nodeType": "ParameterList", "parameters": [], "src": "39:2:1"}, "returnParameters": {"id": 76, "nodeType": "ParameterList", "parameters": [], "src": "50:0:1"}, "scope": 78, "src": "17:34:1", "stateMutability": "nonpayable", "virtual": false, "visibility": "external"}], "scope": 148, "src": "0:53:1"}, {"abstract": false, "baseContracts": [], "contractDependencies": [], "contractKind": "contract", "fullyImplemented": true, "id": 147, "linearizedBaseContracts": [147], "name": "ReentrancyAndWrite", "nameLocation": "64:18:1", "nodeType": "ContractDefinition", "nodes": [{"constant": false, "documentation": {"id": 79, "nodeType": "StructuredDocumentation", "src": "89:90:1", "text": "@custom:security non-reentrant\n @custom:security write-protection=\"onlyOwner()\""}, "id": 82, "mutability": "mutable", "name": "external_contract", "nameLocation": "186:17:1", "nodeType": "VariableDeclaration", "scope": 147, "src": "184:19:1", "stateVariable": true, "storageLocation": "default", "typeDescriptions": {"typeIdentifier": "t_contract$_I_$78", "typeString": "contract I"}, "typeName": {"id": 81, "nodeType": "UserDefinedTypeName", "pathNode": {"id": 80, "name": "I", "nodeType": "IdentifierPath", "referencedDeclaration": 78, "src": "184:1:1"}, "referencedDeclaration": 78, "src": "184:1:1", "typeDescriptions": {"typeIdentifier": "t_contract$_I_$78", "typeString": "contract I"}}, "visibility": "internal"}, {"body": {"id": 85, "nodeType": "Block", "src": "230:68:1", "statements": [{"id": 84, "nodeType": "PlaceholderStatement", "src": "290:1:1"}]}, "id": 86, "name": "onlyOwner", "nameLocation": "219:9:1", "nodeType": "ModifierDefinition", "parameters": {"id": 83, "nodeType": "ParameterList", "parameters": [], "src": "228:2:1"}, "src": "210:88:1", "virtual": false, "visibility": "internal"}, {"constant": false, "id": 90, "mutability": "mutable", "name": "balances", "nameLocation": "329:8:1", "nodeType": "VariableDeclaration", "scope": 147, "src": "304:33:1", "stateVariable": true, "storageLocation": "default", "typeDescriptions": {"typeIdentifier": "t_mapping$_t_address_$_t_uint256_$", "typeString": "mapping(address => uint256)"}, "typeName": {"id": 89, "keyType": {"id": 87, "name": "address", "nodeType": "ElementaryTypeName", "src": "312:7:1", "typeDescriptions": {"typeIdentifier": "t_address", "typeString": "address"}}, "nodeType": "Mapping", "src": "304:24:1", "typeDescriptions": {"typeIdentifier": "t_mapping$_t_address_$_t_uint256_$", "typeString": "mapping(address => uint256)"}, "valueType": {"id": 88, "name": "uint", "nodeType": "ElementaryTypeName", "src": "323:4:1", "typeDescriptions": {"typeIdentifier": "t_uint256", "typeString": "uint256"}}}, "visibility": "internal"}, {"body": {"id": 121, "nodeType": "Block", "src": "370:178:1", "statements": [{"assignments": [94], "declarations": [{"constant": false, "id": 94, "mutability": "mutable", "name": "balance", "nameLocation": "385:7:1", "nodeType": "VariableDeclaration", "scope": 121, "src": "380:12:1", "stateVariable": false, "storageLocation": "default", "typeDescriptions": {"typeIdentifier": "t_uint256", "typeString": "uint256"}, "typeName": {"id": 93, "name": "uint", "nodeType": "ElementaryTypeName", "src": "380:4:1", "typeDescriptions": {"typeIdentifier": "t_uint256", "typeString": "uint256"}}, "visibility": "internal"}], "id": 99, "initialValue": {"baseExpression": {"id": 95, "name": "balances", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 90, "src": "395:8:1", "typeDescriptions": {"typeIdentifier": "t_mapping$_t_address_$_t_uint256_$", "typeString": "mapping(address => uint256)"}}, "id": 98, "indexExpression": {"expression": {"id": 96, "name": "msg", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": -15, "src": "404:3:1", "typeDescriptions": {"typeIdentifier": "t_magic_message", "typeString": "msg"}}, "id": 97, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "memberName": "sender", "nodeType": "MemberAccess", "src": "404:10:1", "typeDescriptions": {"typeIdentifier": "t_address", "typeString": "address"}}, "isConstant": false, "isLValue": true, "isPure": false, "lValueRequested": false, "nodeType": "IndexAccess", "src": "395:20:1", "typeDescriptions": {"typeIdentifier": "t_uint256", "typeString": "uint256"}}, "nodeType": "VariableDeclarationStatement", "src": "380:35:1"}, {"expression": {"arguments": [], "expression": {"argumentTypes": [], "expression": {"id": 100, "name": "external_contract", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 82, "src": "426:17:1", "typeDescriptions": {"typeIdentifier": "t_contract$_I_$78", "typeString": "contract I"}}, "id": 102, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "memberName": "external_call", "nodeType": "MemberAccess", "referencedDeclaration": 77, "src": "426:31:1", "typeDescriptions": {"typeIdentifier": "t_function_external_nonpayable$__$returns$__$", "typeString": "function () external"}}, "id": 103, "isConstant": false, "isLValue": false, "isPure": false, "kind": "functionCall", "lValueRequested": false, "names": [], "nodeType": "FunctionCall", "src": "426:33:1", "tryCall": false, "typeDescriptions": {"typeIdentifier": "t_tuple$__$", "typeString": "tuple()"}}, "id": 104, "nodeType": "ExpressionStatement", "src": "426:33:1"}, {"expression": {"id": 110, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "leftHandSide": {"baseExpression": {"id": 105, "name": "balances", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 90, "src": "470:8:1", "typeDescriptions": {"typeIdentifier": "t_mapping$_t_address_$_t_uint256_$", "typeString": "mapping(address => uint256)"}}, "id": 108, "indexExpression": {"expression": {"id": 106, "name": "msg", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": -15, "src": "479:3:1", "typeDescriptions": {"typeIdentifier": "t_magic_message", "typeString": "msg"}}, "id": 107, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "memberName": "sender", "nodeType": "MemberAccess", "src": "479:10:1", "typeDescriptions": {"typeIdentifier": "t_address", "typeString": "address"}}, "isConstant": false, "isLValue": true, "isPure": false, "lValueRequested": true, "nodeType": "IndexAccess", "src": "470:20:1", "typeDescriptions": {"typeIdentifier": "t_uint256", "typeString": "uint256"}}, "nodeType": "Assignment", "operator": "=", "rightHandSide": {"hexValue": "30", "id": 109, "isConstant": false, "isLValue": false, "isPure": true, "kind": "number", "lValueRequested": false, "nodeType": "Literal", "src": "493:1:1", "typeDescriptions": {"typeIdentifier": "t_rational_0_by_1", "typeString": "int_const 0"}, "value": "0"}, "src": "470:24:1", "typeDescriptions": {"typeIdentifier": "t_uint256", "typeString": "uint256"}}, "id": 111, "nodeType": "ExpressionStatement", "src": "470:24:1"}, {"expression": {"arguments": [{"id": 118, "name": "balance", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 94, "src": "533:7:1", "typeDescriptions": {"typeIdentifier": "t_uint256", "typeString": "uint256"}}], "expression": {"argumentTypes": [{"typeIdentifier": "t_uint256", "typeString": "uint256"}], "expression": {"arguments": [{"expression": {"id": 114, "name": "msg", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": -15, "src": "512:3:1", "typeDescriptions": {"typeIdentifier": "t_magic_message", "typeString": "msg"}}, "id": 115, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "memberName": "sender", "nodeType": "MemberAccess", "src": "512:10:1", "typeDescriptions": {"typeIdentifier": "t_address", "typeString": "address"}}], "expression": {"argumentTypes": [{"typeIdentifier": "t_address", "typeString": "address"}], "id": 113, "isConstant": false, "isLValue": false, "isPure": true, "lValueRequested": false, "nodeType": "ElementaryTypeNameExpression", "src": "504:8:1", "typeDescriptions": {"typeIdentifier": "t_type$_t_address_payable_$", "typeString": "type(address payable)"}, "typeName": {"id": 112, "name": "address", "nodeType": "ElementaryTypeName", "src": "504:8:1", "stateMutability": "payable", "typeDescriptions": {}}}, "id": 116, "isConstant": false, "isLValue": false, "isPure": false, "kind": "typeConversion", "lValueRequested": false, "names": [], "nodeType": "FunctionCall", "src": "504:19:1", "tryCall": false, "typeDescriptions": {"typeIdentifier": "t_address_payable", "typeString": "address payable"}}, "id": 117, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "memberName": "transfer", "nodeType": "MemberAccess", "src": "504:28:1", "typeDescriptions": {"typeIdentifier": "t_function_transfer_nonpayable$_t_uint256_$returns$__$", "typeString": "function (uint256)"}}, "id": 119, "isConstant": false, "isLValue": false, "isPure": false, "kind": "functionCall", "lValueRequested": false, "names": [], "nodeType": "FunctionCall", "src": "504:37:1", "tryCall": false, "typeDescriptions": {"typeIdentifier": "t_tuple$__$", "typeString": "tuple()"}}, "id": 120, "nodeType": "ExpressionStatement", "src": "504:37:1"}]}, "functionSelector": "3ccfd60b", "id": 122, "implemented": true, "kind": "function", "modifiers": [], "name": "withdraw", "nameLocation": "353:8:1", "nodeType": "FunctionDefinition", "parameters": {"id": 91, "nodeType": "ParameterList", "parameters": [], "src": "361:2:1"}, "returnParameters": {"id": 92, "nodeType": "ParameterList", "parameters": [], "src": "370:0:1"}, "scope": 147, "src": "344:204:1", "stateMutability": "nonpayable", "virtual": false, "visibility": "public"}, {"body": {"id": 134, "nodeType": "Block", "src": "597:50:1", "statements": [{"expression": {"id": 132, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "leftHandSide": {"id": 127, "name": "external_contract", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 82, "src": "607:17:1", "typeDescriptions": {"typeIdentifier": "t_contract$_I_$78", "typeString": "contract I"}}, "nodeType": "Assignment", "operator": "=", "rightHandSide": {"arguments": [{"expression": {"id": 129, "name": "msg", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": -15, "src": "629:3:1", "typeDescriptions": {"typeIdentifier": "t_magic_message", "typeString": "msg"}}, "id": 130, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "memberName": "sender", "nodeType": "MemberAccess", "src": "629:10:1", "typeDescriptions": {"typeIdentifier": "t_address", "typeString": "address"}}], "expression": {"argumentTypes": [{"typeIdentifier": "t_address", "typeString": "address"}], "id": 128, "name": "I", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 78, "src": "627:1:1", "typeDescriptions": {"typeIdentifier": "t_type$_t_contract$_I_$78_$", "typeString": "type(contract I)"}}, "id": 131, "isConstant": false, "isLValue": false, "isPure": false, "kind": "typeConversion", "lValueRequested": false, "names": [], "nodeType": "FunctionCall", "src": "627:13:1", "tryCall": false, "typeDescriptions": {"typeIdentifier": "t_contract$_I_$78", "typeString": "contract I"}}, "src": "607:33:1", "typeDescriptions": {"typeIdentifier": "t_contract$_I_$78", "typeString": "contract I"}}, "id": 133, "nodeType": "ExpressionStatement", "src": "607:33:1"}]}, "functionSelector": "066ed880", "id": 135, "implemented": true, "kind": "function", "modifiers": [{"arguments": [], "id": 125, "modifierName": {"id": 124, "name": "onlyOwner", "nodeType": "IdentifierPath", "referencedDeclaration": 86, "src": "586:9:1"}, "nodeType": "ModifierInvocation", "src": "586:11:1"}], "name": "set_protected", "nameLocation": "563:13:1", "nodeType": "FunctionDefinition", "parameters": {"id": 123, "nodeType": "ParameterList", "parameters": [], "src": "576:2:1"}, "returnParameters": {"id": 126, "nodeType": "ParameterList", "parameters": [], "src": "597:0:1"}, "scope": 147, "src": "554:93:1", "stateMutability": "nonpayable", "virtual": false, "visibility": "public"}, {"body": {"id": 145, "nodeType": "Block", "src": "688:50:1", "statements": [{"expression": {"id": 143, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "leftHandSide": {"id": 138, "name": "external_contract", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 82, "src": "698:17:1", "typeDescriptions": {"typeIdentifier": "t_contract$_I_$78", "typeString": "contract I"}}, "nodeType": "Assignment", "operator": "=", "rightHandSide": {"arguments": [{"expression": {"id": 140, "name": "msg", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": -15, "src": "720:3:1", "typeDescriptions": {"typeIdentifier": "t_magic_message", "typeString": "msg"}}, "id": 141, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "memberName": "sender", "nodeType": "MemberAccess", "src": "720:10:1", "typeDescriptions": {"typeIdentifier": "t_address", "typeString": "address"}}], "expression": {"argumentTypes": [{"typeIdentifier": "t_address", "typeString": "address"}], "id": 139, "name": "I", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 78, "src": "718:1:1", "typeDescriptions": {"typeIdentifier": "t_type$_t_contract$_I_$78_$", "typeString": "type(contract I)"}}, "id": 142, "isConstant": false, "isLValue": false, "isPure": false, "kind": "typeConversion", "lValueRequested": false, "names": [], "nodeType": "FunctionCall", "src": "718:13:1", "tryCall": false, "typeDescriptions": {"typeIdentifier": "t_contract$_I_$78", "typeString": "contract I"}}, "src": "698:33:1", "typeDescriptions": {"typeIdentifier": "t_contract$_I_$78", "typeString": "contract I"}}, "id": 144, "nodeType": "ExpressionStatement", "src": "698:33:1"}]}, "functionSelector": "25db5879", "id": 146, "implemented": true, "kind": "function", "modifiers": [], "name": "set_not_protected", "nameLocation": "662:17:1", "nodeType": "FunctionDefinition", "parameters": {"id": 136, "nodeType": "ParameterList", "parameters": [], "src": "679:2:1"}, "returnParameters": {"id": 137, "nodeType": "ParameterList", "parameters": [], "src": "688:0:1"}, "scope": 147, "src": "653:85:1", "stateMutability": "nonpayable", "virtual": false, "visibility": "public"}], "scope": 148, "src": "55:685:1"}], "src": "0:742:1"}, "contracts": {"ReentrancyAndWrite": {"abi": [{"inputs": [], "name": "set_not_protected", "outputs": [], "stateMutability": "nonpayable", "type": "function"}, {"inputs": [], "name": "set_protected", "outputs": [], "stateMutability": "nonpayable", "type": "function"}, {"inputs": [], "name": "withdraw", "outputs": [], "stateMutability": "nonpayable", "type": "function"}], "bin": "608060405234801561001057600080fd5b50610271806100206000396000f3fe608060405234801561001057600080fd5b50600436106100415760003560e01c8063066ed8801461004657806325db5879146100505780633ccfd60b1461005a575b600080fd5b61004e610064565b005b6100586100a6565b005b6100626100e8565b005b336000806101000a81548173ffffffffffffffffffffffffffffffffffffffff021916908373ffffffffffffffffffffffffffffffffffffffff160217905550565b336000806101000a81548173ffffffffffffffffffffffffffffffffffffffff021916908373ffffffffffffffffffffffffffffffffffffffff160217905550565b6000600160003373ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff16815260200190815260200160002054905060008054906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff16632484461c6040518163ffffffff1660e01b8152600401600060405180830381600087803b15801561019457600080fd5b505af11580156101a8573d6000803e3d6000fd5b505050506000600160003373ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff168152602001908152602001600020819055503373ffffffffffffffffffffffffffffffffffffffff166108fc829081150290604051600060405180830381858888f19350505050158015610237573d6000803e3d6000fd5b505056fea26469706673582212203cc54330ba6bcb161bc1ab7affe54967c4108b37b3c4736d5f2678a96ad1b06c64736f6c63430008020033", "bin-runtime": "608060405234801561001057600080fd5b50600436106100415760003560e01c8063066ed8801461004657806325db5879146100505780633ccfd60b1461005a575b600080fd5b61004e610064565b005b6100586100a6565b005b6100626100e8565b005b336000806101000a81548173ffffffffffffffffffffffffffffffffffffffff021916908373ffffffffffffffffffffffffffffffffffffffff160217905550565b336000806101000a81548173ffffffffffffffffffffffffffffffffffffffff021916908373ffffffffffffffffffffffffffffffffffffffff160217905550565b6000600160003373ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff16815260200190815260200160002054905060008054906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff16632484461c6040518163ffffffff1660e01b8152600401600060405180830381600087803b15801561019457600080fd5b505af11580156101a8573d6000803e3d6000fd5b505050506000600160003373ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff168152602001908152602001600020819055503373ffffffffffffffffffffffffffffffffffffffff166108fc829081150290604051600060405180830381858888f19350505050158015610237573d6000803e3d6000fd5b505056fea26469706673582212203cc54330ba6bcb161bc1ab7affe54967c4108b37b3c4736d5f2678a96ad1b06c64736f6c63430008020033", "srcmap": "55:685:1:-:0;;;;;;;;;;;;;;;;;;;", "srcmap-runtime": "55:685:1:-:0;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;554:93;;;:::i;:::-;;653:85;;;:::i;:::-;;344:204;;;:::i;:::-;;554:93;629:10:::1;607:17;::::0;:33:::1;;;;;;;;;;;;;;;;;;554:93::o:0;653:85::-;720:10;698:17;;:33;;;;;;;;;;;;;;;;;;653:85::o;344:204::-;380:12;395:8;:20;404:10;395:20;;;;;;;;;;;;;;;;380:35;;426:17;;;;;;;;;;:31;;;:33;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;493:1;470:8;:20;479:10;470:20;;;;;;;;;;;;;;;:24;;;;512:10;504:28;;:37;533:7;504:37;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;344:204;:::o", "filenames": {"absolute": "/Users/alpharush/tob/slither/tests/e2e/detectors/test_data/reentrancy-no-eth/0.8.2/comment.sol", "used": "tests/e2e/detectors/test_data/reentrancy-no-eth/0.8.2/comment.sol", "short": "tests/e2e/detectors/test_data/reentrancy-no-eth/0.8.2/comment.sol", "relative": "tests/e2e/detectors/test_data/reentrancy-no-eth/0.8.2/comment.sol"}, "libraries": {}, "is_dependency": false, "userdoc": {"methods": {}, "notice": null}, "devdoc": {"methods": {}, "author": null, "details": null, "title": null}}, "I": {"abi": [{"inputs": [], "name": "external_call", "outputs": [], "stateMutability": "nonpayable", "type": "function"}], "bin": "", "bin-runtime": "", "srcmap": "", "srcmap-runtime": "", "filenames": {"absolute": "/Users/alpharush/tob/slither/tests/e2e/detectors/test_data/reentrancy-no-eth/0.8.2/comment.sol", "used": "tests/e2e/detectors/test_data/reentrancy-no-eth/0.8.2/comment.sol", "short": "tests/e2e/detectors/test_data/reentrancy-no-eth/0.8.2/comment.sol", "relative": "tests/e2e/detectors/test_data/reentrancy-no-eth/0.8.2/comment.sol"}, "libraries": {}, "is_dependency": false, "userdoc": {"methods": {}, "notice": null}, "devdoc": {"methods": {}, "author": null, "details": null, "title": null}}}}}, "filenames": [{"absolute": "/Users/alpharush/tob/slither/tests/e2e/detectors/test_data/reentrancy-no-eth/0.8.2/comment.sol", "used": "/Users/alpharush/tob/slither/tests/e2e/detectors/test_data/reentrancy-no-eth/0.8.2/comment.sol", "short": "tests/e2e/detectors/test_data/reentrancy-no-eth/0.8.2/comment.sol", "relative": "tests/e2e/detectors/test_data/reentrancy-no-eth/0.8.2/comment.sol"}, {"absolute": "/Users/alpharush/tob/slither/tests/e2e/detectors/test_data/reentrancy-no-eth/0.8.2/comment.sol", "used": "tests/e2e/detectors/test_data/reentrancy-no-eth/0.8.2/comment.sol", "short": "tests/e2e/detectors/test_data/reentrancy-no-eth/0.8.2/comment.sol", "relative": "tests/e2e/detectors/test_data/reentrancy-no-eth/0.8.2/comment.sol"}]}}, "package": null, "working_dir": "/Users/alpharush/tob/slither", "type": 1, "unit_tests": [], "crytic_version": "0.0.2", "source_content": {"/Users/alpharush/tob/slither/tests/e2e/detectors/test_data/reentrancy-no-eth/0.8.2/comment.sol": "interface I{\n    function external_call() external;\n}\n\ncontract ReentrancyAndWrite{\n\n    /// @custom:security non-reentrant\n    /// @custom:security write-protection=\"onlyOwner()\"\n    I external_contract;\n\n    modifier onlyOwner(){\n        // lets assume there is an access control\n        _;\n    }\n\n    mapping(address => uint) balances;\n\n    function withdraw() public{\n        uint balance = balances[msg.sender];\n\n        external_contract.external_call();\n\n        balances[msg.sender] = 0;\n        payable(msg.sender).transfer(balance);\n    }\n\n    function set_protected() public onlyOwner(){\n        external_contract = I(msg.sender);\n    }\n\n    function set_not_protected() public{\n        external_contract = I(msg.sender);\n    }\n}\n\n"}}